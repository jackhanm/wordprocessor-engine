!function e(t,r,n){function o(a,i){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!i&&l)return l(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};t[a][0].call(c.exports,function(e){var r=t[a][1][e];return o(r?r:e)},c,c.exports,e,t,r,n)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("calc-engine"),i=n(a),l=e("object-assign"),u=n(l),c=function(){function e(){o(this,e)}return s(e,null,[{key:"coordToColRow",value:function(e){return i["default"].coordToCr(e)}},{key:"colRowToCoord",value:function(e,t){return i["default"].crToCoord(e,t)}},{key:"cellRangeToRowColNumber",value:function(t){var r=t.split(":");return{start:e.coordToColRow(r[0]),end:e.coordToColRow(r[1])}}},{key:"colWidth",value:function(t,r){var n=e.colName(r);return parseInt(t.colattribs.width[n]||t.attribs.defaultcolwidth||i["default"].Constants.defaultColWidth)}},{key:"colName",value:function(e){return i["default"].rcColname(e)}},{key:"cell",value:function(e,t){return e.cells[t]||new i["default"].Cell(t)}},{key:"reactStyleFromCSSStyle",value:function(e){var t={};return e.split(";").map(function(e){for(var r=e.split(":"),n=r[0],o=r[1],s=n.split("-"),a=1;a<s.length;a++)s[a]=s[a].charAt(0).toUpperCase()+s[a].substr(1);var i=s.join("");t[i]=o}),t}},{key:"computeSkipCells",value:function(t,r,n,o){var s={};if(o>0)for(var a=1;o>a;a++){var i=r+a;s[t+"-"+i]=[t,i]}if(n>0)for(var l=1;n>l;l++){var c=t+l;s[c+"-"+r]=[c,r],(0,u["default"])(s,e.computeSkipCells(c,r,0,o))}return s}}]),e}();t.exports=c},{"calc-engine":31,"object-assign":41}],2:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){n(this,e),this._content=null}return o(e,[{key:"content",set:function(e){this._content=e},get:function(){return this._content}}]),e}(),a=new s;t.exports=a},{}],3:[function(require,module,exports){"use strict";var Node=require("./node/Node.js"),ContainerNode=require("./node/container/ContainerNode.js"),DocumentNode=require("./node/container/DocumentNode.js"),PageNode=require("./node/container/PageNode.js"),HBoxNode=require("./node/container/HBoxNode.js"),LineNode=require("./node/container/LineNode.js"),ListNode=require("./node/container/ListNode.js"),ListItemNode=require("./node/container/ListItemNode.js"),ContentNode=require("./node/content/ContentNode.js"),PictureNode=require("./node/content/PictureNode.js"),ChartNode=require("./node/content/PictureNode.js"),TableNode=require("./node/content/TableNode.js"),TextNode=require("./node/content/TextNode.js"),Style=require("./node/Style.js"),acorn=require("acorn-jsx");ContainerNode.prototype.mapRefWithId=function(e,t){void 0===this.__RefMap__&&(this.__RefMap__={}),this.__RefMap__[e]=t},ContainerNode.prototype.getIdForRef=function(e){return this.__RefMap__[e]};var Markup={findNodeByTestRef:function(e,t){var r=t.split("."),n=e;return r.forEach(function(e){var t=n.getIdForRef(e);n=n.getChildById(t)}),n},parse:function parse(tag_declarations){var node=void 0,ast=acorn.parse(tag_declarations,{plugins:{jsx:!0}}),ast_root=ast.body[0].expression,ast_walker=function ast_walker(ast_tree,parent){var _node=void 0;if("JSXElement"===ast_tree.type){var openingElement=ast_tree.openingElement,node_name=openingElement.name.name;_node=eval("new "+node_name+"()"),parent&&parent.push(_node);for(var attributes=openingElement.attributes,i=0;i<attributes.length;i++){var attribute=attributes[i],_att_name=attribute.name.name.toLowerCase();if("pathref"===_att_name)parent&&parent.mapRefWithId(attribute.value.value,_node.id);else if("style"===_att_name){var styles=attribute.value.value.split(",");styles.forEach(function(_style){_node.addStyle(eval(_style.trim()))})}}for(var children=ast_tree.children,i=0;i<children.length;i++)ast_walker(children[i],_node)}else if("Literal"===ast_tree.type){var node_text=ast_tree.value;parent&&(parent.text=node_text)}return _node};return ast_walker(ast_root)}};module.exports=Markup},{"./node/Node.js":5,"./node/Style.js":6,"./node/container/ContainerNode.js":7,"./node/container/DocumentNode.js":8,"./node/container/HBoxNode.js":9,"./node/container/LineNode.js":10,"./node/container/ListItemNode.js":11,"./node/container/ListNode.js":12,"./node/container/PageNode.js":13,"./node/content/ContentNode.js":15,"./node/content/PictureNode.js":16,"./node/content/TableNode.js":17,"./node/content/TextNode.js":18,"acorn-jsx":26}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=(e("./node/Node.js"),function(){function e(t){n(this,e),this._stack=[],this._stackPointer=0,this.document=t,this.latest=null}return o(e,[{key:"incrementStackPointer",value:function(){this.stackPointer=this.stackPointer+1}},{key:"decrementStackPointer",value:function(){this.stackPointer=this.stackPointer-1}},{key:"snapshot",value:function(){this.stack=this.stack.slice(0,this.stackPointer+1),this.stack.push(this.document.clone()),this.incrementStackPointer()}},{key:"_set_document",value:function(e){var t=this;this.document.resetNode(),e.forEach(function(e){t.document.push(e.clone())})}},{key:"stack",set:function(e){this._stack=e},get:function(){return this._stack}},{key:"stackPointer",set:function(e){this._stackPointer=e},get:function(){return this._stackPointer}},{key:"undo",get:function(){var e=this.stack[this.stackPointer-1];e&&(this.latest||(this.latest=this.document.clone()),this.decrementStackPointer(),this._set_document(e))}},{key:"redo",get:function(){var e=this.stack[this.stackPointer+1];if(!e){if(!this.latest)return;return this._set_document(this.latest),void(this.latest=null)}this.incrementStackPointer(),this._set_document(e)}}]),e}());t.exports=s},{"./node/Node.js":5}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("seqgen"),i=n(a),l=e("fbemitter"),u=e("object-assign"),c=n(u),d="change",p=function(){function e(t){o(this,e),t||(t=i["default"].next()),this._id=t,this.resetNode()}return s(e,[{key:"compareChildPosition",value:function(e,t){if(e.parent.id!==this.id||t.parent.id!==this.id)throw new Error("Cant compare children. Am not a parent.");return e.id===t.id?0:e.position<t.position?-1:1}},{key:"hasStyle",value:function(e){return this.style.hasOwnProperty(e.id)}},{key:"addStyle",value:function(e){this.style[e.id]=e,this.notifyChange()}},{key:"removeStyle",value:function(e){delete this.style[e.id],this.notifyChange()}},{key:"styleTypes",value:function(){var e=[];for(var t in this.style)e.push(this.style[t].type);return e}},{key:"styleStr",value:function(){var e={};for(var t in this.style)(0,c["default"])(e,this.style[t].styleDefinition);return JSON.stringify(e)}},{key:"isStartAfter",value:function(t){return 1===e.compareNodeStartPosition(this,t)?!0:!1}},{key:"resetNode",value:function(){this._parent=null,this._next=null,this._prev=null,this.resetStyle(),this.changeEmitter=new l.EventEmitter}},{key:"resetStyle",value:function(){this._style={}}},{key:"visitorEnter",value:function(e){e.enter(this)}},{key:"visitorExit",value:function(e){e.exit(this)}},{key:"visitNextNeighbour",value:function(e){null!=this.next&&this.next.visitStart(e)}},{key:"visitStart",value:function(e){this.isStartAfter(e.iterationEndNode)||(this.visitorEnter(e),this.visitorExit(e),this.visitNextNeighbour(e))}},{key:"addChangeListener",value:function(e){return this.changeEmitter.addListener(d,e)}},{key:"removeChangeListener",value:function(){this.changeEmitter.removeAllListeners()}},{key:"notifyChange",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.changeEmitter.emit(d,e)}},{key:"clone",value:function(){var e=this.cloneSelf();return this.cloneStyle(e),e}},{key:"cloneSelf",value:function(){return new this.constructor(this.id)}},{key:"cloneStyle",value:function(e){for(var t in this.style)e.addStyle(this.style[t])}},{key:"newInstance",value:function(){return new this.constructor}},{key:"serialize",value:function(){var e={nodeType:this.constructor.name,styles:this.styleTypes()};return{meta:e,data:this.serializableData()}}},{key:"serializableData",value:function(){return"Override in subclass?"}},{key:"deserializeData",value:function(e,t){return"Override in subclass?"}},{key:"toMarkup",value:function(e,t){var r="",n="";e&&(r="id='"+this.id+"'"),t&&(n="style='"+this.styleStr+"'");var o=""+this.constructor.name;return""!==r&&(o=o+" "+r),""!==n&&(o=o+" "+n),"<"+o+">"+this.markupTagContent(e,t)+"</"+this.constructor.name+">"}},{key:"markupTagContent",value:function(e,t){return"Override in subclass?"}},{key:"canBeAChildTo",value:function(e){return!1}},{key:"pp",value:function(t){console.log(e.intendMarkup(t))}},{key:"id",get:function(){return this._id}},{key:"style",get:function(){return this._style}},{key:"prev",set:function(e){this._prev=e},get:function(){return this._prev}},{key:"hasPrev",get:function(){return null!=this.prev}},{key:"next",get:function(){return this._next},set:function(e){this._next=e}},{key:"hasNext",get:function(){return null!=this.next}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}},{key:"hasParent",get:function(){return this.parent?!0:!1}},{key:"isRoot",get:function(){return!this.hasParent}},{key:"position",get:function(){return this.prev?this.prev.position+1:0}},{key:"hierarchyFromRootToSelf",get:function(){for(var e=[],t=this;t;)e.unshift(t),t=t.parent;return e}},{key:"hierarchyFromSelfToRoot",get:function(){return this.hierarchyFromRootToSelf.reverse()}},{key:"parentHierarchyTillRoot",get:function(){var e=this.hierarchyFromSelfToRoot;return e.shift(),e}}],[{key:"compareNodeStartPosition",value:function(e,t){if(!e||!t)throw new Error("Can't compare, invalid node");var r=0;if(e.id===t.id)return r;for(var n=e.hierarchyFromRootToSelf,o=t.hierarchyFromRootToSelf,s=Math.min(n.length,o.length),a=0;s>a;a++){var i=n[a],l=o[a];if(i.id!==l.id){if(i.position<l.position){r=-1;break}r=1;break}}return 0===r&&(r=n.length<o.length?-1:1),r}},{key:"intendMarkup",value:function(e){var t="",r=/(>)(<)(\/*)/g;e=e.replace(r,"$1\r\n$2$3");var n=0;return e.split("\r\n").forEach(function(e,r){var o=0;e.match(/.+<\/\w[^>]*>$/)?o=0:e.match(/^<\/\w/)?0!=n&&(n-=1):o=e.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var s="",a=0;n>a;a++)s+="  ";t+=s+e+"\r\n",n+=o}),t}}]),e}();t.exports=p},{fbemitter:32,"object-assign":41,seqgen:42}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("seqgen"),i=n(a),l=e("keymirror"),u=function(){function e(t,r){o(this,e),this._type=t,this._styleDefinition=r,this._id=i["default"].next()}return s(e,[{key:"toMarkup",value:function(){return""+JSON.stringify(this.styleDefinition)}},{key:"id",get:function(){return this._id}},{key:"type",get:function(){return this._type}},{key:"styleDefinition",get:function(){return this._styleDefinition}}]),e}();u.TYPE=l({BOLD:null,ITALIC:null});var c={};c[u.TYPE.BOLD]=new u(u.TYPE.BOLD,{fontWeight:"bold"}),c[u.TYPE.ITALIC]=new u(u.TYPE.ITALIC,{fontWeight:"bold"}),t.exports=c},{keymirror:40,seqgen:42}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function m(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,r)}if("value"in n)return n.value;var s=n.get;if(void 0!==s)return s.call(r)},c=e("./../Node.js"),d=n(c),p=e("keymirror"),h=n(p),f=function(e){function t(e){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e));return r.resetNode(),r}return a(t,e),l(t,[{key:"resetNode",value:function(){this._childrenCount=0,this._head=null,this._tail=null,this._childrenMap={},u(Object.getPrototypeOf(t.prototype),"resetNode",this).call(this)}},{key:"deleteIfEmpty",value:function(){this.isEmpty&&this.parent&&this.parent.deleteChildById(this.id)}},{key:"push",value:function(e){var r=e;if(r){if(this._childrenMap.hasOwnProperty(r.id))throw new Error("Cant re-add a child that already exist");for(;r;){var n=r.next;r.hasParent?r=r.parent.extractChildById(r.id):this._delinkNode(r),this.addChildAfter(this.tail,r),this.notifyChange({type:t.EVENTS.PUSH_AN_ITEM,eventSource:this,node:r}),r=n}this.notifyChange({type:t.EVENTS.PUSH,eventSource:this})}}},{key:"pop",value:function(){if(!this.tail)return null;var e=this.deleteChildById(this._tail.id);return this.notifyChange({type:t.EVENTS.POP,eventSource:this,node:e}),e}},{key:"deleteChildById",value:function(e){var r=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=this.extractChildById(e);return n.resetNode(),r&&!this.hasChildren&&this.parent&&this.parent.deleteChildById(this.id),this.notifyChange({type:t.EVENTS.DELETE_CHILD,eventSource:this,node:n}),n}},{key:"extractChildById",value:function(e){if(!(this.childrenCount>0))return null;if(void 0==this._childrenMap[e])return null;this._childrenCount--;var r=this._childrenMap[e],n=r.prev,o=r.next;return n||(this._head=o),o||(this._tail=n),this._delinkNode(r),delete this._childrenMap[e],this.notifyChange({type:t.EVENTS.EXTRACT_CHILD,eventSource:this,node:r}),r}},{key:"addChildAfter",value:function(e,r){return this._addChild(e,r,!0),this.notifyChange({type:t.EVENTS.ADD_CHILD_AFTER,eventSource:this,refNode:e,node:r}),this}},{key:"addChildBefore",value:function(e,r){return this._addChild(e,r,!1),this.notifyChange({type:t.EVENTS.ADD_CHILD_BEFORE,eventSource:this,refNode:e,node:r}),this}},{key:"_addChild",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];if(e||(e=this.tail),!(t instanceof d["default"]))throw new Error("Only type of Node is allowed");var n=t.id;if(!n)throw new Error("id not defined for "+t);if(0==this.childrenCount)this._head=this._tail=t,t.parent=this;else{var o=this._childrenMap[e.id];if(void 0==o)throw new Error("Unable to find child with id "+e.id+". Was it deleted ?");if(n==e.id)return this;void 0!=this._childrenMap[n]&&this.extractChildById(n),r?(this._linkAfterMe(o,t),t.hasNext||(this._tail=t)):(this._linkBeforeMe(o,t),t.hasPrev||(this._head=t))}return this._childrenCount++,this._childrenMap[n]=t,this}},{key:"getChildById",value:function(e){return this._childrenMap[e]}},{key:"merge",value:function(e){return this.mergeAfterChild(this.tail,e),this.notifyChange({type:t.EVENTS.MERGE,eventSource:this,node:e}),this}},{key:"mergeAfterChild",value:function(e,r){if(this.constructor===r.constructor&&r.id!=this.id){for(var n=e,o=r.head;o;){var s=o.next;o.hasParent&&(o=o.parent.extractChildById(o.id)),this.addChildAfter(n,o),this.notifyChange({type:t.EVENTS.MERGE_AFTER_CHILD,eventSource:this,node:o}),n=o,o=s}return r.parent?r.parent.deleteChildById(r.id):r.resetNode(),this}}},{key:"splitAtChild",value:function(e){if(e&&this._childrenMap.hasOwnProperty(e.id)){var r=new this.constructor;return r.push(e),this.notifyChange({type:t.EVENTS.SPLIT_AT_CHILD,eventSource:this,node:e,newNode:r}),this.parent&&this.parent.addChildAfter(this,r),r}}},{key:"splitAfterChild",value:function(e){if(e&&this._childrenMap.hasOwnProperty(e.id)){var r=new this.constructor;return e.hasNext&&r.push(e.next),this.notifyChange({type:t.EVENTS.SPLIT_AFTER_CHILD,eventSource:this,node:e,newNode:r}),this.parent&&this.parent.addChildAfter(this,r),r}}},{key:"forEach",value:function(e){for(var t=0,r=this.head;r;){var n=r.next;e(r,t),t++,r=n}}},{key:"_linkAfterMe",value:function(e,t){if(t.parent=e.parent,e.hasNext){var r=e.next;r.prev=t}t.next=e.next,t.prev=e,e.next=t}},{key:"_linkBeforeMe",value:function(e,t){if(t.parent=e.parent,e.hasPrev){var r=e.prev;r.next=t}t.prev=e.prev,t.next=e,e.prev=t}},{key:"_delinkNode",value:function(e){var t=e.prev,r=e.next;t&&(t.next=r),r&&(r.prev=t),e._prev=null,e._next=null,e._parent=null}},{key:"visitorEnter",value:function(e){e.enter(this),this.visitFirstChild(e)}},{key:"visitFirstChild",value:function(e){this.hasChildren&&this.firstChild.visitStart(e)}},{key:"deleteIfNoChildren",value:function(){this.hasChildren||this.parent&&this.parent.deleteChildById(this.id)}},{key:"markupTagContent",value:function(e,t){var r="";return this.forEach(function(n,o){return r+=n.toMarkup(e,t)}),r}},{key:"serializableData",value:function(){var e=[];return this.forEach(function(t,r){e.push(t.serialize())}),e}},{key:"clone",value:function(){var e=u(Object.getPrototypeOf(t.prototype),"clone",this).call(this);return this.forEach(function(t,r){var n=t.clone();e.push(n)}),e}},{key:"deserializeData",value:function(e,t){var r=this;t.forEach(function(t){var n=e.deserialize(t);r.push(n)})}},{key:"context",value:function(){var e=this.parent,t=this.prev;return{parentNode:e,prevNode:t,node:this.clone()}}},{key:"childrenCount",get:function(){return this._childrenCount}},{key:"head",get:function(){return this._head}},{key:"tail",get:function(){return this._tail}},{key:"isEmpty",get:function(){return 0===this.childrenCount}},{key:"isOnlyChild",get:function(){var e=this.parent;return e?1===e.childrenCount:!1}},{key:"isHeadNode",get:function(){var e=this.parent;return e?e.head.id===this.id:!1}},{key:"isTailNode",get:function(){var e=this.parent;return e?e.tail.id===this.id:!1}},{key:"hasChildren",get:function(){return this.childrenCount>0?!0:!1}},{key:"firstChild",get:function(){return this.head}},{key:"lastChild",get:function(){return this.tail}}]),t}(d["default"]);f.EVENTS=(0,h["default"])({PUSH_AN_ITEM:null,PUSH:null,POP:null,DELETE_CHILD:null,EXTRACT_CHILD:null,ADD_CHILD_AFTER:null,ADD_CHILD_BEFORE:null,MERGE:null,MERGE_AFTER_CHILD:null,SPLIT_AT_CHILD:null,SPLIT_AFTER_CHILD:null}),t.exports=f},{"./../Node.js":5,keymirror:40}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContainerNode"),c=n(u),d=e("./../../UndoManager.js"),p=n(d),h=function(e){function t(e){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e));return r._undoManager=new p["default"](r),r}return a(t,e),l(t,[{key:"undoSnapshot",value:function(){this.undoManager.snapshot()}},{key:"undo",get:function(){this.undoManager.undo}},{key:"redo",get:function(){this.undoManager.redo}},{key:"undoManager",get:function(){return this._undoManager}}]),t}(c["default"]);t.exports=h},{"./../../UndoManager.js":4,"./ContainerNode":7}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=e("./PageNode"),u=n(l),c=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),t}(u["default"]);t.exports=c},{"./PageNode":13}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContainerNode"),c=n(u),d=e("./PageNode"),p=n(d),h=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),l(t,[{key:"canBeAChildTo",value:function(e){return e instanceof p["default"]?!0:!1}}]),t}(c["default"]);t.exports=h},{"./ContainerNode":7,"./PageNode":13}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function m(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,r)}if("value"in n)return n.value;var s=n.get;if(void 0!==s)return s.call(r)},c=e("./LineNode"),d=n(c),p=e("./ListNode"),h=n(p),f=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),l(t,[{key:"deleteIfNoChildren",value:function(){var e=this.parent;u(Object.getPrototypeOf(t.prototype),"deleteIfNoChildren",this).call(this),e&&e.deleteIfNoChildren()}},{key:"canBeAChildTo",value:function(e){return e instanceof h["default"]?!0:!1}}]),t}(d["default"]);t.exports=f},{"./LineNode":10,"./ListNode":12}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContainerNode"),c=n(u),d=e("./PageNode"),p=n(d),h=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),l(t,[{key:"canBeAChildTo",value:function(e){return e instanceof p["default"]?!0:!1}}]),t}(c["default"]);t.exports=h},{"./ContainerNode":7,"./PageNode":13}],13:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=e("./ContainerNode"),u=n(l),c=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),t}(u["default"]);t.exports=c},{"./ContainerNode":7}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentNode"),c=n(u),d=e("./../container/PageNode"),p=n(d),h=e("keymirror"),f=function(e){function t(e){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this));return r.width=140,r.height=70,r.type=e,r}return a(t,e),l(t,[{key:"canBeAChildTo",value:function(e){return e instanceof p["default"]?!0:!1}},{key:"cloneSelf",value:function(){return new this.constructor(this.type,this.id)}},{key:"serializableData",value:function(){return{width:this.width,height:this.height,type:this.type,sheetRange:this.sheetRange}}},{key:"deserializeData",value:function(e,t){this.width=t.width,this.height=t.height,this.type=t.type,this.sheetRange=t.sheetRange}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"sheetRange",get:function(){return this._sheetRange},set:function(e){this._sheetRange=e}},{key:"type",get:function(){return this._type},set:function(e){if(!t.TYPE.hasOwnProperty(e))throw new Error("Unknown chart type "+e);this._type=e}}]),t}(c["default"]);f.TYPE=h({LINE:null,VBAR:null,HBAR:null,PIE:null,DONUT:null}),t.exports=f},{"./../container/PageNode":13,"./ContentNode":15,keymirror:40}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0
}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function h(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:h(o,t,r)}if("value"in n)return n.value;var s=n.get;if(void 0!==s)return s.call(r)},c=e("./../Node.js"),d=n(c),p=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),l(t,[{key:"isContentSelectable",value:function(){return!1}},{key:"clone",value:function(){return u(Object.getPrototypeOf(t.prototype),"clone",this).call(this)}},{key:"deleteIfEmpty",value:function(){}},{key:"hasContent",get:function(){return!0}},{key:"isOnlyChild",get:function(){var e=this.parent;return e?1===e.childrenCount:!1}},{key:"isHeadNode",get:function(){var e=this.parent;return e?e.head.id===this.id:!1}},{key:"isTailNode",get:function(){var e=this.parent;return e?e.tail.id===this.id:!1}}]),t}(d["default"]);t.exports=p},{"./../Node.js":5}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentNode"),c=n(u),d=e("./../container/PageNode"),p=n(d),h=function(e){function t(e){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e));return r.width=140,r.height=70,r}return a(t,e),l(t,[{key:"canBeAChildTo",value:function(e){return e instanceof p["default"]?!0:!1}},{key:"serializableData",value:function(){return{width:this.width,height:this.height,imgData:this.imgData}}},{key:"deserializeData",value:function(e,t){this.width=t.width,this.height=t.height,this.imgData=t.imgData}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"imgData",get:function(){return this._imgData},set:function(e){this._imgData=e}}]),t}(c["default"]);t.exports=h},{"./../container/PageNode":13,"./ContentNode":15}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentNode"),c=n(u),d=e("./../container/PageNode"),p=n(d),h=e("object-assign"),f=(n(h),function(e){function t(e){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e));return r.sheetRange="A1:C3",r}return a(t,e),l(t,[{key:"canBeAChildTo",value:function(e){return e instanceof p["default"]?!0:!1}},{key:"serializableData",value:function(){return{sheetRange:this.sheetRange}}},{key:"deserializeData",value:function(e,t){this.sheetRange=t.sheetRange}},{key:"sheetRange",set:function(e){this._sheetRange=e},get:function(){return this._sheetRange}}]),t}(c["default"]));t.exports=f},{"./../container/PageNode":13,"./ContentNode":15,"object-assign":41}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentNode.js"),c=n(u),d=e("grapheme-splitter"),p=n(d),h=e("./../container/LineNode"),f=n(h),m=e("keymirror"),y=n(m),v=function(e){function t(e,r){o(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,r));return e||(e=""),n.text=e,n}return a(t,e),l(t,[{key:"splitNodeAfter",value:function(e){var r=new t("");if(0>=e)r.text=this.text,this.text="";else if(e<this.size){var n=this._headAndTail(e),o=n[0],s=n[1];this.text=o,r.text=s}for(var a in this.style)r.addStyle(this.style[a]);return this.notifyChange({type:t.EVENTS.SPLIT_NODE_AFTER,eventSource:this,newNode:r}),this.parent&&this.parent.addChildAfter(this,r),r}},{key:"splitNodeBefore",value:function(e){var r=new t("");if(e>=this.size)r.text=this.text,this.text="";else if(e>0){var n=this._headAndTail(e),o=n[0],s=n[1];this.text=s,r=new t(o)}for(var a in this.style)r.addStyle(this.style[a]);return this.notifyChange({type:t.EVENTS.SPLIT_NODE_BEFORE,eventSource:this,newNode:r}),this.parent&&this.parent.addChildBefore(this,r),r}},{key:"splitNodeBetween",value:function(e,r){if(e===r)return null;var n=null,o=null;return n=0===e?this:this.splitNodeAfter(e),o=r-e===n.size?n:n.splitNodeBefore(r-e),this.notifyChange({type:t.EVENTS.SPLIT_NODE_BETWEEN,eventSource:this,newNode:o}),o}},{key:"_headAndTail",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?e:arguments[1],r=p["default"].splitGraphemes(this.text),n=r.slice(0,e),o=r.slice(t,r.length);return[n.join(""),o.join("")]}},{key:"handleBackspaceAt",value:function(e){if(0===e){var r=this.prev;if(r)return r.handleBackspaceAt(r.size);var n=this.parent.prev;return n?(n.merge(this.parent),this.notifyChange({type:t.EVENTS.HANDLE_KEY_BACKSPACE,eventSource:this}),this.hasPrev?{node:this.prev,offset:this.prev.size}:{node:this,offset:e}):{node:this,offset:e}}this.removeCharBetween(e-1,e);var o=this.prev;return""===this.text&&o?(this.parent.deleteChildById(this.id),{node:o,offset:o.size}):(this.notifyChange({type:t.EVENTS.HANDLE_KEY_BACKSPACE,eventSource:this}),{node:this,offset:e-1})}},{key:"handleDeleteAt",value:function(e){if(e>=this.size){var r=this.next;if(r)return r.handleDeleteAt(0);var n=this.parent.next;return n?(this.parent.merge(n),this.notifyChange({type:t.EVENTS.HANDLE_KEY_DELETE,eventSource:this}),this.hasNext?{node:this.next,offset:0}:{node:this,offset:e}):{node:this,offset:e}}this.removeCharBetween(e,e+1);var o=this.next;return""===this.text&&o?(this.parent.deleteChildById(this.id),{node:o,offset:0}):(this.notifyChange({type:t.EVENTS.HANDLE_KEY_DELETE,eventSource:this}),{node:this,offset:e})}},{key:"handleReturnAt",value:function(e){var r=this.parent,n=void 0;if(0===e)n=r.splitAtChild(this);else if(e<this.size){var o=this.splitNodeAfter(e);n=r.splitAtChild(o)}else e>=this.size&&(n=r.splitAfterChild(this));return n.head||n.push(new this.constructor),r.head||r.push(new this.constructor),this.notifyChange({type:t.EVENTS.HANDLE_KEY_RETURN,eventSource:this}),{node:n.head,offset:0}}},{key:"removeCharBetween",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?e+1:arguments[1];this.text=this._headAndTail(e,t).join("")}},{key:"insertStrAt",value:function(e,t){var r=this._headAndTail(e),n=r[0],o=r[1];this.text=""+n+t+o}},{key:"deleteIfEmpty",value:function(){this.isEmpty&&this.parent&&this.parent.deleteChildById(this.id)}},{key:"markupTagContent",value:function(e,t){return this.text}},{key:"canBeAChildTo",value:function(e){return e instanceof f["default"]?!0:!1}},{key:"isContentSelectable",value:function(){return!0}},{key:"serializableData",value:function(){return{text:this.text}}},{key:"deserializeData",value:function(e,t){this.text=t.text}},{key:"cloneSelf",value:function(){return new this.constructor(this.text,this.id)}},{key:"text",set:function(e){e||(e=""),this._text=e,this.notifyChange({type:t.EVENTS.TEXT_CHANGE,eventSource:this})},get:function(){return this._text}},{key:"size",get:function(){return this.text?p["default"].countGraphemes(this.text):0}},{key:"length",get:function(){return this.size}},{key:"isEmpty",get:function(){return""===this.text}},{key:"hasContent",get:function(){return!this.isEmpty}}]),t}(c["default"]);v.EVENTS=(0,y["default"])({SPLIT_NODE_AFTER:null,SPLIT_NODE_BEFORE:null,SPLIT_NODE_BETWEEN:null,HANDLE_KEY_BACKSPACE:null,HANDLE_KEY_DELETE:null,HANDLE_KEY_RETURN:null,TEXT_CHANGE:null}),t.exports=v},{"./../container/LineNode":10,"./ContentNode.js":15,"grapheme-splitter":39,keymirror:40}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./../node/content/ContentNode.js"),i=n(a),l=function(){function e(t){o(this,e),this._visitRange=t,this._affectedContainerNodes=[],this._affectedContainerNodesDict={},this._affectedContentNodesInAContainer={},this._affectedContentNodes=[]}return s(e,[{key:"affectedContentNodesInAContainer",value:function(e){return e?this._affectedContentNodesInAContainer[e.id]:[]}},{key:"enter",value:function(e){e instanceof i["default"]&&this.isContentNodeAffected(e)&&this._setAffectedNode(e)}},{key:"isContentNodeAffected",value:function(e){return!0}},{key:"exit",value:function(e){!(e instanceof i["default"])}},{key:"perform",value:function(){var e=this;if(this.shouldPerform()){this.willPerform();var t=this.iterationStartNode;t.visitStart(this);var r=t.parentHierarchyTillRoot;r.forEach(function(t){t.visitNextNeighbour(e)}),this.didPerform()}}},{key:"shouldPerform",value:function(){return!0}},{key:"willPerform",value:function(){}},{key:"didPerform",value:function(){}},{key:"_setAffectedNode",value:function(e){this._affectedContentNodes.push(e);var t=e.parent;t&&(this._affectedContainerNodesDict[t.id]||(this._affectedContainerNodesDict[t.id]=t.id,this._affectedContainerNodes.push(t)),this._affectedContentNodesInAContainer[t.id]||(this._affectedContentNodesInAContainer[t.id]=[]),this._affectedContentNodesInAContainer[t.id].push(e))}},{key:"affectedContentNodes",get:function(){return this._affectedContentNodes}},{key:"affectedContainerNodes",get:function(){return this._affectedContainerNodes}},{key:"visitRange",get:function(){return this._visitRange}},{key:"iterationStartNode",get:function(){throw new Error("Should be implemented by sub class")}},{key:"iterationEndNode",get:function(){throw new Error("Should be implemented by sub class")}}]),e}();t.exports=l},{"./../node/content/ContentNode.js":15}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentVisitor.js"),c=n(u),d=e("./VisitRange.js"),p=(n(d),e("./../Clipboard.js")),h=n(p),f=e("./../node/container/ListItemNode.js"),m=n(f),y=e("./../node/container/ListNode.js"),v=n(y),g=function(e){function t(e){var r=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];o(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e));return n._doCut=r,n}return a(t,e),l(t,[{key:"willPerform",value:function(){this._setIterationStartNode(),this._setIterationEndNode()}},{key:"shouldPerform",value:function(){return!this._noSelection}},{key:"didPerform",value:function(){var e=this,t=[];this.affectedContainerNodes.forEach(function(r){var n=r.newInstance(),o=e.affectedContentNodesInAContainer(r);if(o.forEach(function(e){e.hasContent&&n.push(e.clone())}),n.hasChildren)if(n instanceof m["default"]){var s=t.pop();if(s instanceof v["default"])s.push(n),t.push(s);else{var a=new v["default"];a.push(n),t.push(s),t.push(a)}}else t.push(n)}),h["default"].content=t,this.doCut&&this._removeSelectedNodes(),this.iterationStartNode.deleteIfEmpty(),this.iterationEndNode.deleteIfEmpty()}},{key:"_removeSelectedNodes",value:function(){var e=this;this.affectedContainerNodes.forEach(function(t){var r=e.affectedContentNodesInAContainer(t);r.forEach(function(e){t.deleteChildById(e.id)})})}},{key:"_setIterationStartNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset;this.iterationStartNode=e.splitNodeAfter(t),0===e.length&&e.parent.deleteChildById(e.id)}},{key:"_setIterationEndNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset,r=this.visitRange.selectionEndNode,n=this.visitRange.selectionEndOffset,o=r,s=n;e.id===r.id&&(s=n-t,o=this.iterationStartNode);var a=o.splitNodeAfter(s);this.iterationEndNode=o,0===a.length&&a.parent.deleteChildById(a.id)}},{key:"doCut",get:function(){return this._doCut}},{key:"iterationStartNode",get:function(){return this._iterationStartNode},set:function(e){this._iterationStartNode=e}},{key:"iterationEndNode",get:function(){return this._iterationEndNode},set:function(e){this._iterationEndNode=e}},{key:"_noSelection",get:function(){var e=this.visitRange;return e.selectionStartNode.id===e.selectionEndNode.id&&e.selectionStartOffset===e.selectionEndOffset}}]),t}(c["default"]);t.exports=g},{"./../Clipboard.js":2,"./../node/container/ListItemNode.js":11,"./../node/container/ListNode.js":12,"./ContentVisitor.js":19,"./VisitRange.js":25}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentVisitor.js"),c=n(u),d=e("./VisitRange.js"),p=(n(d),function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),l(t,[{key:"willPerform",value:function(){this._setIterationStartNode(),this._setIterationEndNode()}},{key:"shouldPerform",value:function(){return!this._noSelection}},{key:"didPerform",value:function(){var e=this;this.affectedContainerNodes.forEach(function(t){var r=e.affectedContentNodesInAContainer(t);r.forEach(function(e){t.deleteChildById(e.id)})}),this.iterationStartNode.deleteIfEmpty(),this.iterationEndNode.deleteIfEmpty()}},{key:"_setIterationStartNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset;this.iterationStartNode=e.splitNodeAfter(t),0===e.length&&e.parent.deleteChildById(e.id)}},{key:"_setIterationEndNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset,r=this.visitRange.selectionEndNode,n=this.visitRange.selectionEndOffset,o=r,s=n;e.id===r.id&&(s=n-t,o=this.iterationStartNode);var a=o.splitNodeAfter(s);this.iterationEndNode=o,0===a.length&&a.parent.deleteChildById(a.id)}},{key:"iterationStartNode",get:function(){return this._iterationStartNode},set:function(e){this._iterationStartNode=e}},{key:"iterationEndNode",get:function(){return this._iterationEndNode},set:function(e){this._iterationEndNode=e}},{key:"_noSelection",get:function(){var e=this.visitRange;return e.selectionStartNode.id===e.selectionEndNode.id&&e.selectionStartOffset===e.selectionEndOffset}}]),t}(c["default"]));t.exports=p},{"./ContentVisitor.js":19,"./VisitRange.js":25}],22:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentVisitor.js"),c=n(u),d=e("./../node/Style.js"),p=(n(d),e("./../node/Node.js")),h=(n(p),e("./../node/container/LineNode.js")),f=n(h),m=e("./../node/container/ListItemNode.js"),y=n(m),v=e("./../node/container/ListNode.js"),g=n(v),b=e("./../node/content/TextNode.js"),_=n(b),C=e("./VisitRange.js"),x=(n(C),function(e){function t(e){o(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e));return r._insertNodes=function(e,t){e instanceof y["default"]?!function(){var r=e.parent,n=r.parent,o=r.splitAfterChild(e);n.addChildAfter(r,o);var s=r;t.forEach(function(e){s.parent.addChildAfter(s,e),s=e}),r.deleteIfNoChildren(),o.deleteIfNoChildren()}():e instanceof f["default"]&&!function(){var r=e.parent,n=e;t.forEach(function(e){r.addChildAfter(n,e),n=e})}(),this.affectedContainerNodes.forEach(function(e){e.deleteIfNoChildren()})},r._constructNodes=function(e){this.affectedContainerNodes.forEach(function(t){if(t instanceof y["default"]){var r=new f["default"];r.push(t.head),e.push(r)}else if(t instanceof f["default"]){var n=e[e.length-1];n instanceof g["default"]||(n=new g["default"],e.push(n));var o=new y["default"];o.push(t.head),n.push(o)}})},r.ignoreAnyFurtherNodes=!1,r}return a(t,e),l(t,[{key:"willPerform",value:function(){this._setIterationStartNode(),this._setIterationEndNode()}},{key:"isContentNodeAffected",value:function(e){return e.isContentSelectable()||(this.ignoreAnyFurtherNodes=!0),this.ignoreAnyFurtherNodes?!1:e instanceof _["default"]?!0:!1}},{key:"didPerform",value:function(){if(0!=this.affectedContainerNodes.length){var e=this.iterationStartNode.parent,t=[];this._constructNodes(t),this._insertNodes(e,t)}}},{key:"_setIterationStartNode",value:function(){this.iterationStartNode=this.visitRange.selectionStartNode}},{key:"_setIterationEndNode",value:function(){this.iterationEndNode=this.visitRange.selectionEndNode}},{key:"iterationStartNode",get:function(){return this._iterationStartNode},set:function(e){this._iterationStartNode=e}},{key:"iterationEndNode",get:function(){return this._iterationEndNode},set:function(e){this._iterationEndNode=e}}]),t}(c["default"]));t.exports=x},{"./../node/Node.js":5,"./../node/Style.js":6,"./../node/container/LineNode.js":10,"./../node/container/ListItemNode.js":11,"./../node/container/ListNode.js":12,"./../node/content/TextNode.js":18,"./ContentVisitor.js":19,"./VisitRange.js":25}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentVisitor.js"),c=n(u),d=e("./VisitRange.js"),p=(n(d),e("./../Clipboard.js")),h=n(p),f=e("./../node/container/ListNode.js"),m=n(f),y=e("./../node/container/ListItemNode.js"),v=n(y),g=e("./../node/container/LineNode.js"),b=n(g),_=function(e){function t(e){return o(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),l(t,[{key:"willPerform",value:function(){this._setIterationStartNode(),this._setIterationEndNode()}},{key:"didPerform",value:function(){this._insertNodesAtIterationStart(),this.iterationStartNode.deleteIfEmpty(),this.iterationEndNode.deleteIfEmpty()}},{key:"_splitAtIterationStartNode",value:function(){var e=this.iterationStartNode.parent;if(e instanceof v["default"]){e.splitAfterChild(this.iterationStartNode);var t=e.parent;t.splitAfterChild(e)}else e instanceof b["default"]&&e.splitAfterChild(this.iterationStartNode)}},{key:"_insertNodesAtIterationStart",value:function(){var e=h["default"].content;if(e&&e.constructor===[].constructor&&e.length>0){var t=e.shift(),r=this.iterationStartNode.parent;if(r instanceof v["default"]&&t instanceof m["default"]){r.mergeAfterChild(this.iterationStartNode,t.head);var n=r.parent;n.mergeAfterChild(r,t)}else r.mergeAfterChild(this.iterationStartNode,t)||e.unshift(t);e.length>0&&this._splitAtIterationStartNode();var o=r,s=o.parent;s instanceof m["default"]&&(o=s,s=s.parent),e.forEach(function(e){s.addChildAfter(o,e)})}}},{key:"_setIterationStartNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset;this.iterationStartNode=e.splitNodeAfter(t),0===e.length&&e.parent.deleteChildById(e.id)}},{key:"_setIterationEndNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset,r=this.visitRange.selectionEndNode,n=this.visitRange.selectionEndOffset,o=r,s=n;e.id===r.id&&(s=n-t,o=this.iterationStartNode);var a=o.splitNodeAfter(s);this.iterationEndNode=o,0===a.length&&a.parent.deleteChildById(a.id)}},{key:"iterationStartNode",get:function(){return this._iterationStartNode},set:function(e){this._iterationStartNode=e}},{key:"iterationEndNode",get:function(){return this._iterationEndNode},set:function(e){this._iterationEndNode=e}}]),t}(c["default"]);t.exports=_},{"./../Clipboard.js":2,"./../node/container/LineNode.js":10,"./../node/container/ListItemNode.js":11,"./../node/container/ListNode.js":12,"./ContentVisitor.js":19,"./VisitRange.js":25}],24:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ContentVisitor.js"),c=n(u),d=e("./../node/Style.js"),p=(n(d),e("./../node/content/TextNode.js")),h=n(p),f=e("./VisitRange.js"),m=(n(f),function(e){function t(e,r){o(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e));return n.style=r,n.removeStyle=!0,n}return a(t,e),l(t,[{key:"willPerform",value:function(){this._setIterationStartNode(),this._setIterationEndNode()}},{key:"isContentNodeAffected",value:function(e){return e instanceof h["default"]?""===e.text.trim()?!1:(this.removeStyle&&!e.hasStyle(this.style)&&(this.removeStyle=!1),!0):!1}},{key:"shouldPerform",value:function(){return!this._noSelection}},{key:"didPerform",value:function(){var e=this;this.affectedContentNodes.forEach(function(t){e.removeStyle?t.removeStyle(e.style):t.addStyle(e.style)}),this.iterationStartNode.deleteIfEmpty(),this.iterationEndNode.deleteIfEmpty()}},{key:"_setIterationStartNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset;this.iterationStartNode=e.splitNodeAfter(t),0===e.length&&e.parent.deleteChildById(e.id)}},{key:"_setIterationEndNode",value:function(){var e=this.visitRange.selectionStartNode,t=this.visitRange.selectionStartOffset,r=this.visitRange.selectionEndNode,n=this.visitRange.selectionEndOffset,o=r,s=n;e.id===r.id&&(s=n-t,o=this.iterationStartNode);var a=o.splitNodeAfter(s);this.iterationEndNode=o,0===a.length&&a.parent.deleteChildById(a.id)}},{key:"iterationStartNode",get:function(){return this._iterationStartNode},set:function(e){this._iterationStartNode=e}},{key:"iterationEndNode",get:function(){return this._iterationEndNode},set:function(e){this._iterationEndNode=e}},{key:"_noSelection",get:function(){var e=this.visitRange;return e.selectionStartNode.id===e.selectionEndNode.id&&e.selectionStartOffset===e.selectionEndOffset}}]),t}(c["default"]));t.exports=m},{"./../node/Style.js":6,"./../node/content/TextNode.js":18,"./ContentVisitor.js":19,"./VisitRange.js":25}],25:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(t,r,o,s){n(this,e),this._selectionStartNode=t,this._selectionStartOffset=r,this._selectionEndNode=o,this._selectionEndOffset=s}return o(e,[{key:"selectionStartNode",get:function(){return this._selectionStartNode}},{key:"selectionStartOffset",get:function(){return this._selectionStartOffset}},{key:"selectionEndNode",get:function(){return this._selectionEndNode}},{key:"selectionEndOffset",get:function(){return this._selectionEndOffset}}]),e}();t.exports=s},{}],26:[function(e,t,r){"use strict";t.exports=e("./inject")(e("acorn"))},{"./inject":27,acorn:28}],27:[function(e,t,r){"use strict";var n=e("./xhtml"),o=/^[\da-fA-F]+$/,s=/^\d+$/;t.exports=function(e){function t(e){return"JSXIdentifier"===e.type?e.name:"JSXNamespacedName"===e.type?e.namespace.name+":"+e.name.name:"JSXMemberExpression"===e.type?t(e.object)+"."+t(e.property):void 0}var r=e.tokTypes,a=e.tokContexts;a.j_oTag=new e.TokContext("<tag",!1),a.j_cTag=new e.TokContext("</tag",!1),a.j_expr=new e.TokContext("<tag>...</tag>",!0,!0),r.jsxName=new e.TokenType("jsxName"),r.jsxText=new e.TokenType("jsxText",{beforeExpr:!0}),r.jsxTagStart=new e.TokenType("jsxTagStart"),r.jsxTagEnd=new e.TokenType("jsxTagEnd"),r.jsxTagStart.updateContext=function(){this.context.push(a.j_expr),this.context.push(a.j_oTag),this.exprAllowed=!1},r.jsxTagEnd.updateContext=function(e){var t=this.context.pop();t===a.j_oTag&&e===r.slash||t===a.j_cTag?(this.context.pop(),this.exprAllowed=this.curContext()===a.j_expr):this.exprAllowed=!0};var i=e.Parser.prototype;return i.jsx_readToken=function(){for(var t="",n=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated JSX contents");var o=this.input.charCodeAt(this.pos);switch(o){case 60:case 123:return this.pos===this.start?60===o&&this.exprAllowed?(++this.pos,this.finishToken(r.jsxTagStart)):this.getTokenFromCode(o):(t+=this.input.slice(n,this.pos),this.finishToken(r.jsxText,t));
case 38:t+=this.input.slice(n,this.pos),t+=this.jsx_readEntity(),n=this.pos;break;default:e.isNewLine(o)?(t+=this.input.slice(n,this.pos),t+=this.jsx_readNewLine(!0),n=this.pos):++this.pos}}},i.jsx_readNewLine=function(e){var t,r=this.input.charCodeAt(this.pos);return++this.pos,13===r&&10===this.input.charCodeAt(this.pos)?(++this.pos,t=e?"\n":"\r\n"):t=String.fromCharCode(r),this.options.locations&&(++this.curLine,this.lineStart=this.pos),t},i.jsx_readString=function(t){for(var n="",o=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===t)break;38===s?(n+=this.input.slice(o,this.pos),n+=this.jsx_readEntity(),o=this.pos):e.isNewLine(s)?(n+=this.input.slice(o,this.pos),n+=this.jsx_readNewLine(!1),o=this.pos):++this.pos}return n+=this.input.slice(o,this.pos++),this.finishToken(r.string,n)},i.jsx_readEntity=function(){var e,t="",r=0,a=this.input[this.pos];"&"!==a&&this.raise(this.pos,"Entity must start with an ampersand");for(var i=++this.pos;this.pos<this.input.length&&r++<10;){if(a=this.input[this.pos++],";"===a){"#"===t[0]?"x"===t[1]?(t=t.substr(2),o.test(t)&&(e=String.fromCharCode(parseInt(t,16)))):(t=t.substr(1),s.test(t)&&(e=String.fromCharCode(parseInt(t,10)))):e=n[t];break}t+=a}return e?e:(this.pos=i,"&")},i.jsx_readWord=function(){var t,n=this.pos;do t=this.input.charCodeAt(++this.pos);while(e.isIdentifierChar(t)||45===t);return this.finishToken(r.jsxName,this.input.slice(n,this.pos))},i.jsx_parseIdentifier=function(){var e=this.startNode();return this.type===r.jsxName?e.name=this.value:this.type.keyword?e.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(e,"JSXIdentifier")},i.jsx_parseNamespacedName=function(){var e=this.start,t=this.startLoc,n=this.jsx_parseIdentifier();if(!this.eat(r.colon))return n;var o=this.startNodeAt(e,t);return o.namespace=n,o.name=this.jsx_parseIdentifier(),this.finishNode(o,"JSXNamespacedName")},i.jsx_parseElementName=function(){for(var e=this.start,t=this.startLoc,n=this.jsx_parseNamespacedName();this.eat(r.dot);){var o=this.startNodeAt(e,t);o.object=n,o.property=this.jsx_parseIdentifier(),n=this.finishNode(o,"JSXMemberExpression")}return n},i.jsx_parseAttributeValue=function(){switch(this.type){case r.braceL:var e=this.jsx_parseExpressionContainer();return"JSXEmptyExpression"===e.expression.type&&this.raise(e.start,"JSX attributes must only be assigned a non-empty expression"),e;case r.jsxTagStart:case r.string:return this.parseExprAtom();default:this.raise(this.start,"JSX value should be either an expression or a quoted JSX text")}},i.jsx_parseEmptyExpression=function(){var e=this.startNodeAt(this.lastTokEnd,this.lastTokEndLoc);return this.finishNodeAt(e,"JSXEmptyExpression",this.start,this.startLoc)},i.jsx_parseExpressionContainer=function(){var e=this.startNode();return this.next(),e.expression=this.type===r.braceR?this.jsx_parseEmptyExpression():this.parseExpression(),this.expect(r.braceR),this.finishNode(e,"JSXExpressionContainer")},i.jsx_parseAttribute=function(){var e=this.startNode();return this.eat(r.braceL)?(this.expect(r.ellipsis),e.argument=this.parseMaybeAssign(),this.expect(r.braceR),this.finishNode(e,"JSXSpreadAttribute")):(e.name=this.jsx_parseNamespacedName(),e.value=this.eat(r.eq)?this.jsx_parseAttributeValue():null,this.finishNode(e,"JSXAttribute"))},i.jsx_parseOpeningElementAt=function(e,t){var n=this.startNodeAt(e,t);for(n.attributes=[],n.name=this.jsx_parseElementName();this.type!==r.slash&&this.type!==r.jsxTagEnd;)n.attributes.push(this.jsx_parseAttribute());return n.selfClosing=this.eat(r.slash),this.expect(r.jsxTagEnd),this.finishNode(n,"JSXOpeningElement")},i.jsx_parseClosingElementAt=function(e,t){var n=this.startNodeAt(e,t);return n.name=this.jsx_parseElementName(),this.expect(r.jsxTagEnd),this.finishNode(n,"JSXClosingElement")},i.jsx_parseElementAt=function(e,n){var o=this.startNodeAt(e,n),s=[],a=this.jsx_parseOpeningElementAt(e,n),i=null;if(!a.selfClosing){e:for(;;)switch(this.type){case r.jsxTagStart:if(e=this.start,n=this.startLoc,this.next(),this.eat(r.slash)){i=this.jsx_parseClosingElementAt(e,n);break e}s.push(this.jsx_parseElementAt(e,n));break;case r.jsxText:s.push(this.parseExprAtom());break;case r.braceL:s.push(this.jsx_parseExpressionContainer());break;default:this.unexpected()}t(i.name)!==t(a.name)&&this.raise(i.start,"Expected corresponding JSX closing tag for <"+t(a.name)+">")}return o.openingElement=a,o.closingElement=i,o.children=s,this.type===r.relational&&"<"===this.value&&this.raise(this.start,"Adjacent JSX elements must be wrapped in an enclosing tag"),this.finishNode(o,"JSXElement")},i.jsx_parseElement=function(){var e=this.start,t=this.startLoc;return this.next(),this.jsx_parseElementAt(e,t)},e.plugins.jsx=function(t){t.extend("parseExprAtom",function(e){return function(t){return this.type===r.jsxText?this.parseLiteral(this.value):this.type===r.jsxTagStart?this.jsx_parseElement():e.call(this,t)}}),t.extend("readToken",function(t){return function(n){var o=this.curContext();if(o===a.j_expr)return this.jsx_readToken();if(o===a.j_oTag||o===a.j_cTag){if(e.isIdentifierStart(n))return this.jsx_readWord();if(62==n)return++this.pos,this.finishToken(r.jsxTagEnd);if((34===n||39===n)&&o==a.j_oTag)return this.jsx_readString(n)}return 60===n&&this.exprAllowed?(++this.pos,this.finishToken(r.jsxTagStart)):t.call(this,n)}}),t.extend("updateContext",function(e){return function(t){if(this.type==r.braceL){var n=this.curContext();n==a.j_oTag?this.context.push(a.b_expr):n==a.j_expr?this.context.push(a.b_tmpl):e.call(this,t),this.exprAllowed=!0}else{if(this.type!==r.slash||t!==r.jsxTagStart)return e.call(this,t);this.context.length-=2,this.context.push(a.j_cTag),this.exprAllowed=!1}}})},e}},{"./xhtml":29}],28:[function(e,t,r){(function(n){!function(e){if("object"==typeof r&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof n?n:"undefined"!=typeof self?self:this,o.acorn=e()}}(function(){return function t(r,n,o){function s(i,l){if(!n[i]){if(!r[i]){var u="function"==typeof e&&e;if(!l&&u)return u(i,!0);if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[i]={exports:{}};r[i][0].call(d.exports,function(e){var t=r[i][1][e];return s(t?t:e)},d,d.exports,t,r,n,o)}return n[i].exports}for(var a="function"==typeof e&&e,i=0;i<o.length;i++)s(o[i]);return s}({1:[function(e,t,r){"use strict";var n=e("./tokentype"),o=e("./state"),s=o.Parser.prototype;s.checkPropClash=function(e,t){if(!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var r=e.key,n=void 0;switch(r.type){case"Identifier":n=r.name;break;case"Literal":n=String(r.value);break;default:return}var o=e.kind;if(this.options.ecmaVersion>=6)return void("__proto__"===n&&"init"===o&&(t.proto&&this.raise(r.start,"Redefinition of __proto__ property"),t.proto=!0));n="$"+n;var s=t[n];if(s){var a="init"!==o;((this.strict||a)&&s[o]||!(a^s.init))&&this.raise(r.start,"Redefinition of property")}else s=t[n]={init:!1,get:!1,set:!1};s[o]=!0}},s.parseExpression=function(e,t){var r=this.start,o=this.startLoc,s=this.parseMaybeAssign(e,t);if(this.type===n.types.comma){var a=this.startNodeAt(r,o);for(a.expressions=[s];this.eat(n.types.comma);)a.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(a,"SequenceExpression")}return s},s.parseMaybeAssign=function(e,t,r){if(this.type==n.types._yield&&this.inGenerator)return this.parseYield();var o=!1;t||(t={shorthandAssign:0,trailingComma:0},o=!0);var s=this.start,a=this.startLoc;(this.type==n.types.parenL||this.type==n.types.name)&&(this.potentialArrowAt=this.start);var i=this.parseMaybeConditional(e,t);if(r&&(i=r.call(this,i,s,a)),this.type.isAssign){o&&this.checkPatternErrors(t,!0);var l=this.startNodeAt(s,a);return l.operator=this.value,l.left=this.type===n.types.eq?this.toAssignable(i):i,t.shorthandAssign=0,this.checkLVal(i),this.next(),l.right=this.parseMaybeAssign(e),this.finishNode(l,"AssignmentExpression")}return o&&this.checkExpressionErrors(t,!0),i},s.parseMaybeConditional=function(e,t){var r=this.start,o=this.startLoc,s=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return s;if(this.eat(n.types.question)){var a=this.startNodeAt(r,o);return a.test=s,a.consequent=this.parseMaybeAssign(),this.expect(n.types.colon),a.alternate=this.parseMaybeAssign(e),this.finishNode(a,"ConditionalExpression")}return s},s.parseExprOps=function(e,t){var r=this.start,n=this.startLoc,o=this.parseMaybeUnary(t);return this.checkExpressionErrors(t)?o:this.parseExprOp(o,r,n,-1,e)},s.parseExprOp=function(e,t,r,o,s){var a=this.type.binop;if(null!=a&&(!s||this.type!==n.types._in)&&a>o){var i=this.startNodeAt(t,r);i.left=e,i.operator=this.value;var l=this.type;this.next();var u=this.start,c=this.startLoc;return i.right=this.parseExprOp(this.parseMaybeUnary(),u,c,a,s),this.finishNode(i,l===n.types.logicalOR||l===n.types.logicalAND?"LogicalExpression":"BinaryExpression"),this.parseExprOp(i,t,r,o,s)}return e},s.parseMaybeUnary=function(e){if(this.type.prefix){var t=this.startNode(),r=this.type===n.types.incDec;return t.operator=this.value,t.prefix=!0,this.next(),t.argument=this.parseMaybeUnary(),this.checkExpressionErrors(e,!0),r?this.checkLVal(t.argument):this.strict&&"delete"===t.operator&&"Identifier"===t.argument.type&&this.raise(t.start,"Deleting local variable in strict mode"),this.finishNode(t,r?"UpdateExpression":"UnaryExpression")}var o=this.start,s=this.startLoc,a=this.parseExprSubscripts(e);if(this.checkExpressionErrors(e))return a;for(;this.type.postfix&&!this.canInsertSemicolon();){var t=this.startNodeAt(o,s);t.operator=this.value,t.prefix=!1,t.argument=a,this.checkLVal(a),this.next(),a=this.finishNode(t,"UpdateExpression")}return a},s.parseExprSubscripts=function(e){var t=this.start,r=this.startLoc,n=this.parseExprAtom(e),o="ArrowFunctionExpression"===n.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);return this.checkExpressionErrors(e)||o?n:this.parseSubscripts(n,t,r)},s.parseSubscripts=function(e,t,r,o){for(;;)if(this.eat(n.types.dot)){var s=this.startNodeAt(t,r);s.object=e,s.property=this.parseIdent(!0),s.computed=!1,e=this.finishNode(s,"MemberExpression")}else if(this.eat(n.types.bracketL)){var s=this.startNodeAt(t,r);s.object=e,s.property=this.parseExpression(),s.computed=!0,this.expect(n.types.bracketR),e=this.finishNode(s,"MemberExpression")}else if(!o&&this.eat(n.types.parenL)){var s=this.startNodeAt(t,r);s.callee=e,s.arguments=this.parseExprList(n.types.parenR,!1),e=this.finishNode(s,"CallExpression")}else{if(this.type!==n.types.backQuote)return e;var s=this.startNodeAt(t,r);s.tag=e,s.quasi=this.parseTemplate(),e=this.finishNode(s,"TaggedTemplateExpression")}},s.parseExprAtom=function(e){var t=void 0,r=this.potentialArrowAt==this.start;switch(this.type){case n.types._super:this.inFunction||this.raise(this.start,"'super' outside of function or class");case n.types._this:var o=this.type===n.types._this?"ThisExpression":"Super";return t=this.startNode(),this.next(),this.finishNode(t,o);case n.types._yield:this.inGenerator&&this.unexpected();case n.types.name:var s=this.start,a=this.startLoc,i=this.parseIdent(this.type!==n.types.name);return r&&!this.canInsertSemicolon()&&this.eat(n.types.arrow)?this.parseArrowExpression(this.startNodeAt(s,a),[i]):i;case n.types.regexp:var l=this.value;return t=this.parseLiteral(l.value),t.regex={pattern:l.pattern,flags:l.flags},t;case n.types.num:case n.types.string:return this.parseLiteral(this.value);case n.types._null:case n.types._true:case n.types._false:return t=this.startNode(),t.value=this.type===n.types._null?null:this.type===n.types._true,t.raw=this.type.keyword,this.next(),this.finishNode(t,"Literal");case n.types.parenL:return this.parseParenAndDistinguishExpression(r);case n.types.bracketL:return t=this.startNode(),this.next(),this.options.ecmaVersion>=7&&this.type===n.types._for?this.parseComprehension(t,!1):(t.elements=this.parseExprList(n.types.bracketR,!0,!0,e),this.finishNode(t,"ArrayExpression"));case n.types.braceL:return this.parseObj(!1,e);case n.types._function:return t=this.startNode(),this.next(),this.parseFunction(t,!1);case n.types._class:return this.parseClass(this.startNode(),!1);case n.types._new:return this.parseNew();case n.types.backQuote:return this.parseTemplate();default:this.unexpected()}},s.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(t,"Literal")},s.parseParenExpression=function(){this.expect(n.types.parenL);var e=this.parseExpression();return this.expect(n.types.parenR),e},s.parseParenAndDistinguishExpression=function(e){var t=this.start,r=this.startLoc,o=void 0;if(this.options.ecmaVersion>=6){if(this.next(),this.options.ecmaVersion>=7&&this.type===n.types._for)return this.parseComprehension(this.startNodeAt(t,r),!0);for(var s=this.start,a=this.startLoc,i=[],l=!0,u={shorthandAssign:0,trailingComma:0},c=void 0,d=void 0;this.type!==n.types.parenR;){if(l?l=!1:this.expect(n.types.comma),this.type===n.types.ellipsis){c=this.start,i.push(this.parseParenItem(this.parseRest()));break}this.type!==n.types.parenL||d||(d=this.start),i.push(this.parseMaybeAssign(!1,u,this.parseParenItem))}var p=this.start,h=this.startLoc;if(this.expect(n.types.parenR),e&&!this.canInsertSemicolon()&&this.eat(n.types.arrow))return this.checkPatternErrors(u,!0),d&&this.unexpected(d),this.parseParenArrowList(t,r,i);i.length||this.unexpected(this.lastTokStart),c&&this.unexpected(c),this.checkExpressionErrors(u,!0),i.length>1?(o=this.startNodeAt(s,a),o.expressions=i,this.finishNodeAt(o,"SequenceExpression",p,h)):o=i[0]}else o=this.parseParenExpression();if(this.options.preserveParens){var f=this.startNodeAt(t,r);return f.expression=o,this.finishNode(f,"ParenthesizedExpression")}return o},s.parseParenItem=function(e){return e},s.parseParenArrowList=function(e,t,r){return this.parseArrowExpression(this.startNodeAt(e,t),r)};var a=[];s.parseNew=function(){var e=this.startNode(),t=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(n.types.dot))return e.meta=t,e.property=this.parseIdent(!0),"target"!==e.property.name&&this.raise(e.property.start,"The only valid meta property for new is new.target"),this.inFunction||this.raise(e.start,"new.target can only be used in functions"),this.finishNode(e,"MetaProperty");var r=this.start,o=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(),r,o,!0),this.eat(n.types.parenL)?e.arguments=this.parseExprList(n.types.parenR,!1):e.arguments=a,this.finishNode(e,"NewExpression")},s.parseTemplateElement=function(){var e=this.startNode();return e.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),e.tail=this.type===n.types.backQuote,this.finishNode(e,"TemplateElement")},s.parseTemplate=function(){var e=this.startNode();this.next(),e.expressions=[];var t=this.parseTemplateElement();for(e.quasis=[t];!t.tail;)this.expect(n.types.dollarBraceL),e.expressions.push(this.parseExpression()),this.expect(n.types.braceR),e.quasis.push(t=this.parseTemplateElement());return this.next(),this.finishNode(e,"TemplateLiteral")},s.parseObj=function(e,t){var r=this.startNode(),o=!0,s={};for(r.properties=[],this.next();!this.eat(n.types.braceR);){if(o)o=!1;else if(this.expect(n.types.comma),this.afterTrailingComma(n.types.braceR))break;var a=this.startNode(),i=void 0,l=void 0,u=void 0;this.options.ecmaVersion>=6&&(a.method=!1,a.shorthand=!1,(e||t)&&(l=this.start,u=this.startLoc),e||(i=this.eat(n.types.star))),this.parsePropertyName(a),this.parsePropertyValue(a,e,i,l,u,t),this.checkPropClash(a,s),r.properties.push(this.finishNode(a,"Property"))}return this.finishNode(r,e?"ObjectPattern":"ObjectExpression")},s.parsePropertyValue=function(e,t,r,o,s,a){if(this.eat(n.types.colon))e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===n.types.parenL)t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(r);else if(this.options.ecmaVersion>=5&&!e.computed&&"Identifier"===e.key.type&&("get"===e.key.name||"set"===e.key.name)&&this.type!=n.types.comma&&this.type!=n.types.braceR){(r||t)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var i="get"===e.kind?0:1;if(e.value.params.length!==i){var l=e.value.start;"get"===e.kind?this.raise(l,"getter should have no params"):this.raise(l,"setter should have exactly one param")}"set"===e.kind&&"RestElement"===e.value.params[0].type&&this.raise(e.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!e.computed&&"Identifier"===e.key.type?(e.kind="init",t?((this.keywords.test(e.key.name)||(this.strict?this.reservedWordsStrictBind:this.reservedWords).test(e.key.name))&&this.raise(e.key.start,"Binding "+e.key.name),e.value=this.parseMaybeDefault(o,s,e.key)):this.type===n.types.eq&&a?(a.shorthandAssign||(a.shorthandAssign=this.start),e.value=this.parseMaybeDefault(o,s,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected()},s.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(n.types.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(n.types.bracketR),e.key;e.computed=!1}return e.key=this.type===n.types.num||this.type===n.types.string?this.parseExprAtom():this.parseIdent(!0)},s.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=!1,e.expression=!1)},s.parseMethod=function(e){var t=this.startNode();return this.initFunction(t),this.expect(n.types.parenL),t.params=this.parseBindingList(n.types.parenR,!1,!1),this.options.ecmaVersion>=6&&(t.generator=e),this.parseFunctionBody(t,!1),this.finishNode(t,"FunctionExpression")},s.parseArrowExpression=function(e,t){return this.initFunction(e),e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0),this.finishNode(e,"ArrowFunctionExpression")},s.parseFunctionBody=function(e,t){var r=t&&this.type!==n.types.braceL;if(r)e.body=this.parseMaybeAssign(),e.expression=!0;else{var o=this.inFunction,s=this.inGenerator,a=this.labels;this.inFunction=!0,this.inGenerator=e.generator,this.labels=[],e.body=this.parseBlock(!0),e.expression=!1,this.inFunction=o,this.inGenerator=s,this.labels=a}if(this.strict||!r&&e.body.body.length&&this.isUseStrict(e.body.body[0])){var i=this.strict;this.strict=!0,e.id&&this.checkLVal(e.id,!0),this.checkParams(e),this.strict=i}else t&&this.checkParams(e)},s.checkParams=function(e){for(var t={},r=0;r<e.params.length;r++)this.checkLVal(e.params[r],!0,t)},s.parseExprList=function(e,t,r,o){for(var s=[],a=!0;!this.eat(e);){if(a)a=!1;else if(this.expect(n.types.comma),this.type===e&&o&&!o.trailingComma&&(o.trailingComma=this.lastTokStart),t&&this.afterTrailingComma(e))break;var i=void 0;i=r&&this.type===n.types.comma?null:this.type===n.types.ellipsis?this.parseSpread(o):this.parseMaybeAssign(!1,o),s.push(i)}return s},s.parseIdent=function(e){var t=this.startNode();return e&&"never"==this.options.allowReserved&&(e=!1),this.type===n.types.name?(!e&&(this.strict?this.reservedWordsStrict:this.reservedWords).test(this.value)&&(this.options.ecmaVersion>=6||-1==this.input.slice(this.start,this.end).indexOf("\\"))&&this.raise(this.start,"The keyword '"+this.value+"' is reserved"),t.name=this.value):e&&this.type.keyword?t.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(t,"Identifier")},s.parseYield=function(){var e=this.startNode();return this.next(),this.type==n.types.semi||this.canInsertSemicolon()||this.type!=n.types.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(n.types.star),e.argument=this.parseMaybeAssign()),this.finishNode(e,"YieldExpression")},s.parseComprehension=function(e,t){for(e.blocks=[];this.type===n.types._for;){var r=this.startNode();this.next(),this.expect(n.types.parenL),r.left=this.parseBindingAtom(),this.checkLVal(r.left,!0),this.expectContextual("of"),r.right=this.parseExpression(),this.expect(n.types.parenR),e.blocks.push(this.finishNode(r,"ComprehensionBlock"))}return e.filter=this.eat(n.types._if)?this.parseParenExpression():null,e.body=this.parseExpression(),this.expect(t?n.types.parenR:n.types.bracketR),e.generator=t,this.finishNode(e,"ComprehensionExpression")}},{"./state":10,"./tokentype":14}],2:[function(e,t,r){"use strict";function n(e,t){for(var r=65536,n=0;n<t.length;n+=2){if(r+=t[n],r>e)return!1;if(r+=t[n+1],r>=e)return!0}}function o(e,t){return 65>e?36===e:91>e?!0:97>e?95===e:123>e?!0:65535>=e?e>=170&&d.test(String.fromCharCode(e)):t===!1?!1:n(e,h)}function s(e,t){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:65535>=e?e>=170&&p.test(String.fromCharCode(e)):t===!1?!1:n(e,h)||n(e,f)}r.__esModule=!0,r.isIdentifierStart=o,r.isIdentifierChar=s;var a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"};r.reservedWords=a;var i="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",l={5:i,6:i+" let const class extends export import yield super"};r.keywords=l;var u="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢲऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",c="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣤ-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఃా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഁ-ഃാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ູົຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏ᦰ-ᧀᧈᧉ᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭ᳲ-᳴᳸᳹᷀-᷵᷼-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣐-꣙꣠-꣱꤀-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︭︳︴﹍-﹏０-９＿",d=new RegExp("["+u+"]"),p=new RegExp("["+u+c+"]");u=c=null;var h=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,17,26,6,37,11,29,3,35,5,7,2,4,43,157,99,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,98,21,11,25,71,55,7,1,65,0,16,3,2,2,2,26,45,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,955,52,76,44,33,24,27,35,42,34,4,0,13,47,15,3,22,0,38,17,2,24,133,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,32,4,287,47,21,1,2,0,185,46,82,47,21,0,60,42,502,63,32,0,449,56,1288,920,104,110,2962,1070,13266,568,8,30,114,29,19,47,17,3,32,20,6,18,881,68,12,0,67,12,16481,1,3071,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,1340,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,16355,541],f=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,1306,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,52,0,13,2,49,13,16,9,83,11,168,11,6,9,8,2,57,0,2,6,3,1,3,2,10,0,11,1,3,6,4,4,316,19,13,9,214,6,3,8,112,16,16,9,82,12,9,9,535,9,20855,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,4305,6,792618,239]},{}],3:[function(e,t,r){"use strict";function n(e,t){return new a.Parser(t,e).parse()}function o(e,t,r){var n=new a.Parser(r,e,t);return n.nextToken(),n.parseExpression()}function s(e,t){return new a.Parser(t,e)}r.__esModule=!0,r.parse=n,r.parseExpressionAt=o,r.tokenizer=s;var a=e("./state");e("./parseutil"),e("./statement"),e("./lval"),e("./expression"),e("./location"),r.Parser=a.Parser,r.plugins=a.plugins;var i=e("./options");r.defaultOptions=i.defaultOptions;var l=e("./locutil");r.Position=l.Position,r.SourceLocation=l.SourceLocation,r.getLineInfo=l.getLineInfo;var u=e("./node");r.Node=u.Node;var c=e("./tokentype");r.TokenType=c.TokenType,r.tokTypes=c.types;var d=e("./tokencontext");r.TokContext=d.TokContext,r.tokContexts=d.types;var p=e("./identifier");r.isIdentifierChar=p.isIdentifierChar,r.isIdentifierStart=p.isIdentifierStart;var h=e("./tokenize");r.Token=h.Token;var f=e("./whitespace");r.isNewLine=f.isNewLine,r.lineBreak=f.lineBreak,r.lineBreakG=f.lineBreakG;var m="2.7.0";r.version=m},{"./expression":1,"./identifier":2,"./location":4,"./locutil":5,"./lval":6,"./node":7,"./options":8,"./parseutil":9,"./state":10,"./statement":11,"./tokencontext":12,"./tokenize":13,"./tokentype":14,"./whitespace":16}],4:[function(e,t,r){"use strict";var n=e("./state"),o=e("./locutil"),s=n.Parser.prototype;s.raise=function(e,t){var r=o.getLineInfo(this.input,e);t+=" ("+r.line+":"+r.column+")";var n=new SyntaxError(t);throw n.pos=e,n.loc=r,n.raisedAt=this.pos,n},s.curPosition=function(){return this.options.locations?new o.Position(this.curLine,this.pos-this.lineStart):void 0}},{"./locutil":5,"./state":10}],5:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=1,n=0;;){s.lineBreakG.lastIndex=n;var o=s.lineBreakG.exec(e);if(!(o&&o.index<t))return new a(r,t-n);++r,n=o.index+o[0].length}}r.__esModule=!0,r.getLineInfo=o;var s=e("./whitespace"),a=function(){function e(t,r){n(this,e),this.line=t,this.column=r}return e.prototype.offset=function(t){return new e(this.line,this.column+t)},e}();r.Position=a;var i=function l(e,t,r){n(this,l),this.start=t,this.end=r,null!==e.sourceFile&&(this.source=e.sourceFile)};r.SourceLocation=i},{"./whitespace":16}],6:[function(e,t,r){"use strict";var n=e("./tokentype"),o=e("./state"),s=e("./util"),a=o.Parser.prototype;a.toAssignable=function(e,t){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":break;case"ObjectExpression":e.type="ObjectPattern";for(var r=0;r<e.properties.length;r++){var n=e.properties[r];"init"!==n.kind&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,t)}break;case"ArrayExpression":e.type="ArrayPattern",this.toAssignableList(e.elements,t);break;case"AssignmentExpression":if("="!==e.operator){this.raise(e.left.end,"Only '=' operator can be used for specifying default value.");break}e.type="AssignmentPattern",delete e.operator;case"AssignmentPattern":"YieldExpression"===e.right.type&&this.raise(e.right.start,"Yield expression cannot be a default value");break;case"ParenthesizedExpression":e.expression=this.toAssignable(e.expression,t);break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}return e},a.toAssignableList=function(e,t){var r=e.length;if(r){var n=e[r-1];if(n&&"RestElement"==n.type)--r;else if(n&&"SpreadElement"==n.type){n.type="RestElement";var o=n.argument;this.toAssignable(o,t),"Identifier"!==o.type&&"MemberExpression"!==o.type&&"ArrayPattern"!==o.type&&this.unexpected(o.start),--r}t&&"RestElement"===n.type&&"Identifier"!==n.argument.type&&this.unexpected(n.argument.start)}for(var s=0;r>s;s++){var a=e[s];a&&this.toAssignable(a,t)}return e},a.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(e),this.finishNode(t,"SpreadElement")},a.parseRest=function(e){var t=this.startNode();return this.next(),e?t.argument=this.type===n.types.name?this.parseIdent():this.unexpected():t.argument=this.type===n.types.name||this.type===n.types.bracketL?this.parseBindingAtom():this.unexpected(),this.finishNode(t,"RestElement")},a.parseBindingAtom=function(){if(this.options.ecmaVersion<6)return this.parseIdent();switch(this.type){case n.types.name:return this.parseIdent();case n.types.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(n.types.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case n.types.braceL:return this.parseObj(!0);default:this.unexpected()}},a.parseBindingList=function(e,t,r,o){for(var s=[],a=!0;!this.eat(e);)if(a?a=!1:this.expect(n.types.comma),t&&this.type===n.types.comma)s.push(null);else{if(r&&this.afterTrailingComma(e))break;if(this.type===n.types.ellipsis){var i=this.parseRest(o);this.parseBindingListItem(i),s.push(i),this.expect(e);break}var l=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(l),s.push(l)}return s},a.parseBindingListItem=function(e){return e},a.parseMaybeDefault=function(e,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(n.types.eq))return r;var o=this.startNodeAt(e,t);return o.left=r,o.right=this.parseMaybeAssign(),this.finishNode(o,"AssignmentPattern")},a.checkLVal=function(e,t,r){switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raise(e.start,(t?"Binding ":"Assigning to ")+e.name+" in strict mode"),r&&(s.has(r,e.name)&&this.raise(e.start,"Argument name clash"),r[e.name]=!0);break;case"MemberExpression":t&&this.raise(e.start,(t?"Binding":"Assigning to")+" member expression");break;case"ObjectPattern":for(var n=0;n<e.properties.length;n++)this.checkLVal(e.properties[n].value,t,r);break;case"ArrayPattern":for(var n=0;n<e.elements.length;n++){var o=e.elements[n];o&&this.checkLVal(o,t,r)}break;case"AssignmentPattern":this.checkLVal(e.left,t,r);break;case"RestElement":this.checkLVal(e.argument,t,r);break;case"ParenthesizedExpression":this.checkLVal(e.expression,t,r);break;default:this.raise(e.start,(t?"Binding":"Assigning to")+" rvalue")}}},{"./state":10,"./tokentype":14,"./util":15}],7:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,r,n){return e.type=t,e.end=r,this.options.locations&&(e.loc.end=n),this.options.ranges&&(e.range[1]=r),e}r.__esModule=!0;var s=e("./state"),a=e("./locutil"),i=function u(e,t,r){n(this,u),this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new a.SourceLocation(e,r)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])};r.Node=i;var l=s.Parser.prototype;l.startNode=function(){return new i(this,this.start,this.startLoc)},l.startNodeAt=function(e,t){return new i(this,e,t)},l.finishNode=function(e,t){return o.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},l.finishNodeAt=function(e,t,r,n){return o.call(this,e,t,r,n)}},{"./locutil":5,"./state":10}],8:[function(e,t,r){"use strict";function n(e){var t={};for(var r in i)t[r]=e&&s.has(e,r)?e[r]:i[r];return null==t.allowReserved&&(t.allowReserved=t.ecmaVersion<5),s.isArray(t.onToken)&&!function(){var e=t.onToken;t.onToken=function(t){return e.push(t)}}(),s.isArray(t.onComment)&&(t.onComment=o(t,t.onComment)),t}function o(e,t){return function(r,n,o,s,i,l){var u={type:r?"Block":"Line",value:n,start:o,end:s};e.locations&&(u.loc=new a.SourceLocation(this,i,l)),e.ranges&&(u.range=[o,s]),t.push(u)}}r.__esModule=!0,r.getOptions=n;var s=e("./util"),a=e("./locutil"),i={ecmaVersion:5,sourceType:"script",onInsertedSemicolon:null,
onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}};r.defaultOptions=i},{"./locutil":5,"./util":15}],9:[function(e,t,r){"use strict";var n=e("./tokentype"),o=e("./state"),s=e("./whitespace"),a=o.Parser.prototype;a.isUseStrict=function(e){return this.options.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.raw.slice(1,-1)},a.eat=function(e){return this.type===e?(this.next(),!0):!1},a.isContextual=function(e){return this.type===n.types.name&&this.value===e},a.eatContextual=function(e){return this.value===e&&this.eat(n.types.name)},a.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},a.canInsertSemicolon=function(){return this.type===n.types.eof||this.type===n.types.braceR||s.lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},a.insertSemicolon=function(){return this.canInsertSemicolon()?(this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0):void 0},a.semicolon=function(){this.eat(n.types.semi)||this.insertSemicolon()||this.unexpected()},a.afterTrailingComma=function(e){return this.type==e?(this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),this.next(),!0):void 0},a.expect=function(e){this.eat(e)||this.unexpected()},a.unexpected=function(e){this.raise(null!=e?e:this.start,"Unexpected token")},a.checkPatternErrors=function(e,t){var r=e&&e.trailingComma;return t?void(r&&this.raise(r,"Trailing comma is not permitted in destructuring patterns")):!!r},a.checkExpressionErrors=function(e,t){var r=e&&e.shorthandAssign;return t?void(r&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns")):!!r}},{"./state":10,"./tokentype":14,"./whitespace":16}],10:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return new RegExp("^("+e.replace(/ /g,"|")+")$")}r.__esModule=!0;var s=e("./identifier"),a=e("./tokentype"),i=e("./whitespace"),l=e("./options"),u={};r.plugins=u;var c=function(){function e(t,r,u){n(this,e),this.options=t=l.getOptions(t),this.sourceFile=t.sourceFile,this.keywords=o(s.keywords[t.ecmaVersion>=6?6:5]);var c=t.allowReserved?"":s.reservedWords[t.ecmaVersion]+("module"==t.sourceType?" await":"");this.reservedWords=o(c);var d=(c?c+" ":"")+s.reservedWords.strict;this.reservedWordsStrict=o(d),this.reservedWordsStrictBind=o(d+" "+s.reservedWords.strictBind),this.input=String(r),this.containsEsc=!1,this.loadPlugins(t.plugins),u?(this.pos=u,this.lineStart=Math.max(0,this.input.lastIndexOf("\n",u)),this.curLine=this.input.slice(0,this.lineStart).split(i.lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=a.types.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.strict=this.inModule="module"===t.sourceType,this.potentialArrowAt=-1,this.inFunction=this.inGenerator=!1,this.labels=[],0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2)}return e.prototype.isKeyword=function(e){return this.keywords.test(e)},e.prototype.isReservedWord=function(e){return this.reservedWords.test(e)},e.prototype.extend=function(e,t){this[e]=t(this[e])},e.prototype.loadPlugins=function(e){for(var t in e){var r=u[t];if(!r)throw new Error("Plugin '"+t+"' not found");r(this,e[t])}},e.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},e}();r.Parser=c},{"./identifier":2,"./options":8,"./tokentype":14,"./whitespace":16}],11:[function(e,t,r){"use strict";var n=e("./tokentype"),o=e("./state"),s=e("./whitespace"),a=o.Parser.prototype;a.parseTopLevel=function(e){var t=!0;for(e.body||(e.body=[]);this.type!==n.types.eof;){var r=this.parseStatement(!0,!0);e.body.push(r),t&&(this.isUseStrict(r)&&this.setStrict(!0),t=!1)}return this.next(),this.options.ecmaVersion>=6&&(e.sourceType=this.options.sourceType),this.finishNode(e,"Program")};var i={kind:"loop"},l={kind:"switch"};a.parseStatement=function(e,t){var r=this.type,o=this.startNode();switch(r){case n.types._break:case n.types._continue:return this.parseBreakContinueStatement(o,r.keyword);case n.types._debugger:return this.parseDebuggerStatement(o);case n.types._do:return this.parseDoStatement(o);case n.types._for:return this.parseForStatement(o);case n.types._function:return!e&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(o);case n.types._class:return e||this.unexpected(),this.parseClass(o,!0);case n.types._if:return this.parseIfStatement(o);case n.types._return:return this.parseReturnStatement(o);case n.types._switch:return this.parseSwitchStatement(o);case n.types._throw:return this.parseThrowStatement(o);case n.types._try:return this.parseTryStatement(o);case n.types._let:case n.types._const:e||this.unexpected();case n.types._var:return this.parseVarStatement(o,r);case n.types._while:return this.parseWhileStatement(o);case n.types._with:return this.parseWithStatement(o);case n.types.braceL:return this.parseBlock();case n.types.semi:return this.parseEmptyStatement(o);case n.types._export:case n.types._import:return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===n.types._import?this.parseImport(o):this.parseExport(o);default:var s=this.value,a=this.parseExpression();return r===n.types.name&&"Identifier"===a.type&&this.eat(n.types.colon)?this.parseLabeledStatement(o,s,a):this.parseExpressionStatement(o,a)}},a.parseBreakContinueStatement=function(e,t){var r="break"==t;this.next(),this.eat(n.types.semi)||this.insertSemicolon()?e.label=null:this.type!==n.types.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var o=0;o<this.labels.length;++o){var s=this.labels[o];if(null==e.label||s.name===e.label.name){if(null!=s.kind&&(r||"loop"===s.kind))break;if(e.label&&r)break}}return o===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,r?"BreakStatement":"ContinueStatement")},a.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},a.parseDoStatement=function(e){return this.next(),this.labels.push(i),e.body=this.parseStatement(!1),this.labels.pop(),this.expect(n.types._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(n.types.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},a.parseForStatement=function(e){if(this.next(),this.labels.push(i),this.expect(n.types.parenL),this.type===n.types.semi)return this.parseFor(e,null);if(this.type===n.types._var||this.type===n.types._let||this.type===n.types._const){var t=this.startNode(),r=this.type;return this.next(),this.parseVar(t,!0,r),this.finishNode(t,"VariableDeclaration"),!(this.type===n.types._in||this.options.ecmaVersion>=6&&this.isContextual("of"))||1!==t.declarations.length||r!==n.types._var&&t.declarations[0].init?this.parseFor(e,t):this.parseForIn(e,t)}var o={shorthandAssign:0,trailingComma:0},s=this.parseExpression(!0,o);return this.type===n.types._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.checkPatternErrors(o,!0),this.toAssignable(s),this.checkLVal(s),this.parseForIn(e,s)):(this.checkExpressionErrors(o,!0),this.parseFor(e,s))},a.parseFunctionStatement=function(e){return this.next(),this.parseFunction(e,!0)},a.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement(!1),e.alternate=this.eat(n.types._else)?this.parseStatement(!1):null,this.finishNode(e,"IfStatement")},a.parseReturnStatement=function(e){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(n.types.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},a.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(n.types.braceL),this.labels.push(l);for(var t,r=!1;this.type!=n.types.braceR;)if(this.type===n.types._case||this.type===n.types._default){var o=this.type===n.types._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),o?t.test=this.parseExpression():(r&&this.raise(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(n.types.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(!0));return t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},a.parseThrowStatement=function(e){return this.next(),s.lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var u=[];a.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===n.types._catch){var t=this.startNode();this.next(),this.expect(n.types.parenL),t.param=this.parseBindingAtom(),this.checkLVal(t.param,!0),this.expect(n.types.parenR),t.body=this.parseBlock(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(n.types._finally)?this.parseBlock():null,e.handler||e.finalizer||this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},a.parseVarStatement=function(e,t){return this.next(),this.parseVar(e,!1,t),this.semicolon(),this.finishNode(e,"VariableDeclaration")},a.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(i),e.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(e,"WhileStatement")},a.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement(!1),this.finishNode(e,"WithStatement")},a.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},a.parseLabeledStatement=function(e,t,r){for(var o=0;o<this.labels.length;++o)this.labels[o].name===t&&this.raise(r.start,"Label '"+t+"' is already declared");for(var s=this.type.isLoop?"loop":this.type===n.types._switch?"switch":null,o=this.labels.length-1;o>=0;o--){var a=this.labels[o];if(a.statementStart!=e.start)break;a.statementStart=this.start,a.kind=s}return this.labels.push({name:t,kind:s,statementStart:this.start}),e.body=this.parseStatement(!0),this.labels.pop(),e.label=r,this.finishNode(e,"LabeledStatement")},a.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},a.parseBlock=function(e){var t=this.startNode(),r=!0,o=void 0;for(t.body=[],this.expect(n.types.braceL);!this.eat(n.types.braceR);){var s=this.parseStatement(!0);t.body.push(s),r&&e&&this.isUseStrict(s)&&(o=this.strict,this.setStrict(this.strict=!0)),r=!1}return o===!1&&this.setStrict(!1),this.finishNode(t,"BlockStatement")},a.parseFor=function(e,t){return e.init=t,this.expect(n.types.semi),e.test=this.type===n.types.semi?null:this.parseExpression(),this.expect(n.types.semi),e.update=this.type===n.types.parenR?null:this.parseExpression(),this.expect(n.types.parenR),e.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(e,"ForStatement")},a.parseForIn=function(e,t){var r=this.type===n.types._in?"ForInStatement":"ForOfStatement";return this.next(),e.left=t,e.right=this.parseExpression(),this.expect(n.types.parenR),e.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(e,r)},a.parseVar=function(e,t,r){for(e.declarations=[],e.kind=r.keyword;;){var o=this.startNode();if(this.parseVarId(o),this.eat(n.types.eq)?o.init=this.parseMaybeAssign(t):r!==n.types._const||this.type===n.types._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"==o.id.type||t&&(this.type===n.types._in||this.isContextual("of"))?o.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),e.declarations.push(this.finishNode(o,"VariableDeclarator")),!this.eat(n.types.comma))break}return e},a.parseVarId=function(e){e.id=this.parseBindingAtom(),this.checkLVal(e.id,!0)},a.parseFunction=function(e,t,r){return this.initFunction(e),this.options.ecmaVersion>=6&&(e.generator=this.eat(n.types.star)),(t||this.type===n.types.name)&&(e.id=this.parseIdent()),this.parseFunctionParams(e),this.parseFunctionBody(e,r),this.finishNode(e,t?"FunctionDeclaration":"FunctionExpression")},a.parseFunctionParams=function(e){this.expect(n.types.parenL),e.params=this.parseBindingList(n.types.parenR,!1,!1,!0)},a.parseClass=function(e,t){this.next(),this.parseClassId(e,t),this.parseClassSuper(e);var r=this.startNode(),o=!1;for(r.body=[],this.expect(n.types.braceL);!this.eat(n.types.braceR);)if(!this.eat(n.types.semi)){var s=this.startNode(),a=this.eat(n.types.star),i=this.type===n.types.name&&"static"===this.value;this.parsePropertyName(s),s["static"]=i&&this.type!==n.types.parenL,s["static"]&&(a&&this.unexpected(),a=this.eat(n.types.star),this.parsePropertyName(s)),s.kind="method";var l=!1;if(!s.computed){var u=s.key;a||"Identifier"!==u.type||this.type===n.types.parenL||"get"!==u.name&&"set"!==u.name||(l=!0,s.kind=u.name,u=this.parsePropertyName(s)),!s["static"]&&("Identifier"===u.type&&"constructor"===u.name||"Literal"===u.type&&"constructor"===u.value)&&(o&&this.raise(u.start,"Duplicate constructor in the same class"),l&&this.raise(u.start,"Constructor can't have get/set modifier"),a&&this.raise(u.start,"Constructor can't be a generator"),s.kind="constructor",o=!0)}if(this.parseClassMethod(r,s,a),l){var c="get"===s.kind?0:1;if(s.value.params.length!==c){var d=s.value.start;"get"===s.kind?this.raise(d,"getter should have no params"):this.raise(d,"setter should have exactly one param")}"set"===s.kind&&"RestElement"===s.value.params[0].type&&this.raise(s.value.params[0].start,"Setter cannot use rest params")}}return e.body=this.finishNode(r,"ClassBody"),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},a.parseClassMethod=function(e,t,r){t.value=this.parseMethod(r),e.body.push(this.finishNode(t,"MethodDefinition"))},a.parseClassId=function(e,t){e.id=this.type===n.types.name?this.parseIdent():t?this.unexpected():null},a.parseClassSuper=function(e){e.superClass=this.eat(n.types._extends)?this.parseExprSubscripts():null},a.parseExport=function(e){if(this.next(),this.eat(n.types.star))return this.expectContextual("from"),e.source=this.type===n.types.string?this.parseExprAtom():this.unexpected(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(n.types._default)){var t=this.parseMaybeAssign(),r=!0;return("FunctionExpression"==t.type||"ClassExpression"==t.type)&&(r=!1,t.id&&(t.type="FunctionExpression"==t.type?"FunctionDeclaration":"ClassDeclaration")),e.declaration=t,r&&this.semicolon(),this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(!0),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(),this.eatContextual("from"))e.source=this.type===n.types.string?this.parseExprAtom():this.unexpected();else{for(var o=0;o<e.specifiers.length;o++)(this.keywords.test(e.specifiers[o].local.name)||this.reservedWords.test(e.specifiers[o].local.name))&&this.unexpected(e.specifiers[o].local.start);e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},a.shouldParseExportStatement=function(){return this.type.keyword},a.parseExportSpecifiers=function(){var e=[],t=!0;for(this.expect(n.types.braceL);!this.eat(n.types.braceR);){if(t)t=!1;else if(this.expect(n.types.comma),this.afterTrailingComma(n.types.braceR))break;var r=this.startNode();r.local=this.parseIdent(this.type===n.types._default),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,e.push(this.finishNode(r,"ExportSpecifier"))}return e},a.parseImport=function(e){return this.next(),this.type===n.types.string?(e.specifiers=u,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===n.types.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},a.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===n.types.name){var r=this.startNode();if(r.local=this.parseIdent(),this.checkLVal(r.local,!0),e.push(this.finishNode(r,"ImportDefaultSpecifier")),!this.eat(n.types.comma))return e}if(this.type===n.types.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,!0),e.push(this.finishNode(r,"ImportNamespaceSpecifier")),e}for(this.expect(n.types.braceL);!this.eat(n.types.braceR);){if(t)t=!1;else if(this.expect(n.types.comma),this.afterTrailingComma(n.types.braceR))break;var r=this.startNode();r.imported=this.parseIdent(!0),this.eatContextual("as")?r.local=this.parseIdent():(r.local=r.imported,this.isKeyword(r.local.name)&&this.unexpected(r.local.start),this.reservedWordsStrict.test(r.local.name)&&this.raise(r.local.start,"The keyword '"+r.local.name+"' is reserved")),this.checkLVal(r.local,!0),e.push(this.finishNode(r,"ImportSpecifier"))}return e}},{"./state":10,"./tokentype":14,"./whitespace":16}],12:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var o=e("./state"),s=e("./tokentype"),a=e("./whitespace"),i=function c(e,t,r,o){n(this,c),this.token=e,this.isExpr=!!t,this.preserveSpace=!!r,this.override=o};r.TokContext=i;var l={b_stat:new i("{",!1),b_expr:new i("{",!0),b_tmpl:new i("${",!0),p_stat:new i("(",!1),p_expr:new i("(",!0),q_tmpl:new i("`",!0,!0,function(e){return e.readTmplToken()}),f_expr:new i("function",!0)};r.types=l;var u=o.Parser.prototype;u.initialContext=function(){return[l.b_stat]},u.braceIsBlock=function(e){if(e===s.types.colon){var t=this.curContext();if(t===l.b_stat||t===l.b_expr)return!t.isExpr}return e===s.types._return?a.lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):e===s.types._else||e===s.types.semi||e===s.types.eof||e===s.types.parenR?!0:e==s.types.braceL?this.curContext()===l.b_stat:!this.exprAllowed},u.updateContext=function(e){var t=void 0,r=this.type;r.keyword&&e==s.types.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,e):this.exprAllowed=r.beforeExpr},s.types.parenR.updateContext=s.types.braceR.updateContext=function(){if(1==this.context.length)return void(this.exprAllowed=!0);var e=this.context.pop();e===l.b_stat&&this.curContext()===l.f_expr?(this.context.pop(),this.exprAllowed=!1):e===l.b_tmpl?this.exprAllowed=!0:this.exprAllowed=!e.isExpr},s.types.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?l.b_stat:l.b_expr),this.exprAllowed=!0},s.types.dollarBraceL.updateContext=function(){this.context.push(l.b_tmpl),this.exprAllowed=!0},s.types.parenL.updateContext=function(e){var t=e===s.types._if||e===s.types._for||e===s.types._with||e===s.types._while;this.context.push(t?l.p_stat:l.p_expr),this.exprAllowed=!0},s.types.incDec.updateContext=function(){},s.types._function.updateContext=function(){this.curContext()!==l.b_stat&&this.context.push(l.f_expr),this.exprAllowed=!1},s.types.backQuote.updateContext=function(){this.curContext()===l.q_tmpl?this.context.pop():this.context.push(l.q_tmpl),this.exprAllowed=!1}},{"./state":10,"./tokentype":14,"./whitespace":16}],13:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,r,n){try{return new RegExp(e,t)}catch(o){if(void 0!==r)throw o instanceof SyntaxError&&n.raise(r,"Error parsing regular expression: "+o.message),o}}function s(e){return 65535>=e?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(1023&e)+56320))}r.__esModule=!0;var a=e("./identifier"),i=e("./tokentype"),l=e("./state"),u=e("./locutil"),c=e("./whitespace"),d=function m(e){n(this,m),this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new u.SourceLocation(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])};r.Token=d;var p=l.Parser.prototype,h="object"==typeof Packages&&"[object JavaPackage]"==Object.prototype.toString.call(Packages);p.next=function(){this.options.onToken&&this.options.onToken(new d(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},p.getToken=function(){return this.next(),new d(this)},"undefined"!=typeof Symbol&&(p[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===i.types.eof,value:t}}}}),p.setStrict=function(e){if(this.strict=e,this.type===i.types.num||this.type===i.types.string){if(this.pos=this.start,this.options.locations)for(;this.pos<this.lineStart;)this.lineStart=this.input.lastIndexOf("\n",this.lineStart-2)+1,--this.curLine;this.nextToken()}},p.curContext=function(){return this.context[this.context.length-1]},p.nextToken=function(){var e=this.curContext();return e&&e.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(i.types.eof):e.override?e.override(this):void this.readToken(this.fullCharCodeAtPos())},p.readToken=function(e){return a.isIdentifierStart(e,this.options.ecmaVersion>=6)||92===e?this.readWord():this.getTokenFromCode(e)},p.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(55295>=e||e>=57344)return e;var t=this.input.charCodeAt(this.pos+1);return(e<<10)+t-56613888},p.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations){c.lineBreakG.lastIndex=t;for(var n=void 0;(n=c.lineBreakG.exec(this.input))&&n.index<this.pos;)++this.curLine,this.lineStart=n.index+n[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,r),t,this.pos,e,this.curPosition())},p.skipLineComment=function(e){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&10!==n&&13!==n&&8232!==n&&8233!==n;)++this.pos,n=this.input.charCodeAt(this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,r,this.curPosition())},p.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(e>8&&14>e||e>=5760&&c.nonASCIIwhitespace.test(String.fromCharCode(e))))break e;++this.pos}}},p.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=e,this.value=t,this.updateContext(r)},p.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&57>=e)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===e&&46===t?(this.pos+=3,this.finishToken(i.types.ellipsis)):(++this.pos,this.finishToken(i.types.dot))},p.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===e?this.finishOp(i.types.assign,2):this.finishOp(i.types.slash,1)},p.readToken_mult_modulo=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(i.types.assign,2):this.finishOp(42===e?i.types.star:i.types.modulo,1)},p.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?this.finishOp(124===e?i.types.logicalOR:i.types.logicalAND,2):61===t?this.finishOp(i.types.assign,2):this.finishOp(124===e?i.types.bitwiseOR:i.types.bitwiseAND,1)},p.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(i.types.assign,2):this.finishOp(i.types.bitwiseXOR,1)},p.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?45==t&&62==this.input.charCodeAt(this.pos+2)&&c.lineBreak.test(this.input.slice(this.lastTokEnd,this.pos))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(i.types.incDec,2):61===t?this.finishOp(i.types.assign,2):this.finishOp(i.types.plusMin,1)},p.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),r=1;return t===e?(r=62===e&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+r)?this.finishOp(i.types.assign,r+1):this.finishOp(i.types.bitShift,r)):33==t&&60==e&&45==this.input.charCodeAt(this.pos+2)&&45==this.input.charCodeAt(this.pos+3)?(this.inModule&&this.unexpected(),this.skipLineComment(4),this.skipSpace(),this.nextToken()):(61===t&&(r=61===this.input.charCodeAt(this.pos+2)?3:2),this.finishOp(i.types.relational,r))},p.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(i.types.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===e&&62===t&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(i.types.arrow)):this.finishOp(61===e?i.types.eq:i.types.prefix,1)},p.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(i.types.parenL);case 41:return++this.pos,this.finishToken(i.types.parenR);case 59:return++this.pos,this.finishToken(i.types.semi);case 44:return++this.pos,this.finishToken(i.types.comma);case 91:return++this.pos,this.finishToken(i.types.bracketL);case 93:return++this.pos,this.finishToken(i.types.bracketR);case 123:return++this.pos,this.finishToken(i.types.braceL);case 125:return++this.pos,this.finishToken(i.types.braceR);case 58:return++this.pos,this.finishToken(i.types.colon);case 63:return++this.pos,this.finishToken(i.types.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(i.types.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(120===t||88===t)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===t||79===t)return this.readRadixNumber(8);if(98===t||66===t)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 126:return this.finishOp(i.types.prefix,1)}this.raise(this.pos,"Unexpected character '"+s(e)+"'")},p.finishOp=function(e,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,r)};var f=!!o("￿","u");p.readRegexp=function(){for(var e=this,t=void 0,r=void 0,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(c.lineBreak.test(s)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===s)r=!0;else if("]"===s&&r)r=!1;else if("/"===s&&!r)break;t="\\"===s}++this.pos}var a=this.input.slice(n,this.pos);++this.pos;var l=this.readWord1(),u=a;if(l){var d=/^[gim]*$/;this.options.ecmaVersion>=6&&(d=/^[gimuy]*$/),d.test(l)||this.raise(n,"Invalid regular expression flag"),l.indexOf("u")>=0&&!f&&(u=u.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,r,o){return r=Number("0x"+r),r>1114111&&e.raise(n+o+3,"Code point out of bounds"),"x"}),u=u.replace(/\\u([a-fA-F0-9]{4})|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"))}var p=null;return h||(o(u,void 0,n,this),p=o(a,l)),this.finishToken(i.types.regexp,{pattern:a,flags:l,value:p})},p.readInt=function(e,t){for(var r=this.pos,n=0,o=0,s=null==t?1/0:t;s>o;++o){var a=this.input.charCodeAt(this.pos),i=void 0;if(i=a>=97?a-97+10:a>=65?a-65+10:a>=48&&57>=a?a-48:1/0,i>=e)break;++this.pos,n=n*e+i}return this.pos===r||null!=t&&this.pos-r!==t?null:n},p.readRadixNumber=function(e){this.pos+=2;var t=this.readInt(e);return null==t&&this.raise(this.start+2,"Expected number in radix "+e),a.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(i.types.num,t)},p.readNumber=function(e){var t=this.pos,r=!1,n=48===this.input.charCodeAt(this.pos);e||null!==this.readInt(10)||this.raise(t,"Invalid number");var o=this.input.charCodeAt(this.pos);46===o&&(++this.pos,this.readInt(10),r=!0,o=this.input.charCodeAt(this.pos)),(69===o||101===o)&&(o=this.input.charCodeAt(++this.pos),(43===o||45===o)&&++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number"),r=!0),a.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=this.input.slice(t,this.pos),l=void 0;return r?l=parseFloat(s):n&&1!==s.length?/[89]/.test(s)||this.strict?this.raise(t,"Invalid number"):l=parseInt(s,8):l=parseInt(s,10),this.finishToken(i.types.num,l)},p.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t=void 0;if(123===e){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.raise(r,"Code point out of bounds")}else t=this.readHexChar(4);return t},p.readString=function(e){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===e)break;92===n?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):(c.isNewLine(n)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(i.types.string,t)},p.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(96===r||36===r&&123===this.input.charCodeAt(this.pos+1))return this.pos===this.start&&this.type===i.types.template?36===r?(this.pos+=2,this.finishToken(i.types.dollarBraceL)):(++this.pos,this.finishToken(i.types.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(i.types.template,e));if(92===r)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(c.isNewLine(r)){switch(e+=this.input.slice(t,this.pos),++this.pos,r){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(r)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},p.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return s(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\x0B";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(t>=48&&55>=t){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],n=parseInt(r,8);return n>255&&(r=r.slice(0,-1),
n=parseInt(r,8)),"0"!==r&&(this.strict||e)&&this.raise(this.pos-2,"Octal literal in strict mode"),this.pos+=r.length-1,String.fromCharCode(n)}return String.fromCharCode(t)}},p.readHexChar=function(e){var t=this.pos,r=this.readInt(16,e);return null===r&&this.raise(t,"Bad character escape sequence"),r},p.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,r=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var o=this.fullCharCodeAtPos();if(a.isIdentifierChar(o,n))this.pos+=65535>=o?1:2;else{if(92!==o)break;this.containsEsc=!0,e+=this.input.slice(r,this.pos);var i=this.pos;117!=this.input.charCodeAt(++this.pos)&&this.raise(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var l=this.readCodePoint();(t?a.isIdentifierStart:a.isIdentifierChar)(l,n)||this.raise(i,"Invalid Unicode escape"),e+=s(l),r=this.pos}t=!1}return e+this.input.slice(r,this.pos)},p.readWord=function(){var e=this.readWord1(),t=i.types.name;return(this.options.ecmaVersion>=6||!this.containsEsc)&&this.keywords.test(e)&&(t=i.keywords[e]),this.finishToken(t,e)}},{"./identifier":2,"./locutil":5,"./state":10,"./tokentype":14,"./whitespace":16}],14:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return new a(e,{beforeExpr:!0,binop:t})}function s(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t.keyword=e,c[e]=u["_"+e]=new a(e,t)}r.__esModule=!0;var a=function d(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n(this,d),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};r.TokenType=a;var i={beforeExpr:!0},l={startsExpr:!0},u={num:new a("num",l),regexp:new a("regexp",l),string:new a("string",l),name:new a("name",l),eof:new a("eof"),bracketL:new a("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new a("]"),braceL:new a("{",{beforeExpr:!0,startsExpr:!0}),braceR:new a("}"),parenL:new a("(",{beforeExpr:!0,startsExpr:!0}),parenR:new a(")"),comma:new a(",",i),semi:new a(";",i),colon:new a(":",i),dot:new a("."),question:new a("?",i),arrow:new a("=>",i),template:new a("template"),ellipsis:new a("...",i),backQuote:new a("`",l),dollarBraceL:new a("${",{beforeExpr:!0,startsExpr:!0}),eq:new a("=",{beforeExpr:!0,isAssign:!0}),assign:new a("_=",{beforeExpr:!0,isAssign:!0}),incDec:new a("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new a("prefix",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:o("||",1),logicalAND:o("&&",2),bitwiseOR:o("|",3),bitwiseXOR:o("^",4),bitwiseAND:o("&",5),equality:o("==/!=",6),relational:o("</>",7),bitShift:o("<</>>",8),plusMin:new a("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:o("%",10),star:o("*",10),slash:o("/",10)};r.types=u;var c={};r.keywords=c,s("break"),s("case",i),s("catch"),s("continue"),s("debugger"),s("default",i),s("do",{isLoop:!0,beforeExpr:!0}),s("else",i),s("finally"),s("for",{isLoop:!0}),s("function",l),s("if"),s("return",i),s("switch"),s("throw",i),s("try"),s("var"),s("let"),s("const"),s("while",{isLoop:!0}),s("with"),s("new",{beforeExpr:!0,startsExpr:!0}),s("this",l),s("super",l),s("class"),s("extends",i),s("export"),s("import"),s("yield",{beforeExpr:!0,startsExpr:!0}),s("null",l),s("true",l),s("false",l),s("in",{beforeExpr:!0,binop:7}),s("instanceof",{beforeExpr:!0,binop:7}),s("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),s("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),s("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},{}],15:[function(e,t,r){"use strict";function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.__esModule=!0,r.isArray=n,r.has=o},{}],16:[function(e,t,r){"use strict";function n(e){return 10===e||13===e||8232===e||8233==e}r.__esModule=!0,r.isNewLine=n;var o=/\r\n?|\n|\u2028|\u2029/;r.lineBreak=o;var s=new RegExp(o.source,"g");r.lineBreakG=s;var a=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;r.nonASCIIwhitespace=a},{}]},{},[3])(3)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(e,t,r){t.exports={quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪","int":"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}},{}],30:[function(e,t,r){function n(){c=!1,i.length?u=i.concat(u):d=-1,u.length&&o()}function o(){if(!c){var e=setTimeout(n);c=!0;for(var t=u.length;t;){for(i=u,u=[];++d<t;)i&&i[d].run();d=-1,t=u.length}i=null,c=!1,clearTimeout(e)}}function s(e,t){this.fun=e,this.array=t}function a(){}var i,l=t.exports={},u=[],c=!1,d=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new s(e,t)),1!==u.length||c||setTimeout(o,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=a,l.addListener=a,l.once=a,l.off=a,l.removeListener=a,l.removeAllListeners=a,l.emit=a,l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],31:[function(e,t,r){(function(e){var r;r||(r={}),r.Constants={textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"2",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #C0C0C0;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultReadonlyClass:"",defaultReadonlyStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);",defaultReadonlyNoGridClass:"",defaultReadonlyNoGridStyle:"",defaultReadonlyComment:"Locked cell",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",defaultColnameClass:"",defaultColnameStyle:"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;",defaultRownameClass:"",defaultRownameStyle:"font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;direction:rtl;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",defaultUnhideLeftClass:"",defaultUnhideLeftStyle:"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;",defaultUnhideRightClass:"",defaultUnhideRightStyle:"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;",defaultUnhideTopClass:"",defaultUnhideTopStyle:"float:left;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;",defaultUnhideBottomClass:"",defaultUnhideBottomStyle:"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;",s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatp:"#,##0.0%",defaultFormatc:"[$$]#,##0.00",defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"images/sc-",defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',s_statusline_circref:'<span style="color:red;">Circular reference: ',s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",ietUnknownFunction:"Unknown function ",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderStyle:"backgroundColor:#CCC;",TCpanesliderClass:"",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#404040;",SCTabbackground:"background-color:#CCC;",SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",SCToolbartext:"font-size:x-small;font-weight:bold;color:#FFF;padding-bottom:4px;",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",SCFormatUserMaxCol:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",SCFormatUserMaxRow:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",ISCButtonBorderNormal:"#404040",ISCButtonBorderHover:"#999",ISCButtonBorderDown:"#FFF",ISCButtonDownBackground:"#888",s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",s_loc_delete_contents:"Delete Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_horizontal:"Horizontal",s_loc_insert_column:"Insert Column",s_loc_insert_row:"Insert Row",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s_FormatNumber_daynames3:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s_FormatNumber_monthnames:["January","February","March","April","May","June","July","August","September","October","November","December"],s_FormatNumber_monthnames3:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",
s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",s_fdef_YEAR:"Returns the year part of a date value. ",s_fdef_SUMPRODUCT:"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.",s_fdef_CEILING:"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)",s_fdef_FLOOR:"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period, [factor]",s_farg_find:"string1, string2, [start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",s_farg_hlookup:"value, range, row, [rangelookup]",s_farg_iffunc:"logical-expression, true-value, [false-value]",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",s_farg_replace:"text1, start, length, text2",s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext, [occurrence]",s_farg_sumif:"range1, criteria, [range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",s_farg_rangen:"range1, range2, ...",s_farg_vsig:"value, [significance]",function_classlist:["all","stat","lookup","datetime","financial","test","math","text"],s_fclass_all:"All",s_fclass_stat:"Statistics",s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",lastone:null},r.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",TDpopupElement:""},r.ConstantsSetClasses=function(e){var t,n=r.ConstantsDefaultClasses,o=r.Constants;e=e||"";for(t in n)"string"==typeof n[t]?(o[t+"Class"]=e+(n[t]||t),void 0!==o[t+"Style"]&&(o[t+"Style"]="")):"object"==typeof n[t]&&(o[t+"Class"]=e+(n[t].classname||t),o[t+"Style"]=n[t].style)},r.ConstantsSetImagePrefix=function(e){var t=r.Constants;for(var n in t)"string"==typeof t[n]&&(t[n]=t[n].replace(t.defaultImagePrefix,e));t.defaultImagePrefix=e};var r;r||(r={}),r.Callbacks={expand_wiki:null,expand_markup:function(e,t,n){return r.default_expand_markup(e,t,n)},MakePageLink:null,NormalizeSheetName:null},r.Cell=function(e){this.coord=e,this.datavalue="",this.datatype=null,this.formula="",this.valuetype="b",this.readonly=!1},r.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3},r.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"},r.Sheet=function(){r.ResetSheet(this),this.statuscallback=null,this.statuscallbackparams=null},r.ResetSheet=function(e,t){e.cells={},e.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0},e.rowattribs={hide:{},height:{}},e.colattribs={width:{},hide:{}},e.names={},e.layouts=[],e.layouthash={},e.fonts=[],e.fonthash={},e.colors=[],e.colorhash={},e.borderstyles=[],e.borderstylehash={},e.cellformats=[],e.cellformathash={},e.valueformats=[],e.valueformathash={},e.copiedfrom="",e.changes=new r.UndoStack,e.renderneeded=!1,e.changedrendervalues=!0,e.recalcchangedavalue=!1,e.hiddencolrow="",e.sci=new r.SheetCommandInfo(e)},r.Sheet.prototype.ResetSheet=function(){r.ResetSheet(this)},r.Sheet.prototype.AddCell=function(e){return this.cells[e.coord]=e},r.Sheet.prototype.GetAssuredCell=function(e){return this.cells[e]||this.AddCell(new r.Cell(e))},r.Sheet.prototype.ParseSheetSave=function(e){r.ParseSheetSave(e,this)},r.Sheet.prototype.CellFromStringParts=function(e,t,n){return r.CellFromStringParts(this,e,t,n)},r.Sheet.prototype.CreateSheetSave=function(e,t){return r.CreateSheetSave(this,e,t)},r.Sheet.prototype.CellToString=function(e){return r.CellToString(this,e)},r.Sheet.prototype.CanonicalizeSheet=function(e){return r.CanonicalizeSheet(this,e)},r.Sheet.prototype.EncodeCellAttributes=function(e){return r.EncodeCellAttributes(this,e)},r.Sheet.prototype.EncodeSheetAttributes=function(){return r.EncodeSheetAttributes(this)},r.Sheet.prototype.DecodeCellAttributes=function(e,t,n){return r.DecodeCellAttributes(this,e,t,n)},r.Sheet.prototype.DecodeSheetAttributes=function(e){return r.DecodeSheetAttributes(this,e)},r.Sheet.prototype.ScheduleSheetCommands=function(e,t){return r.ScheduleSheetCommands(this,e,t)},r.Sheet.prototype.SheetUndo=function(){return r.SheetUndo(this)},r.Sheet.prototype.SheetRedo=function(){return r.SheetRedo(this)},r.Sheet.prototype.CreateAuditString=function(){return r.CreateAuditString(this)},r.Sheet.prototype.GetStyleNum=function(e,t){return r.GetStyleNum(this,e,t)},r.Sheet.prototype.GetStyleString=function(e,t){return r.GetStyleString(this,e,t)},r.Sheet.prototype.RecalcSheet=function(){return r.RecalcSheet(this)},r.ParseSheetSave=function(e,t){var n,o,s,a,i,l,u,c,d,p=e.split(/\r\n|\n/),h=[],f=r.Constants;for(o=0;o<p.length;o++){switch(n=p[o],h=n.split(":"),h[0]){case"cell":u=t.GetAssuredCell(h[1]),s=2,t.CellFromStringParts(u,h,s);break;case"col":for(l=h[1],s=2;a=h[s++];)switch(a){case"w":t.colattribs.width[l]=h[s++];break;case"hide":t.colattribs.hide[l]=h[s++];break;default:throw f.s_pssUnknownColType+" '"+a+"'"}break;case"row":for(l=h[1]-0,s=2;a=h[s++];)switch(a){case"h":t.rowattribs.height[l]=h[s++]-0;break;case"hide":t.rowattribs.hide[l]=h[s++];break;default:throw f.s_pssUnknownRowType+" '"+a+"'"}break;case"sheet":for(c=t.attribs,s=1;a=h[s++];)switch(a){case"c":c.lastcol=h[s++]-0;break;case"r":c.lastrow=h[s++]-0;break;case"w":c.defaultcolwidth=h[s++]+"";break;case"h":c.defaultrowheight=h[s++]-0;break;case"tf":c.defaulttextformat=h[s++]-0;break;case"ntf":c.defaultnontextformat=h[s++]-0;break;case"layout":c.defaultlayout=h[s++]-0;break;case"font":c.defaultfont=h[s++]-0;break;case"tvf":c.defaulttextvalueformat=h[s++]-0;break;case"ntvf":c.defaultnontextvalueformat=h[s++]-0;break;case"color":c.defaultcolor=h[s++]-0;break;case"bgcolor":c.defaultbgcolor=h[s++]-0;break;case"circularreferencecell":c.circularreferencecell=h[s++];break;case"recalc":c.recalc=h[s++];break;case"needsrecalc":c.needsrecalc=h[s++];break;case"usermaxcol":c.usermaxcol=h[s++]-0;break;case"usermaxrow":c.usermaxrow=h[s++]-0;break;default:s+=1}break;case"name":d=r.decodeFromSave(h[1]).toUpperCase(),t.names[d]={desc:r.decodeFromSave(h[2])},t.names[d].definition=r.decodeFromSave(h[3]);break;case"layout":h=p[o].match(/^layout\:(\d+)\:(.+)$/),t.layouts[h[1]-0]=h[2],t.layouthash[h[2]]=h[1]-0;break;case"font":t.fonts[h[1]-0]=h[2],t.fonthash[h[2]]=h[1]-0;break;case"color":t.colors[h[1]-0]=h[2],t.colorhash[h[2]]=h[1]-0;break;case"border":t.borderstyles[h[1]-0]=h[2],t.borderstylehash[h[2]]=h[1]-0;break;case"cellformat":i=r.decodeFromSave(h[2]),t.cellformats[h[1]-0]=i,t.cellformathash[i]=h[1]-0;break;case"valueformat":i=r.decodeFromSave(h[2]),t.valueformats[h[1]-0]=i,t.valueformathash[i]=h[1]-0;break;case"version":break;case"copiedfrom":t.copiedfrom=h[1]+":"+h[2];break;case"clipboardrange":case"clipboard":break;case"":break;default:throw alert(f.s_pssUnknownLineType+" '"+h[0]+"'"),f.s_pssUnknownLineType+" '"+h[0]+"'"}h=null}},r.CellFromStringParts=function(e,t,n,o){for(var t,s,a;s=n[o++];)switch(s){case"v":t.datavalue=r.decodeFromSave(n[o++])-0,t.datatype="v",t.valuetype="n";break;case"t":t.datavalue=r.decodeFromSave(n[o++]),t.datatype="t",t.valuetype=r.Constants.textdatadefaulttype;break;case"vt":a=n[o++],t.valuetype=a,"n"==a.charAt(0)?(t.datatype="v",t.datavalue=r.decodeFromSave(n[o++])-0):(t.datatype="t",t.datavalue=r.decodeFromSave(n[o++]));break;case"vtf":a=n[o++],t.valuetype=a,"n"==a.charAt(0)?t.datavalue=r.decodeFromSave(n[o++])-0:t.datavalue=r.decodeFromSave(n[o++]),t.formula=r.decodeFromSave(n[o++]),t.datatype="f";break;case"vtc":a=n[o++],t.valuetype=a,"n"==a.charAt(0)?t.datavalue=r.decodeFromSave(n[o++])-0:t.datavalue=r.decodeFromSave(n[o++]),t.formula=r.decodeFromSave(n[o++]),t.datatype="c";break;case"ro":ro=r.decodeFromSave(n[o++]),t.readonly="yes"==ro.toLowerCase();break;case"e":t.errors=r.decodeFromSave(n[o++]);break;case"b":t.bt=n[o++]-0,t.br=n[o++]-0,t.bb=n[o++]-0,t.bl=n[o++]-0;break;case"l":t.layout=n[o++]-0;break;case"f":t.font=n[o++]-0;break;case"c":t.color=n[o++]-0;break;case"bg":t.bgcolor=n[o++]-0;break;case"cf":t.cellformat=n[o++]-0;break;case"ntvf":t.nontextvalueformat=n[o++]-0;break;case"tvf":t.textvalueformat=n[o++]-0;break;case"colspan":t.colspan=n[o++]-0;break;case"rowspan":t.rowspan=n[o++]-0;break;case"cssc":t.cssc=n[o++];break;case"csss":t.csss=r.decodeFromSave(n[o++]);break;case"mod":o+=1;break;case"comment":t.comment=r.decodeFromSave(n[o++]);break;default:throw r.Constants.s_cfspUnknownCellType+" '"+s+"'"}},r.sheetfields=["defaultrowheight","defaultcolwidth","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],r.sheetfieldsshort=["h","w","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],r.sheetfieldsxlat=["defaulttextformat","defaultnontextformat","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","defaultfont","defaultlayout"],r.sheetfieldsxlatshort=["tf","ntf","tvf","ntvf","color","bgcolor","font","layout"],r.sheetfieldsxlatxlt=["cellformat","cellformat","valueformat","valueformat","color","color","font","layout"],r.CreateSheetSave=function(e,t,n){var o,s,a,i,l,u,c,d,p,h,f,m=[];e.CanonicalizeSheet(n||r.Constants.doCanonicalizeSheet);var y=e.xlt;for(f=t?r.ParseRange(t):{cr1:{row:1,col:1},cr2:{row:y.maxrow,col:y.maxcol}},s=f.cr1,a=f.cr2,m.push("version:1.5"),i=s.row;i<=a.row;i++)for(l=s.col;l<=a.col;l++)u=r.crToCoord(l,i),o=e.cells[u],o&&(c=e.CellToString(o),0!=c.length&&(c="cell:"+u+c,m.push(c)));for(l=1;l<=y.maxcol;l++)u=r.rcColname(l),e.colattribs.width[u]&&m.push("col:"+u+":w:"+e.colattribs.width[u]),e.colattribs.hide[u]&&m.push("col:"+u+":hide:"+e.colattribs.hide[u]);for(i=1;i<=y.maxrow;i++)e.rowattribs.height[i]&&m.push("row:"+i+":h:"+e.rowattribs.height[i]),e.rowattribs.hide[i]&&m.push("row:"+i+":hide:"+e.rowattribs.hide[i]);for(c="sheet:c:"+y.maxcol+":r:"+y.maxrow,p=0;p<r.sheetfields.length;p++)d=r.encodeForSave(e.attribs[r.sheetfields[p]]),d&&(c+=":"+r.sheetfieldsshort[p]+":"+d);for(p=0;p<r.sheetfieldsxlat.length;p++)d=e.attribs[r.sheetfieldsxlat[p]],d&&(c+=":"+r.sheetfieldsxlatshort[p]+":"+y[r.sheetfieldsxlatxlt[p]+"sxlat"][d]);for(m.push(c),p=1;p<y.newborderstyles.length;p++)m.push("border:"+p+":"+y.newborderstyles[p]);for(p=1;p<y.newcellformats.length;p++)m.push("cellformat:"+p+":"+r.encodeForSave(y.newcellformats[p]));for(p=1;p<y.newcolors.length;p++)m.push("color:"+p+":"+y.newcolors[p]);for(p=1;p<y.newfonts.length;p++)m.push("font:"+p+":"+y.newfonts[p]);for(p=1;p<y.newlayouts.length;p++)m.push("layout:"+p+":"+y.newlayouts[p]);for(p=1;p<y.newvalueformats.length;p++)m.push("valueformat:"+p+":"+r.encodeForSave(y.newvalueformats[p]));for(p=0;p<y.namesorder.length;p++)h=y.namesorder[p],m.push("name:"+r.encodeForSave(h).toUpperCase()+":"+r.encodeForSave(e.names[h].desc)+":"+r.encodeForSave(e.names[h].definition));return t&&m.push("copiedfrom:"+r.crToCoord(s.col,s.row)+":"+r.crToCoord(a.col,a.row)),m.push(""),delete e.xlt,m.join("\n")},r.CellToString=function(e,t){var t,n,o,s,a,i,l,u,c;return n="",t?(o=r.encodeForSave(t.datavalue),"v"==t.datatype?n+="n"==t.valuetype?":v:"+o:":vt:"+t.valuetype+":"+o:"t"==t.datatype?n+=t.valuetype==r.Constants.textdatadefaulttype?":t:"+o:":vt:"+t.valuetype+":"+o:(s=r.encodeForSave(t.formula),"f"==t.datatype?n+=":vtf:"+t.valuetype+":"+o+":"+s:"c"==t.datatype&&(n+=":vtc:"+t.valuetype+":"+o+":"+s)),t.readonly&&(n+=":ro:yes"),t.errors&&(n+=":e:"+r.encodeForSave(t.errors)),a=t.bt||"",i=t.br||"",l=t.bb||"",u=t.bl||"",e.xlt?(c=e.xlt,(a||i||l||u)&&(n+=":b:"+c.borderstylesxlat[a||0]+":"+c.borderstylesxlat[i||0]+":"+c.borderstylesxlat[l||0]+":"+c.borderstylesxlat[u||0]),t.layout&&(n+=":l:"+c.layoutsxlat[t.layout]),t.font&&(n+=":f:"+c.fontsxlat[t.font]),t.color&&(n+=":c:"+c.colorsxlat[t.color]),t.bgcolor&&(n+=":bg:"+c.colorsxlat[t.bgcolor]),t.cellformat&&(n+=":cf:"+c.cellformatsxlat[t.cellformat]),t.textvalueformat&&(n+=":tvf:"+c.valueformatsxlat[t.textvalueformat]),t.nontextvalueformat&&(n+=":ntvf:"+c.valueformatsxlat[t.nontextvalueformat])):((a||i||l||u)&&(n+=":b:"+a+":"+i+":"+l+":"+u),t.layout&&(n+=":l:"+t.layout),t.font&&(n+=":f:"+t.font),t.color&&(n+=":c:"+t.color),t.bgcolor&&(n+=":bg:"+t.bgcolor),t.cellformat&&(n+=":cf:"+t.cellformat),t.textvalueformat&&(n+=":tvf:"+t.textvalueformat),t.nontextvalueformat&&(n+=":ntvf:"+t.nontextvalueformat)),t.colspan&&(n+=":colspan:"+t.colspan),t.rowspan&&(n+=":rowspan:"+t.rowspan),t.cssc&&(n+=":cssc:"+t.cssc),t.csss&&(n+=":csss:"+r.encodeForSave(t.csss)),t.mod&&(n+=":mod:"+t.mod),t.comment&&(n+=":comment:"+r.encodeForSave(t.comment)),n):n},r.CanonicalizeSheet=function(e,t){var n,o,s,a,i,l,u,c,d,p,h,f,m,y=0,v=0,g=["borderstyle","cellformat","color","font","layout","valueformat"],b={};b.namesorder=[];for(u in e.names)b.namesorder.push(u);if(b.namesorder.sort(),!r.Constants.doCanonicalizeSheet||!t){for(l=0;l<g.length;l++){for(u=g[l],b["new"+u+"s"]=e[u+"s"],n=e[u+"s"].length,d=new Array(n),d[0]="",f=1;n>f;f++)d[f]=f;b[u+"sxlat"]=d}return b.maxrow=e.attribs.lastrow,b.maxcol=e.attribs.lastcol,void(e.xlt=b)}for(l=0;l<g.length;l++)u=g[l],b[u+"sUsed"]={};var _=b.colorsUsed,C=b.borderstylesUsed,x=b.fontsUsed,w=b.layoutsUsed,S=b.cellformatsUsed,k=b.valueformatsUsed;for(o in e.cells)s=r.coordToCr(o),a=e.cells[o],i=!1,a.valuetype&&"b"!=a.valuetype&&(i=!0),a.color&&(_[a.color]=1,i=!0),a.bgcolor&&(_[a.bgcolor]=1,i=!0),a.bt&&(C[a.bt]=1,i=!0),a.br&&(C[a.br]=1,i=!0),a.bb&&(C[a.bb]=1,i=!0),a.bl&&(C[a.bl]=1,i=!0),a.layout&&(w[a.layout]=1,i=!0),a.font&&(x[a.font]=1,i=!0),a.cellformat&&(S[a.cellformat]=1,i=!0),a.textvalueformat&&(k[a.textvalueformat]=1,i=!0),a.nontextvalueformat&&(k[a.nontextvalueformat]=1,i=!0),i&&(s.row>y&&(y=s.row),s.col>v&&(v=s.col));for(f=0;f<r.sheetfieldsxlat.length;f++)m=e.attribs[r.sheetfieldsxlat[f]],m&&(b[r.sheetfieldsxlatxlt[f]+"sUsed"][m]=1);u={height:1,hide:1};for(m in u)for(s in e.rowattribs[m])s>y&&(y=s);u={hide:1,width:1};for(m in u)for(o in e.colattribs[m])s=r.coordToCr(o+"1"),s.col>v&&(v=s.col);for(l=0;l<g.length;l++){u=g[l],c=[],p=b[u+"sUsed"];for(m in p)c.push(e[u+"s"][m]);for(c.sort(),c.unshift(""),d=[""],h=e[u+"hash"],f=1;f<c.length;f++)d[h[c[f]]]=f;b[u+"sxlat"]=d,b["new"+u+"s"]=c}b.maxrow=y||1,b.maxcol=v||1,e.xlt=b},r.EncodeCellAttributes=function(e,t){var r,n,o,s={},a=function(e){s[e]={def:!0,val:""}},i=function(e){for(var t=0;t<e.length;t++)a(e[t])},l=function(e,t){s[e].def=!1,s[e].val=t||""},u=function(e,t){"*"!=t&&(s[e].def=!1,s[e].val=t)},c=e.GetAssuredCell(t);for(a("alignhoriz"),c.cellformat&&l("alignhoriz",e.cellformats[c.cellformat]),i(["alignvert","padtop","padright","padbottom","padleft"]),c.layout&&(parts=e.layouts[c.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),u("padtop",parts[1]),u("padright",parts[2]),u("padbottom",parts[3]),u("padleft",parts[4]),u("alignvert",parts[5])),i(["fontfamily","fontlook","fontsize"]),c.font&&(parts=e.fonts[c.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),u("fontfamily",parts[3]),u("fontsize",parts[2]),u("fontlook",parts[1])),a("textcolor"),c.color&&l("textcolor",e.colors[c.color]),a("bgcolor"),c.bgcolor&&l("bgcolor",e.colors[c.bgcolor]),i(["numberformat","textformat"]),c.nontextvalueformat&&l("numberformat",e.valueformats[c.nontextvalueformat]),c.textvalueformat&&l("textformat",e.valueformats[c.textvalueformat]),i(["colspan","rowspan"]),l("colspan",c.colspan||1),l("rowspan",c.rowspan||1),r=0;4>r;r++)n="trbl".charAt(r),o="b"+n,a(o),l(o,c[o]?e.borderstyles[c[o]]:""),a(o+"thickness"),a(o+"style"),a(o+"color"),c[o]&&(parts=e.borderstyles[c[o]].match(/(\S+)\s+(\S+)\s+(\S.+)/),l(o+"thickness",parts[1]),l(o+"style",parts[2]),l(o+"color",parts[3]));return i(["cssc","csss","mod"]),l("cssc",c.cssc||""),l("csss",c.csss||""),l("mod",c.mod||"n"),s},r.EncodeSheetAttributes=function(e){var t,r=e.attribs,n={},o=function(e){n[e]={def:!0,val:""}},s=function(e){for(var t=0;t<e.length;t++)o(e[t])},a=function(e,r){n[e].def=!1,n[e].val=r||t},i=function(e,t){"*"!=t&&(n[e].def=!1,n[e].val=t)};return o("colwidth"),r.defaultcolwidth&&a("colwidth",r.defaultcolwidth),o("rowheight"),r.rowheight&&a("rowheight",r.defaultrowheight),o("textalignhoriz"),r.defaulttextformat&&a("textalignhoriz",e.cellformats[r.defaulttextformat]),o("numberalignhoriz"),r.defaultnontextformat&&a("numberalignhoriz",e.cellformats[r.defaultnontextformat]),s(["alignvert","padtop","padright","padbottom","padleft"]),r.defaultlayout&&(parts=e.layouts[r.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),i("padtop",parts[1]),i("padright",parts[2]),i("padbottom",parts[3]),i("padleft",parts[4]),i("alignvert",parts[5])),s(["fontfamily","fontlook","fontsize"]),r.defaultfont&&(parts=e.fonts[r.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),i("fontfamily",parts[3]),i("fontsize",parts[2]),i("fontlook",parts[1])),o("textcolor"),r.defaultcolor&&a("textcolor",e.colors[r.defaultcolor]),o("bgcolor"),r.defaultbgcolor&&a("bgcolor",e.colors[r.defaultbgcolor]),s(["numberformat","textformat"]),r.defaultnontextvalueformat&&a("numberformat",e.valueformats[r.defaultnontextvalueformat]),r.defaulttextvalueformat&&a("textformat",e.valueformats[r.defaulttextvalueformat]),o("recalc"),r.recalc&&a("recalc",r.recalc),o("usermaxcol"),r.usermaxcol&&a("usermaxcol",r.usermaxcol),o("usermaxrow"),r.usermaxrow&&a("usermaxrow",r.usermaxrow),n},r.DecodeCellAttributes=function(e,t,r,n){var o,s,a,l=e.GetAssuredCell(t),u=!1,c=function(e,t,n){var o;r[e]&&(o=r[e].def?"":r[e].val,o!=(t||"")&&p(n+" "+o))},d="",p=function(e){d&&(d+="\n"),d+="set "+(n||t)+" "+e,u=!0};for(c("alignhoriz",e.cellformats[l.cellformat],"cellformat"),o=r.alignvert.def&&r.padtop.def&&r.padright.def&&r.padbottom.def&&r.padleft.def?"":"padding:"+(r.padtop.def?"* ":r.padtop.val+" ")+(r.padright.def?"* ":r.padright.val+" ")+(r.padbottom.def?"* ":r.padbottom.val+" ")+(r.padleft.def?"*":r.padleft.val)+";vertical-align:"+(r.alignvert.def?"*;":r.alignvert.val+";"),o!=(e.layouts[l.layout]||"")&&p("layout "+o),o=r.fontlook.def&&r.fontsize.def&&r.fontfamily.def?"":(r.fontlook.def?"* ":r.fontlook.val+" ")+(r.fontsize.def?"* ":r.fontsize.val+" ")+(r.fontfamily.def?"*":r.fontfamily.val),o!=(e.fonts[l.font]||"")&&p("font "+o),c("textcolor",e.colors[l.color],"color"),c("bgcolor",e.colors[l.bgcolor],"bgcolor"),c("numberformat",e.valueformats[l.nontextvalueformat],"nontextvalueformat"),c("textformat",e.valueformats[l.textvalueformat],"textvalueformat"),i=0;i<4;i++)s="trbl".charAt(i),a="b"+s,c(a,e.borderstyles[l[a]],a);return c("cssc",l.cssc,"cssc"),c("csss",l.csss,"csss"),r.mod&&(o=r.mod.def?"n":r.mod.val,o!=(l.mod||"n")&&("n"==o&&(o=""),p("mod "+o))),u?d:null},r.DecodeSheetAttributes=function(e,t){var r,n=e.attribs,o=!1,s=function(e,r,n){var o;t[e]&&(o=t[e].def?"":t[e].val,o!=(r||"")&&i(n+" "+o))},a="",i=function(e){a&&(a+="\n"),a+="set sheet "+e,o=!0};return s("colwidth",n.defaultcolwidth,"defaultcolwidth"),s("rowheight",n.defaultrowheight,"defaultrowheight"),s("textalignhoriz",e.cellformats[n.defaulttextformat],"defaulttextformat"),s("numberalignhoriz",e.cellformats[n.defaultnontextformat],"defaultnontextformat"),r=t.alignvert.def&&t.padtop.def&&t.padright.def&&t.padbottom.def&&t.padleft.def?"":"padding:"+(t.padtop.def?"* ":t.padtop.val+" ")+(t.padright.def?"* ":t.padright.val+" ")+(t.padbottom.def?"* ":t.padbottom.val+" ")+(t.padleft.def?"*":t.padleft.val)+";vertical-align:"+(t.alignvert.def?"*;":t.alignvert.val+";"),r!=(e.layouts[n.defaultlayout]||"")&&i("defaultlayout "+r),r=t.fontlook.def&&t.fontsize.def&&t.fontfamily.def?"":(t.fontlook.def?"* ":t.fontlook.val+" ")+(t.fontsize.def?"* ":t.fontsize.val+" ")+(t.fontfamily.def?"*":t.fontfamily.val),r!=(e.fonts[n.defaultfont]||"")&&i("defaultfont "+r),s("textcolor",e.colors[n.defaultcolor],"defaultcolor"),s("bgcolor",e.colors[n.defaultbgcolor],"defaultbgcolor"),s("numberformat",e.valueformats[n.defaultnontextvalueformat],"defaultnontextvalueformat"),s("textformat",e.valueformats[n.defaulttextvalueformat],"defaulttextvalueformat"),s("recalc",e.attribs.recalc,"recalc"),s("usermaxcol",e.attribs.usermaxcol,"usermaxcol"),s("usermaxrow",e.attribs.usermaxrow,"usermaxrow"),o?a:null},r.SheetCommandInfo=function(e){this.sheetobj=e,this.timerobj=null,this.firsttimerdelay=50,this.timerdelay=1,this.maxtimeslice=100,this.saveundo=!1,this.CmdExtensionCallbacks={}},r.ScheduleSheetCommands=function(e,t,o){var s=e.sci,a=new r.Parse(t);s.sheetobj.statuscallback&&e.statuscallback(s,"cmdstart","",s.sheetobj.statuscallbackparams),o&&s.sheetobj.changes.PushChange(""),s.timerobj=n.setTimeout(function(){r.SheetCommandsTimerRoutine(s,a,o)},s.firsttimerdelay)},r.SheetCommandsTimerRoutine=function(e,t,o){var s,a=new Date;for(e.timerobj=null;!t.EOF();)if(s=r.ExecuteSheetCommand(e.sheetobj,t,o),s&&alert(s),t.NextLine(),new Date-a>=e.maxtimeslice)return void(e.timerobj=n.setTimeout(function(){r.SheetCommandsTimerRoutine(e,t,o)},e.timerdelay));e.sheetobj.statuscallback&&e.sheetobj.statuscallback(e,"cmdend","",e.sheetobj.statuscallbackparams)},r.ExecuteSheetCommand=function(e,t,n){var o,s,a,i,l,u,c,d,p,h,f,m,y,v,g,b,_,C,x,w,S,k,F,T,N,A,E,L,R,O,P,I,j,M,D,U,V,B,G,z,H,$,W,q,X,Y,J,K,Z,Q,ee,te,re,ne,oe,se,ae,ie,le,ue,ce,de=e.attribs,pe=e.changes,he=r.CellProperties,fe=r.Constants,me=function(){var e=r.ParseRange(i);m=e.cr1,y=e.cr2,y.col>de.lastcol&&(de.lastcol=y.col),y.row>de.lastrow&&(de.lastrow=y.row)};switch(p="",o=t.RestOfStringNoMove(),n&&e.changes.AddDo(o),s=t.NextToken()){case"set":if(i=t.NextToken(),l=t.NextToken(),a=t.RestOfString(),h="set "+i+" "+l,"sheet"==i)switch(e.renderneeded=!0,l){case"defaultcolwidth":n&&pe.AddUndo(h,de[l]),de[l]=a;break;case"defaultcolor":case"defaultbgcolor":n&&pe.AddUndo(h,e.GetStyleString("color",de[l])),de[l]=e.GetStyleNum("color",a);break;case"defaultlayout":n&&pe.AddUndo(h,e.GetStyleString("layout",de[l])),de[l]=e.GetStyleNum("layout",a);break;case"defaultfont":n&&pe.AddUndo(h,e.GetStyleString("font",de[l])),"* * *"==a&&(a=""),de[l]=e.GetStyleNum("font",a);break;case"defaulttextformat":case"defaultnontextformat":n&&pe.AddUndo(h,e.GetStyleString("cellformat",de[l])),de[l]=e.GetStyleNum("cellformat",a);break;case"defaulttextvalueformat":case"defaultnontextvalueformat":n&&pe.AddUndo(h,e.GetStyleString("valueformat",de[l])),de[l]=e.GetStyleNum("valueformat",a);for(b in e.cells)delete e.cells[b].displaystring;break;case"lastcol":case"lastrow":n&&pe.AddUndo(h,de[l]-0),u=a-0,"number"==typeof u&&(de[l]=u>0?u:1);break;case"recalc":n&&pe.AddUndo(h,de[l]),"off"==a?de.recalc=a:delete de.recalc;break;case"usermaxcol":case"usermaxrow":n&&pe.AddUndo(h,de[l]-0),u=a-0,"number"==typeof u&&(de[l]=u>0?u:0);break;default:p=fe.s_escUnknownSheetCmd+o}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(i))for(e.renderneeded=!0,i=i.toUpperCase(),c=i.indexOf(":"),c>=0?(m=r.coordToCr(i.substring(0,c)+"1"),y=r.coordToCr(i.substring(c+1)+"1")):(m=r.coordToCr(i+"1"),y=m),v=m.col;v<=y.col;v++)"width"==l?(b=r.rcColname(v),n&&pe.AddUndo("set "+b+" width",e.colattribs.width[b]),a.length>0?e.colattribs.width[b]=a:delete e.colattribs.width[b]):"hide"==l&&(e.hiddencolrow="col",b=r.rcColname(v),n&&pe.AddUndo("set "+b+" hide",e.colattribs.hide[b]),a.length>0?e.colattribs.hide[b]=a:delete e.colattribs.hide[b]);else if(/^\d+(:\d+)?$/i.test(i))for(e.renderneeded=!0,i=i.toUpperCase(),c=i.indexOf(":"),c>=0?(m=r.coordToCr("A"+i.substring(0,c)),y=r.coordToCr("A"+i.substring(c+1))):(m=r.coordToCr("A"+i),y=m),g=m.row;g<=y.row;g++)"height"==l?(n&&pe.AddUndo("set "+g+" height",e.rowattribs.height[g]),a.length>0?e.rowattribs.height[g]=a:delete e.rowattribs.height[g]):"hide"==l&&(e.hiddencolrow="row",n&&pe.AddUndo("set "+g+" hide",e.rowattribs.hide[g]),a.length>0?e.rowattribs.hide[g]=a:delete e.rowattribs.hide[g]);else if(/^[a-z]{1,2}\d+(:[a-z]{1,2}\d+)?$/i.test(i))for(me(),m.row!=y.row||m.col!=y.col||e.celldisplayneeded||e.renderneeded?(e.renderneeded=!0,e.celldisplayneeded=""):e.celldisplayneeded=r.crToCoord(m.col,m.row),g=m.row;g<=y.row;g++)for(v=m.col;v<=y.col;v++)b=r.crToCoord(v,g),_=e.GetAssuredCell(b),_.readonly&&"readonly"!=l||(n&&pe.AddUndo("set "+b+" all",e.CellToString(_)),"value"==l?(c=a.indexOf(" "),_.datavalue=a.substring(c+1)-0,delete _.errors,_.datatype="v",_.valuetype=a.substring(0,c),delete _.displaystring,delete _.parseinfo,de.needsrecalc="yes"):"text"==l?(c=a.indexOf(" "),_.datavalue=r.decodeFromSave(a.substring(c+1)),delete _.errors,_.datatype="t",_.valuetype=a.substring(0,c),delete _.displaystring,delete _.parseinfo,de.needsrecalc="yes"):"formula"==l?(_.datavalue=0,delete _.errors,_.datatype="f",_.valuetype="e#N/A",_.formula=a,delete _.displaystring,delete _.parseinfo,
de.needsrecalc="yes"):"constant"==l?(c=a.indexOf(" "),d=a.substring(c+1).indexOf(" "),_.datavalue=a.substring(c+1,c+1+d)-0,_.valuetype=a.substring(0,c),"e"==_.valuetype.charAt(0)?_.errors=_.valuetype.substring(1):delete _.errors,_.datatype="c",_.formula=a.substring(c+d+2),delete _.displaystring,delete _.parseinfo,de.needsrecalc="yes"):"empty"==l?(_.datavalue="",delete _.errors,_.datatype=null,_.formula="",_.valuetype="b",delete _.displaystring,delete _.parseinfo,de.needsrecalc="yes"):"all"==l?(a.length>0?(_=new r.Cell(b),e.CellFromStringParts(_,a.split(":"),1),e.cells[b]=_):delete e.cells[b],de.needsrecalc="yes"):/^b[trbl]$/.test(l)?(_[l]=e.GetStyleNum("borderstyle",a),e.renderneeded=!0):"color"==l||"bgcolor"==l?_[l]=e.GetStyleNum("color",a):"layout"==l||"cellformat"==l?_[l]=e.GetStyleNum(l,a):"font"==l?("* * *"==a&&(a=""),_[l]=e.GetStyleNum("font",a)):"textvalueformat"==l||"nontextvalueformat"==l?(_[l]=e.GetStyleNum("valueformat",a),delete _.displaystring):"cssc"==l?(a=a.replace(/[^a-zA-Z0-9\-]/g,""),_.cssc=a):"csss"==l?(a=a.replace(/\n/g,""),_.csss=a):"mod"==l?(a=a.replace(/[^yY]/g,"").toLowerCase(),_.mod=a):"comment"==l?_.comment=r.decodeFromSave(a):"readonly"==l?_.readonly="yes"==a.toLowerCase():p=fe.s_escUnknownSetCoordCmd+o);break;case"merge":if(e.renderneeded=!0,i=t.NextToken(),a=t.RestOfString(),me(),_=e.GetAssuredCell(m.coord),_.readonly)break;n&&pe.AddUndo("unmerge "+m.coord),y.col>m.col?_.colspan=y.col-m.col+1:delete _.colspan,y.row>m.row?_.rowspan=y.row-m.row+1:delete _.rowspan,e.changedrendervalues=!0;break;case"unmerge":if(e.renderneeded=!0,i=t.NextToken(),a=t.RestOfString(),me(),_=e.GetAssuredCell(m.coord),_.readonly)break;n&&pe.AddUndo("merge "+m.coord+":"+r.crToCoord(m.col+(_.colspan||1)-1,m.row+(_.rowspan||1)-1)),delete _.colspan,delete _.rowspan,e.changedrendervalues=!0;break;case"erase":case"cut":for(e.renderneeded=!0,e.changedrendervalues=!0,i=t.NextToken(),a=t.RestOfString(),me(),n&&pe.AddUndo("changedrendervalues"),"cut"==s&&(n&&pe.AddUndo("loadclipboard",r.encodeForSave(r.Clipboard.clipboard)),r.Clipboard.clipboard=r.CreateSheetSave(e,i)),g=m.row;g<=y.row;g++)for(v=m.col;v<=y.col;v++)b=r.crToCoord(v,g),_=e.GetAssuredCell(b),_.readonly||(n&&pe.AddUndo("set "+b+" all",e.CellToString(_)),"all"==a?delete e.cells[b]:"formulas"==a?(_.datavalue="",_.datatype=null,_.formula="",_.valuetype="b",delete _.errors,delete _.displaystring,delete _.parseinfo,_.comment&&delete _.comment):"formats"==a&&(C=new r.Cell(b),C.datavalue=_.datavalue,C.datatype=_.datatype,C.formula=_.formula,C.valuetype=_.valuetype,_.comment&&(C.comment=_.comment),e.cells[b]=C));de.needsrecalc="yes";break;case"fillright":case"filldown":for(e.renderneeded=!0,e.changedrendervalues=!0,n&&pe.AddUndo("changedrendervalues"),i=t.NextToken(),a=t.RestOfString(),me(),"fillright"==s?(x=!0,w=m.row,S=m.col+1):(x=!1,w=m.row+1,S=m.col),g=w;g<=y.row;g++)for(v=S;v<=y.col;v++)if(b=r.crToCoord(v,g),_=e.GetAssuredCell(b),!_.readonly){if(n&&pe.AddUndo("set "+b+" all",e.CellToString(_)),x?(k=r.crToCoord(m.col,g),T=v-S+1,F=0):(k=r.crToCoord(v,m.row),T=0,F=g-w+1),N=e.GetAssuredCell(k),"all"==a||"formats"==a)for(l in he)1!=he[l]&&(void 0===typeof N[l]||3==he[l]?delete _[l]:_[l]=N[l]);("all"==a||"formulas"==a)&&(_.datavalue=N.datavalue,_.datatype=N.datatype,_.valuetype=N.valuetype,"f"==_.datatype?_.formula=r.OffsetFormulaCoords(N.formula,T,F):_.formula=N.formula,delete _.parseinfo,_.errors=N.errors),delete _.displaystring}de.needsrecalc="yes";break;case"copy":i=t.NextToken(),a=t.RestOfString(),n&&pe.AddUndo("loadclipboard",r.encodeForSave(r.Clipboard.clipboard)),r.Clipboard.clipboard=r.CreateSheetSave(e,i);break;case"loadclipboard":a=t.RestOfString(),n&&pe.AddUndo("loadclipboard",r.encodeForSave(r.Clipboard.clipboard)),r.Clipboard.clipboard=r.decodeFromSave(a);break;case"clearclipboard":n&&pe.AddUndo("loadclipboard",r.encodeForSave(r.Clipboard.clipboard)),r.Clipboard.clipboard="";break;case"paste":if(e.renderneeded=!0,e.changedrendervalues=!0,n&&pe.AddUndo("changedrendervalues"),i=t.NextToken(),a=t.RestOfString(),me(),!r.Clipboard.clipboard)break;for(A=new r.Sheet,A.ParseSheetSave(r.Clipboard.clipboard),E=r.ParseRange(A.copiedfrom),T=m.col-E.cr1.col,F=m.row-E.cr1.row,L=Math.max(y.col-m.col+1,E.cr2.col-E.cr1.col+1),R=Math.max(y.row-m.row+1,E.cr2.row-E.cr1.row+1),m.col+L-1>de.lastcol&&(de.lastcol=m.col+L-1),m.row+R-1>de.lastrow&&(de.lastrow=m.row+R-1),g=m.row;g<m.row+R;g++)for(v=m.col;v<m.col+L;v++)if(b=r.crToCoord(v,g),_=e.GetAssuredCell(b),!_.readonly){if(n&&pe.AddUndo("set "+b+" all",e.CellToString(_)),k=r.crToCoord(E.cr1.col+(v-m.col)%(E.cr2.col-E.cr1.col+1),E.cr1.row+(g-m.row)%(E.cr2.row-E.cr1.row+1)),N=A.GetAssuredCell(k),"all"==a||"formats"==a)for(l in he)1!=he[l]&&(void 0===typeof N[l]||3==he[l]?delete _[l]:(O=r.CellPropertiesTable[l],O&&N[l]?_[l]=e.GetStyleNum(O,A.GetStyleString(O,N[l])):_[l]=N[l]));("all"==a||"formulas"==a)&&(_.datavalue=N.datavalue,_.datatype=N.datatype,_.valuetype=N.valuetype,"f"==_.datatype?_.formula=r.OffsetFormulaCoords(N.formula,T,F):_.formula=N.formula,delete _.parseinfo,_.errors=N.errors,N.comment?_.comment=N.comment:_.comment&&delete _.comment),delete _.displaystring}de.needsrecalc="yes";break;case"sort":for(e.renderneeded=!0,e.changedrendervalues=!0,n&&pe.AddUndo("changedrendervalues"),i=t.NextToken(),me(),Y=[],J=[],K=0,Z=0;3>=Z;Z++)Y[Z]=t.NextToken(),J[Z]=t.NextToken(),Y[Z]&&(K=Z);for(ee={},Q=[],te=[],re=[],g=m.row;g<=y.row;g++){for(v=m.col;v<=y.col;v++)b=r.crToCoord(v,g),_=e.cells[b],_?(ee[b]=e.CellToString(_),n&&pe.AddUndo("set "+b+" all",ee[b])):n&&pe.AddUndo("set "+b+" all");for(Q.push(Q.length),te.push([]),re.push([]),slast=re.length-1,Z=0;K>=Z;Z++)b=Y[Z]+g,_=e.GetAssuredCell(b),f=_.datavalue,oe=_.valuetype.charAt(0)||"b","t"==oe&&(f=f.toLowerCase()),te[slast].push(f),re[slast].push(oe)}for(ne=function(e,t){var r,n,o,s,a;for(r=0;K>=r;r++)if("up"==J[r]?(n=e,o=t):(n=t,o=e),s=re[n][r],tb=re[o][r],"t"==s?"t"==tb?(n=te[n][r],o=te[o][r],a=n>o?1:o>n?-1:0):"n"==tb?a=1:"b"==tb?a="up"==J[r]?-1:1:"e"==tb&&(a=-1):"n"==s?"t"==tb?a=-1:"n"==tb?(n=te[n][r]-0,o=te[o][r]-0,a=n>o?1:o>n?-1:0):"b"==tb?a="up"==J[r]?-1:1:"e"==tb&&(a=-1):"e"==s?"e"==tb?(n=te[n][r],o=te[o][r],a=n>o?1:o>n?-1:0):a="b"==tb&&"up"==J[r]?-1:1:"b"==s&&(a="b"==tb?0:"up"==J[r]?1:-1),a)return a;return a=e>t?1:t>e?-1:0},Q.sort(ne),g=m.row;g<=y.row;g++)for(se=Q[g-m.row],v=m.col;v<=y.col;v++)b=r.crToCoord(v,g),ae=r.crToCoord(v,se+m.row),ee[ae]?(_=new r.Cell(b),e.CellFromStringParts(_,ee[ae].split(":"),1),"f"==_.datatype&&(_.formula=r.OffsetFormulaCoords(_.formula,0,g-m.row-se)),e.cells[b]=_):delete e.cells[b];de.needsrecalc="yes";break;case"insertcol":case"insertrow":for(e.renderneeded=!0,e.changedrendervalues=!0,i=t.NextToken(),a=t.RestOfString(),me(),"insertcol"==s?(T=1,P=m.col,F=0,I=1,j=m.col,D=m.col,M=1,U=de.lastrow,n&&pe.AddUndo("deletecol "+m.coord)):(T=0,P=1,F=1,I=m.row,j=1,D=de.lastcol,M=m.row,U=m.row,n&&pe.AddUndo("deleterow "+m.coord)),g=de.lastrow;g>=I;g--)for(v=de.lastcol;v>=P;v--)k=r.crToCoord(v,g),b=r.crToCoord(v+T,g+F),e.cells[k]?e.cells[b]=e.cells[k]:delete e.cells[b];for(g=M;U>=g;g++)for(v=j;D>=v;v++){b=r.crToCoord(v,g),_=new r.Cell(b),e.cells[b]=_,k=r.crToCoord(v-T,g-F),N=e.GetAssuredCell(k);for(l in he)2==he[l]&&(_[l]=N[l])}for(b in e.cells)_=e.cells[b],_&&"f"==_.datatype&&(_.formula=r.AdjustFormulaCoords(_.formula,m.col,T,m.row,F)),_&&delete _.parseinfo;for(ie in e.names)e.names[ie]&&(le=e.names[ie].definition,ue="","="==le.charAt(0)&&(ue="=",le=le.substring(1)),e.names[ie].definition=ue+r.AdjustFormulaCoords(le,m.col,T,m.row,F));for(g=de.lastrow;g>=I&&"insertrow"==s;g--){V=g+F;for(l in e.rowattribs)f=e.rowattribs[l][g],e.rowattribs[l][V]!=f&&(f?e.rowattribs[l][V]=f:delete e.rowattribs[l][V])}for(v=de.lastcol;v>=P&&"insertcol"==s;v--){G=r.rcColname(v),B=r.rcColname(v+T);for(l in e.colattribs)f=e.colattribs[l][G],e.colattribs[l][B]!=f&&(f?e.colattribs[l][B]=f:delete e.colattribs[l][B])}de.lastcol+=T,de.lastrow+=F,de.needsrecalc="yes";break;case"deletecol":case"deleterow":for(e.renderneeded=!0,e.changedrendervalues=!0,i=t.NextToken(),a=t.RestOfString(),H=de.lastcol,z=de.lastrow,me(),"deletecol"==s?(T=m.col-y.col-1,F=0,S=y.col+1,w=1):(T=0,F=m.row-y.row-1,S=1,w=y.row+1),g=w;z-F>=g;g++)for(v=S;H-T>=v;v++)if(b=r.crToCoord(v+T,g+F),_=e.cells[b],_&&_.readonly)return p;for(g=w;z-F>=g;g++)for(v=S;H-T>=v;v++)b=r.crToCoord(v+T,g+F),n&&(w-F>g||S-T>v)&&(_=e.cells[b],_?pe.AddUndo("set "+b+" all",e.CellToString(_)):pe.AddUndo("erase "+b+" all")),k=r.crToCoord(v,g),_=e.cells[k],_?e.cells[b]=_:delete e.cells[b];for(b in e.cells)_=e.cells[b],_&&("f"==_.datatype?(q=_.formula,_.formula=r.AdjustFormulaCoords(q,m.col,T,m.row,F),_.formula!=q&&(delete _.parseinfo,n&&-1!=_.formula.indexOf("#REF!")&&(X=r.coordToCr(b),pe.AddUndo("set "+r.rcColname(X.col-T)+(X.row-F)+" formula "+q)))):delete _.parseinfo);for(ie in e.names)e.names[ie]&&(le=e.names[ie].definition,ue="","="==le.charAt(0)&&(ue="=",le=le.substring(1)),e.names[ie].definition=ue+r.AdjustFormulaCoords(le,m.col,T,m.row,F));for(g=w;z-F>=g&&"deleterow"==s;g++){$=g+F;for(l in e.rowattribs)f=e.rowattribs[l][g],e.rowattribs[l][$]!=f&&(n&&pe.AddUndo("set "+$+" "+l,e.rowattribs[l][$]),f?e.rowattribs[l][$]=f:delete e.rowattribs[l][$])}for(v=S;H-T>=v&&"deletecol"==s;v++){G=r.rcColname(v),W=r.rcColname(v+T);for(l in e.colattribs)f=e.colattribs[l][G],e.colattribs[l][W]!=f&&(n&&pe.AddUndo("set "+W+" "+l,e.colattribs[l][W]),f?e.colattribs[l][W]=f:delete e.colattribs[l][W])}if(n)if("deletecol"==s)for(v=m.col;v<=y.col;v++)pe.AddUndo("insertcol "+r.rcColname(v));else for(g=m.row;g<=y.row;g++)pe.AddUndo("insertrow "+g);"deletecol"==s?m.col<=H&&(y.col<=H?de.lastcol+=T:de.lastcol=m.col-1):m.row<=z&&(y.row<=z?de.lastrow+=F:de.lastrow=m.row-1),de.needsrecalc="yes";break;case"movepaste":case"moveinsert":var ye,ve,ge,be,_e,Ce,xe;for(e.renderneeded=!0,e.changedrendervalues=!0,n&&pe.AddUndo("changedrendervalues"),i=t.NextToken(),ve=t.NextToken(),a=t.RestOfString(),""==a&&(a="all"),me(),ge=r.coordToCr(ve),T=ge.col-m.col,F=ge.row-m.row,L=y.col-m.col+1,R=y.row-m.row+1,ye={},g=m.row;g<=y.row;g++)for(v=m.col;v<=y.col;v++)if(b=r.crToCoord(v,g),_=e.GetAssuredCell(b),!_.readonly&&(n&&pe.AddUndo("set "+b+" all",e.CellToString(_)),e.cells[b])){ye[b]=new r.Cell(b);for(l in he)void 0!==typeof _[l]&&(ye[b][l]=_[l],"all"==a&&delete _[l],"formulas"==a&&(1==he[l]||3==he[l])&&delete _[l],"formats"==a&&2==he[l]&&delete _[l]);"formulas"==a&&(_.datavalue="",_.datatype=null,_.formula="",_.valuetype="b"),"all"==a&&delete e.cells[b]}if("moveinsert"==s&&(be=!1,_e=!1,0==F&&(ge.col<m.col||ge.col>y.col)?ge.col<m.col?(Ce=m.col-ge.col,be=-1):(ge.col-=1,T=ge.col-y.col,Ce=ge.col-y.col,be=1):0==T&&(ge.row<m.row||ge.row>y.row)?ge.row<m.row?(Ce=m.row-ge.row,_e=-1):(ge.row-=1,F=ge.row-y.row,Ce=ge.row-y.row,_e=1):s="movepaste"),xe={},_e)for(g=0;Ce>g;g++)for(v=m.col;v<=y.col;v++){if(0>_e?(k=r.crToCoord(v,ge.row+Ce-g-1),b=r.crToCoord(v,y.row-g)):(k=r.crToCoord(v,ge.row-Ce+g+1),b=r.crToCoord(v,m.row+g)),N=e.GetAssuredCell(k),n&&pe.AddUndo("set "+k+" all",e.CellToString(N)),_=e.GetAssuredCell(b),"all"==a||"formats"==a)for(l in he)1!=he[l]&&(void 0===typeof N[l]||3==he[l]?delete _[l]:_[l]=N[l]);("all"==a||"formulas"==a)&&(_.datavalue=N.datavalue,_.datatype=N.datatype,_.valuetype=N.valuetype,_.formula=N.formula,delete _.parseinfo,_.errors=N.errors),delete _.displaystring,xe[k]=b}if(be)for(v=0;Ce>v;v++)for(g=m.row;g<=y.row;g++){if(0>be?(k=r.crToCoord(ge.col+Ce-v-1,g),b=r.crToCoord(y.col-v,g)):(k=r.crToCoord(ge.col-Ce+v+1,g),b=r.crToCoord(m.col+v,g)),N=e.GetAssuredCell(k),n&&pe.AddUndo("set "+k+" all",e.CellToString(N)),_=e.GetAssuredCell(b),"all"==a||"formats"==a)for(l in he)1!=he[l]&&(void 0===typeof N[l]||3==he[l]?delete _[l]:_[l]=N[l]);("all"==a||"formulas"==a)&&(_.datavalue=N.datavalue,_.datatype=N.datatype,_.valuetype=N.valuetype,_.formula=N.formula,delete _.parseinfo,_.errors=N.errors),delete _.displaystring,xe[k]=b}for(ge.col+L-1>de.lastcol&&(de.lastcol=ge.col+L-1),ge.row+R-1>de.lastrow&&(de.lastrow=ge.row+R-1),g=m.row;g<m.row+R;g++)for(v=m.col;v<m.col+L;v++)if(b=r.crToCoord(v+T,g+F),_=e.GetAssuredCell(b),!_.readonly)if(n&&pe.AddUndo("set "+b+" all",e.CellToString(_)),k=r.crToCoord(v,g),xe[k]=b,"all"!=a||ye[k]){if(N=ye[k],N||(N=e.GetAssuredCell(k)),"all"==a||"formats"==a)for(l in he)1!=he[l]&&(void 0===typeof N[l]||3==he[l]?delete _[l]:_[l]=N[l]);("all"==a||"formulas"==a)&&(_.datavalue=N.datavalue,_.datatype=N.datatype,_.valuetype=N.valuetype,_.formula=N.formula,delete _.parseinfo,_.errors=N.errors,N.comment?_.comment=N.comment:_.comment&&delete _.comment),delete _.displaystring}else delete e.cells[b];for(b in e.cells)_=e.cells[b],_&&("f"==_.datatype?(q=_.formula,_.formula=r.ReplaceFormulaCoords(q,xe),_.formula!=q&&(delete _.parseinfo,n&&!xe[b]&&pe.AddUndo("set "+b+" formula "+q))):delete _.parseinfo);for(ie in e.names)e.names[ie]&&(le=e.names[ie].definition,q=le,ue="","="==le.charAt(0)&&(ue="=",le=le.substring(1)),e.names[ie].definition=ue+r.ReplaceFormulaCoords(le,xe),n&&e.names[ie].definition!=q&&pe.AddUndo("name define "+ie+" "+q));de.needsrecalc="yes";break;case"name":if(i=t.NextToken(),ie=t.NextToken(),a=t.RestOfString(),ie=ie.toUpperCase().replace(/[^A-Z0-9_\.]/g,""),""==ie)break;if("define"==i){if(""==a)break;e.names[ie]?(n&&pe.AddUndo("name define "+ie+" "+e.names[ie].definition),e.names[ie].definition=a):(n&&pe.AddUndo("name delete "+ie),e.names[ie]={definition:a,desc:""})}else"desc"==i?e.names[ie]&&(n&&pe.AddUndo("name desc "+ie+" "+e.names[ie].desc),e.names[ie].desc=a):"delete"==i&&(n&&(e.names[ie].desc&&pe.AddUndo("name desc "+ie+" "+e.names[ie].desc),pe.AddUndo("name define "+ie+" "+e.names[ie].definition)),delete e.names[ie]);de.needsrecalc="yes";break;case"recalc":de.needsrecalc="yes",e.recalconce=!0;break;case"redisplay":e.renderneeded=!0;break;case"changedrendervalues":e.changedrendervalues=!0;break;case"startcmdextension":ie=t.NextToken(),ce=e.sci.CmdExtensionCallbacks[ie],ce&&ce.func(ie,ce.data,e,t,n);break;default:p=fe.s_escUnknownCmd+o}return p},r.SheetUndo=function(e){var t,r=e.changes.TOS(),n=r?r.undo.length-1:-1,o="";for(t=n;t>=0;t--)o&&(o+="\n"),o+=r.undo[t];e.changes.Undo(),e.ScheduleSheetCommands(o,!1)},r.SheetRedo=function(e){var t,r,n=e.changes.Redo();if(!n)return void e.ScheduleSheetCommands("",!1);t=e.changes.TOS();var o="";for(r=0;t&&r<t.command.length;r++)o&&(o+="\n"),o+=t.command[r];e.ScheduleSheetCommands(o,!1)},r.CreateAuditString=function(e){var t,r,n="",o=e.changes.stack,s=e.changes.tos;for(t=0;s>=t;t++)for(r=0;r<o[t].command.length;r++)n+=o[t].command[r]+"\n";return n},r.GetStyleNum=function(e,t,r){var n;return 0==r.length?0:(n=e[t+"hash"][r],n||(e[t+"s"].length<1&&e[t+"s"].push(""),n=e[t+"s"].push(r)-1,e[t+"hash"][r]=n,e.changedrendervalues=!0),n)},r.GetStyleString=function(e,t,r){return r?e[t+"s"][r]:null},r.OffsetFormulaCoords=function(e,t,n){var o,s,a,i,l,u,c="",d=r.Formula;if(!d)return"Need SocialCalc.Formula";var p=d.TokenType,h=p.op,f=p.string,m=p.coord,y=d.TokenOpExpansion;for(o=d.ParseFormulaIntoTokens(e),i=0;i<o.length;i++)a=o[i].type,s=o[i].text,a==m?(u="",l=r.coordToCr(s),"$"!=s.charAt(0)?l.col+=t:u+="$",u+=r.rcColname(l.col),-1==s.indexOf("$",1)?l.row+=n:u+="$",u+=l.row,(l.row<1||l.col<1)&&(u="#REF!"),c+=u):c+=a==f?s.indexOf('"')>=0?'"'+s.replace(/"/,'""')+'"':'"'+s+'"':a==h?y[s]||s:s;return c},r.AdjustFormulaCoords=function(e,t,n,o,s){var a,i,l,u,c="",d=!1,p=r.Formula;if(!p)return"Need SocialCalc.Formula";var h=p.TokenType,f=h.op,m=h.string,y=h.coord,v=p.TokenOpExpansion;for(parseinfo=r.Formula.ParseFormulaIntoTokens(e),l=0;l<parseinfo.length;l++)a=parseinfo[l].type,i=parseinfo[l].text,a==f&&("!"==i?d=!0:":"!=i&&(d=!1),i=v[i]||i),a==y?(cr=r.coordToCr(i),(0>n&&cr.col>=t&&cr.col<t-n||0>s&&cr.row>=o&&cr.row<o-s)&&(d||(cr.col=0,cr.row=0)),d||(cr.col>=t&&(cr.col+=n),cr.row>=o&&(cr.row+=s)),u="$"==i.charAt(0)?"$"+r.rcColname(cr.col):r.rcColname(cr.col),u+=-1!=i.indexOf("$",1)?"$"+cr.row:cr.row,(cr.row<1||cr.col<1)&&(u="#REF!"),i=u):a==m&&(i=i.indexOf('"')>=0?'"'+i.replace(/"/,'""')+'"':'"'+i+'"'),c+=i;return c},r.ReplaceFormulaCoords=function(e,t){var n,o,s,a,i,l="",u=!1,c=r.Formula;if(!c)return"Need SocialCalc.Formula";var d=c.TokenType,p=d.op,h=d.string,f=d.coord,m=c.TokenOpExpansion;for(parseinfo=r.Formula.ParseFormulaIntoTokens(e),s=0;s<parseinfo.length;s++)n=parseinfo[s].type,o=parseinfo[s].text,n==p&&("!"==o?u=!0:":"!=o&&(u=!1),o=m[o]||o),n==f?(cr=r.coordToCr(o),i=r.crToCoord(cr.col,cr.row),t[i]&&!u&&(cr=r.coordToCr(t[i]),a="$"==o.charAt(0)?"$"+r.rcColname(cr.col):r.rcColname(cr.col),a+=-1!=o.indexOf("$",1)?"$"+cr.row:cr.row,o=a)):n==h&&(o=o.indexOf('"')>=0?'"'+o.replace(/"/,'""')+'"':'"'+o+'"'),l+=o;return l},r.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(e){return!1}},r.RecalcData=function(){this.inrecalc=!0,this.celllist=[],this.celllistitem=0,this.calclist=null,this.calclistlength=0,this.firstcalc=null,this.lastcalc=null,this.nextcalc=null,this.count=0,this.checkinfo={}},r.RecalcCheckInfo=function(){this.oldcoord=null,this.parsepos=0,this.inrange=!1,this.inrangestart=!1,this.cr1=null,this.cr2=null,this.c1=null,this.c2=null,this.r1=null,this.r2=null,this.c=null,this.r=null},r.RecalcSheet=function(e){var t=r.RecalcInfo;return t.currentState!=t.state.idle?void t.queue.push(e):(delete e.attribs.circularreferencecell,r.Formula.FreshnessInfoReset(),r.RecalcClearTimeout(),t.sheet=e,t.currentState=t.state.start_calc,t.starttime=new Date,e.statuscallback&&e.statuscallback(t,"calcstart",null,e.statuscallbackparams),void r.RecalcSetTimeout())},r.RecalcSetTimeout=function(){var e=r.RecalcInfo;e.recalctimer=n.setTimeout(r.RecalcTimerRoutine,e.timeslicedelay)},r.RecalcClearTimeout=function(){var e=r.RecalcInfo;e.recalctimer&&(n.clearTimeout(e.recalctimer),e.recalctimer=null)},r.RecalcLoadedSheet=function(e,t,n,o){var s,a=r.RecalcInfo,i=r.Formula;s=r.Formula.AddSheetToCache(e||i.SheetCache.waitingForLoading,t,o),n&&s&&"off"!=s.attribs.recalc&&(s.previousrecalcsheet=a.sheet,a.sheet=s,a.currentState=a.state.start_calc),i.SheetCache.waitingForLoading=null,r.RecalcSetTimeout()},r.RecalcTimerRoutine=function(){var e,t,n,o,s,a=new Date,i=0,l=r.Formula;if(!l)return"Need SocialCalc.Formula";var u=r.RecalcInfo,c=u.sheet;if(c){var d=c.recalcdata||(c.recalcdata={}),p=function(e,t){c.statuscallback&&c.statuscallback(d,e,t,c.statuscallbackparams)};if(r.RecalcClearTimeout(),u.currentState==u.state.start_calc){d=new r.RecalcData,c.recalcdata=d;for(n in c.cells)n&&d.celllist.push(n);d.calclist={},u.currentState=u.state.order}if(u.currentState==u.state.order){for(;d.celllistitem<d.celllist.length;)if(n=d.celllist[d.celllistitem++],o=r.RecalcCheckCell(c,n),new Date-a>=u.maxtimeslice)return p("calcorder",{coord:n,total:d.celllist.length,count:d.celllistitem}),void r.RecalcSetTimeout();return p("calccheckdone",d.calclistlength),d.nextcalc=d.firstcalc,u.currentState=u.state.calc,void r.RecalcSetTimeout()}if(u.currentState==u.state.start_wait){if(u.currentState=u.state.done_wait,u.LoadSheet&&(s=u.LoadSheet(l.SheetCache.waitingForLoading)))return;return void r.RecalcLoadedSheet(null,"",!1)}if(u.currentState==u.state.done_wait)return u.currentState=u.state.calc,void r.RecalcSetTimeout();for(u.currentState!=u.state.calc&&alert("Recalc state error: "+u.currentState+". Error in SocialCalc code."),n=c.recalcdata.nextcalc;n;){if(t=c.cells[n],e=l.evaluate_parsed_formula(t.parseinfo,c,!1),l.SheetCache.waitingForLoading)return d.nextcalc=n,d.count+=i,p("calcloading",{sheetname:l.SheetCache.waitingForLoading}),u.currentState=u.state.start_wait,void r.RecalcSetTimeout();if(l.RemoteFunctionInfo.waitingForServer)return d.nextcalc=n,d.count+=i,p("calcserverfunc",{funcname:l.RemoteFunctionInfo.waitingForServer,coord:n,total:d.calclistlength,count:d.count}),void(u.currentState=u.state.done_wait);if((t.datavalue!=e.value||t.valuetype!=e.type)&&(t.datavalue=e.value,t.valuetype=e.type,delete t.displaystring,c.recalcchangedavalue=!0),e.error&&(t.errors=e.error),i++,n=c.recalcdata.calclist[n],new Date-a>=u.maxtimeslice)return d.nextcalc=n,d.count+=i,p("calcstep",{coord:n,total:d.calclistlength,count:d.count}),void r.RecalcSetTimeout()}if(d.inrecalc=!1,delete c.recalcdata,delete c.attribs.needsrecalc,u.sheet=c.previousrecalcsheet||null,u.sheet)return u.currentState=u.state.calc,void r.RecalcSetTimeout();l.FreshnessInfo.recalc_completed=!0,u.currentState=u.state.idle,p("calcfinished",new Date-u.starttime),u.queue.length>0&&(c=u.queue.shift(),c.RecalcSheet())}},r.RecalcCheckCell=function(e,t){var n,o,s,a,i,l,u,c,d,p,h=r.Formula;if(!h)return"Need SocialCalc.Formula";var f=h.TokenType,m=f.op,y=f.name,v=f.coord,g=e.recalcdata,b=g.checkinfo,_=!1,C=null,x=t;e:for(;x;)if(d=e.cells[x],p=b[x],!d||"f"!=d.datatype||p&&"object"!=typeof p)x=C,b[x]&&(C=b[x].oldcoord);else{for(p||(p=new r.RecalcCheckInfo,b[x]=p),d.errors&&delete d.errors,d.parseinfo||(d.parseinfo=h.ParseFormulaIntoTokens(d.formula)),n=d.parseinfo,a=p.parsepos;a<n.length;a++){if(p.inrange){if(p.inrangestart&&(p.cr1.col>p.cr2.col?(p.c1=p.cr2.col,p.c2=p.cr1.col):(p.c1=p.cr1.col,p.c2=p.cr2.col),p.c=p.c1-1,p.cr1.row>p.cr2.row?(p.r1=p.cr2.row,p.r2=p.cr1.row):(p.r1=p.cr1.row,p.r2=p.cr2.row),p.r=p.r1,p.inrangestart=!1),p.c+=1,p.c>p.c2){if(p.r+=1,p.r>p.r2){p.inrange=!1;continue}p.c=p.c1}if(i=r.crToCoord(p.c,p.r),p.parsepos=a,p.oldcoord=C,C=x,x=i,b[x]&&"object"==typeof b[x])return d.errors=r.Constants.s_caccCircRef+t,b[t]=!0,g.firstcalc?g.calclist[g.lastcalc]=t:g.firstcalc=t,g.lastcalc=t,g.calclistlength++,e.attribs.circularreferencecell=x+"|"+C,d.errors;continue e}if(s=n[a].type,o=n[a].text,s==m&&("!"==o?_=!0:":"!=o&&(_=!1)),s==y)if(l=h.LookupName(e,o),"range"==l.type){if(u=l.value.indexOf("|"),-1!=u){p.cr1=r.coordToCr(l.value.substring(0,u)),c=l.value.indexOf("|",u+1),p.cr2=r.coordToCr(l.value.substring(u+1,c)),p.inrange=!0,p.inrangestart=!0,a-=1;continue}}else"coord"==l.type&&(s=v,o=l.value);if(s==v){if(a>=2&&n[a-1].type==m&&":"==n[a-1].text&&n[a-2].type==v&&!_){p.cr1=r.coordToCr(n[a-2].text),p.cr2=r.coordToCr(o),p.inrange=!0,p.inrangestart=!0,a-=1;continue}if(!_){if(-1!=o.indexOf("$")&&(o=o.replace(/\$/g,"")),p.parsepos=a+1,p.oldcoord=C,C=x,x=o,b[x]&&"object"==typeof b[x])return d.errors=r.Constants.s_caccCircRef+t,b[t]=!0,g.firstcalc?g.calclist[g.lastcalc]=t:g.firstcalc=t,g.lastcalc=t,g.calclistlength++,e.attribs.circularreferencecell=x+"|"+C,d.errors;continue e}}}_=!1,b[x]=!0,g.firstcalc?g.calclist[g.lastcalc]=x:g.firstcalc=x,g.lastcalc=x,g.calclistlength++,x=C,C=b[x]?b[x].oldcoord:null}return""},r.Parse=function(e){this.str=e,this.pos=0,this.delimiter=" ",this.lineEnd=e.indexOf("\n"),this.lineEnd<0&&(this.lineEnd=e.length)},r.Parse.prototype.NextToken=function(){if(this.pos<0)return"";var e=this.str.indexOf(this.delimiter,this.pos),t=this.pos;return e>this.lineEnd&&(e=this.lineEnd),e>=0?(this.pos=e+1,this.str.substring(t,e)):(this.pos=this.lineEnd,this.str.substring(t,this.lineEnd))},r.Parse.prototype.RestOfString=function(){var e=this.pos;return this.pos<0||this.pos>=this.lineEnd?"":(this.pos=this.lineEnd,this.str.substring(e,this.lineEnd))},r.Parse.prototype.RestOfStringNoMove=function(){return this.pos<0||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)},r.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1,this.lineEnd=this.str.indexOf("\n",this.pos),this.lineEnd<0&&(this.lineEnd=this.str.length)},r.Parse.prototype.EOF=function(){return this.pos<0||this.pos>=this.str.length?!0:!1},r.UndoStack=function(){this.stack=[],this.tos=-1,this.maxRedo=0,this.maxUndo=50},r.UndoStack.prototype.PushChange=function(e){for(;this.stack.length>0&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:e,undo:[]}),this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift(),this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]),this.tos=this.stack.length-1},r.UndoStack.prototype.AddDo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var r=e.join(" ");this.stack[this.stack.length-1].command.push(r)}},r.UndoStack.prototype.AddUndo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var r=e.join(" ");this.stack[this.stack.length-1].undo.push(r)}},r.UndoStack.prototype.TOS=function(){return this.tos>=0?this.stack[this.tos]:null},r.UndoStack.prototype.Undo=function(){return this.tos>=0&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)?(this.tos-=1,!0):!1},r.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1?(this.tos+=1,!0):!1},r.Clipboard={clipboard:""},r.RenderContext=function(e){var t=e.attribs,n=r.Constants;if(this.sheetobj=e,this.hideRowsCols=!1,this.showGrid=!1,this.showRCHeaders=!1,this.rownamewidth=n.defaultRowNameWidth,this.pixelsPerRow=n.defaultAssumedRowHeight,this.cellskip={},this.coordToCR={},this.colwidth=[],this.totalwidth=0,this.rowpanes=[],this.colpanes=[],this.colunhideleft=[],this.colunhideright=[],this.rowunhidetop=[],this.rowunhidebottom=[],this.maxcol=0,this.maxrow=0,this.highlights={},this.cursorsuffix="",this.highlightTypes={cursor:{style:n.defaultHighlightTypeCursorStyle,className:n.defaultHighlightTypeCursorClass},range:{style:n.defaultHighlightTypeRangeStyle,className:n.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+n.defaultImagePrefix+"cursorinsertup.gif);",className:n.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+n.defaultImagePrefix+"cursorinsertleft.gif);",className:n.defaultHighlightTypeCursorClass},range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+n.defaultImagePrefix+"range2.gif);",className:""}},this.cellIDprefix=n.defaultCellIDPrefix,this.defaultlinkstyle=null,this.defaultHTMLlinkstyle={type:"html"},this.defaultfontstyle=n.defaultCellFontStyle,this.defaultfontsize=n.defaultCellFontSize,this.defaultfontfamily=n.defaultCellFontFamily,this.defaultlayout=n.defaultCellLayout,this.defaultpanedividerwidth=n.defaultPaneDividerWidth,this.defaultpanedividerheight=n.defaultPaneDividerHeight,this.gridCSS=n.defaultGridCSS,this.commentClassName=n.defaultCommentClass,this.commentCSS=n.defaultCommentStyle,this.commentNoGridClassName=n.defaultCommentNoGridClass,this.commentNoGridCSS=n.defaultCommentNoGridStyle,this.readonlyClassName=n.defaultReadonlyClass,this.readonlyCSS=n.defaultReadonlyStyle,this.readonlyNoGridClassName=n.defaultReadonlyNoGridClass,this.readonlyNoGridCSS=n.defaultReadonlyNoGridStyle,this.readonlyComment=n.defaultReadonlyComment,this.classnames={colname:n.defaultColnameClass,rowname:n.defaultRownameClass,selectedcolname:n.defaultSelectedColnameClass,selectedrowname:n.defaultSelectedRownameClass,upperleft:n.defaultUpperLeftClass,skippedcell:n.defaultSkippedCellClass,panedivider:n.defaultPaneDividerClass,unhideleft:n.defaultUnhideLeftClass,unhideright:n.defaultUnhideRightClass,unhidetop:n.defaultUnhideTopClass,unhidebottom:n.defaultUnhideBottomClass},this.explicitStyles={colname:n.defaultColnameStyle,rowname:n.defaultRownameStyle,selectedcolname:n.defaultSelectedColnameStyle,selectedrowname:n.defaultSelectedRownameStyle,upperleft:n.defaultUpperLeftStyle,skippedcell:n.defaultSkippedCellStyle,panedivider:n.defaultPaneDividerStyle,unhideleft:n.defaultUnhideLeftStyle,unhideright:n.defaultUnhideRightStyle,unhidetop:n.defaultUnhideTopStyle,unhidebottom:n.defaultUnhideBottomStyle},this.cellskip=null,this.needcellskip=!0,this.fonts=[],this.layouts=[],this.needprecompute=!0,!t)throw n.s_rcMissingSheet;this.rowpanes[0]={first:1,last:t.lastrow},this.colpanes[0]={first:1,last:t.lastcol},this.usermaxcol=t.usermaxcol,this.usermaxrow=t.usermaxrow},r.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){r.PrecomputeSheetFontsAndLayouts(this)},r.RenderContext.prototype.CalculateCellSkipData=function(){r.CalculateCellSkipData(this)},r.RenderContext.prototype.CalculateColWidthData=function(){r.CalculateColWidthData(this)},r.RenderContext.prototype.SetRowPaneFirstLast=function(e,t,r){this.rowpanes[e]={first:t,last:r}},r.RenderContext.prototype.SetColPaneFirstLast=function(e,t,r){this.colpanes[e]={first:t,last:r}},r.RenderContext.prototype.CoordInPane=function(e,t,n){return r.CoordInPane(this,e,t,n)},r.RenderContext.prototype.CellInPane=function(e,t,n,o){return r.CellInPane(this,e,t,n,o)},r.RenderContext.prototype.InitializeTable=function(e){r.InitializeTable(this,e)},r.RenderContext.prototype.RenderSheet=function(e,t){return r.RenderSheet(this,e,t)},r.RenderContext.prototype.RenderColGroup=function(){return r.RenderColGroup(this)},r.RenderContext.prototype.RenderColHeaders=function(){return r.RenderColHeaders(this)},r.RenderContext.prototype.RenderSizingRow=function(){return r.RenderSizingRow(this)},r.RenderContext.prototype.RenderRow=function(e,t,n){return r.RenderRow(this,e,t,n)},r.RenderContext.prototype.RenderSpacingRow=function(){return r.RenderSpacingRow(this)},r.RenderContext.prototype.RenderCell=function(e,t,n,o,s,a){return r.RenderCell(this,e,t,n,o,s,a)},r.PrecomputeSheetFontsAndLayouts=function(e){var t,n,o,s,a,i,l,u,c=e.sheetobj,d=c.attribs;for(d.defaultfont&&(t=c.fonts[d.defaultfont],t=t.replace(/^\*/,r.Constants.defaultCellFontStyle),t=t.replace(/(.+)\*(.+)/,"$1"+r.Constants.defaultCellFontSize+"$2"),t=t.replace(/\*$/,r.Constants.defaultCellFontFamily),n=t.match(/^(\S+? \S+?) (\S+?) (\S.*)$/),e.defaultfontstyle=n[1],e.defaultfontsize=n[2],e.defaultfontfamily=n[3]),i=1;i<c.fonts.length;i++)l=c.fonts[i],l=l.replace(/^\*/,e.defaultfontstyle),l=l.replace(/(.+)\*(.+)/,"$1"+e.defaultfontsize+"$2"),l=l.replace(/\*$/,e.defaultfontfamily),n=l.match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/),e.fonts[i]={style:n[1],weight:n[2],size:n[3],family:n[4]};for(o=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/,s=r.Constants.defaultCellLayout.match(o),a=d.defaultlayout?c.layouts[d.defaultlayout].match(o):["","*","*","*","*","*"],i=1;i<c.layouts.length;i++){for(l=c.layouts[i],n=l.match(o),u=1;5>=u;u++)"*"==n[u]&&(n[u]="*"!=a[u]?a[u]:s[u]);e.layouts[i]="padding:"+n[1]+" "+n[2]+" "+n[3]+" "+n[4]+";vertical-align:"+n[5]+";"}e.needprecompute=!1},r.CalculateCellSkipData=function(e){var t,n,o,s,a,i,l,u,c,d=e.sheetobj;d.rowattribs,d.colattribs;for(e.maxrow=0,e.maxcol=0,e.cellskip={},t=1;t<=d.attribs.lastrow;t++)for(n=1;n<=d.attribs.lastcol;n++)if(o=r.crToCoord(n,t),s=d.cells[o],void 0!==s&&!e.cellskip[o]&&(a=s.colspan||1,i=s.rowspan||1,a>1||i>1))for(l=t;t+i>l;l++)for(u=n;n+a>u;u++)c=r.crToCoord(u,l),c==o?e.coordToCR[o]={row:t,col:n}:e.cellskip[c]=o,l>e.maxrow&&(maxrow=l),u>e.maxcol&&(maxcol=u);e.needcellskip=!1},r.CalculateColWidthData=function(e){var t,n,o,s,a=e.sheetobj;a.colattribs;for(s=e.showRCHeaders?e.rownamewidth-0:0,colpane=0;colpane<e.colpanes.length;colpane++)for(t=e.colpanes[colpane].first;t<=e.colpanes[colpane].last;t++)n=r.rcColname(t),"yes"==a.colattribs.hide[n]?e.colwidth[t]=0:(o=a.colattribs.width[n]||a.attribs.defaultcolwidth||r.Constants.defaultColWidth,("blank"==o||"auto"==o)&&(o=""),e.colwidth[t]=o+"",s+=o&&o-0>0?o-0:10);e.totalwidth=s},r.InitializeTable=function(e,t){t.style.borderCollapse="collapse",t.cellSpacing="0",t.cellPadding="0",t.style.width=e.totalwidth+"px"},r.RenderSheet=function(e,t,r){var n,o,s,a,i,l;for(e.sheetobj.changedrendervalues&&(e.needcellskip=!0,e.needprecompute=!0,e.sheetobj.changedrendervalues=!1),e.needcellskip&&e.CalculateCellSkipData(),e.needprecompute&&e.PrecomputeSheetFontsAndLayouts(),e.CalculateColWidthData(),s=document.createElement("table"),e.InitializeTable(s),a=e.RenderColGroup(),s.appendChild(a),i=document.createElement("tbody"),i.appendChild(e.RenderSizingRow()),e.showRCHeaders&&(n=e.RenderColHeaders(),n&&i.appendChild(n)),o=0;o<e.rowpanes.length;o++){
for(rownum=e.rowpanes[o].first;rownum<=e.rowpanes[o].last;rownum++)n=e.RenderRow(rownum,o,r),i.appendChild(n);o<e.rowpanes.length-1&&(n=e.RenderSpacingRow(),i.appendChild(n))}return s.appendChild(i),t&&(l=t.parentNode,l&&l.replaceChild(s,t)),s},r.RenderRow=function(e,t,r,n){var o,s,a,i,l=e.sheetobj,u=document.createElement("tr");if(e.showRCHeaders){if(s=document.createElement("td"),e.classnames&&(s.className=e.classnames.rowname),e.explicitStyles&&(s.style.cssText=e.explicitStyles.rowname),s.width=e.rownamewidth,s.style.verticalAlign="top",s.innerHTML=t+"",t<e.rowpanes[e.rowpanes.length-1].last&&"yes"==l.rowattribs.hide[t+1]){var c=document.createElement("div");c.style.position="relative";var d=document.createElement("div");e.classnames&&(d.className=e.classnames.unhidetop),e.explicitStyles&&(d.style.cssText=e.explicitStyles.unhidetop),e.rowunhidetop[t]=d,c.appendChild(d),s.appendChild(c)}if(t>1&&"yes"==l.rowattribs.hide[t-1]){var d=document.createElement("div");e.classnames&&(d.className=e.classnames.unhidebottom),e.explicitStyles&&(d.style.cssText=e.explicitStyles.unhidebottom),e.rowunhidebottom[t]=d,s.appendChild(d)}u.appendChild(s)}for(a=0;a<e.colpanes.length;a++){for(o=e.colpanes[a].first;o<=e.colpanes[a].last;o++)s=e.RenderCell(t,o,r,a,null,n),s&&u.appendChild(s);a<e.colpanes.length-1&&(s=document.createElement("td"),s.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(s.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(s.style.cssText=e.explicitStyles.panedivider),i=document.createElement("div"),i.style.width=e.defaultpanedividerwidth+"px",i.style.overflow="hidden",s.appendChild(i),u.appendChild(s))}return"yes"==l.rowattribs.hide[t]&&(u.style.cssText+=";display:none"),u},r.RenderSpacingRow=function(e){var t,r,n,o,s=(e.sheetobj,document.createElement("tr"));for(e.showRCHeaders&&(r=document.createElement("td"),r.width=e.rownamewidth,r.height=e.defaultpanedividerheight,e.classnames.panedivider&&(r.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(r.style.cssText=e.explicitStyles.panedivider),s.appendChild(r)),n=0;n<e.colpanes.length;n++){for(t=e.colpanes[n].first;t<=e.colpanes[n].last;t++)r=document.createElement("td"),o=e.colwidth[t],o&&(r.width=o),r.height=e.defaultpanedividerheight,e.classnames.panedivider&&(r.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(r.style.cssText=e.explicitStyles.panedivider),r&&s.appendChild(r);n<e.colpanes.length-1&&(r=document.createElement("td"),r.width=e.defaultpanedividerwidth,r.height=e.defaultpanedividerheight,e.classnames.panedivider&&(r.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(r.style.cssText=e.explicitStyles.panedivider),s.appendChild(r))}return s},r.RenderColHeaders=function(e){var t,n,o=e.sheetobj,s=document.createElement("tr");if(!e.showRCHeaders)return null;for(n=document.createElement("td"),e.classnames&&(n.className=e.classnames.upperleft),e.explicitStyles&&(n.style.cssText=e.explicitStyles.upperleft),n.width=e.rownamewidth,s.appendChild(n),colpane=0;colpane<e.colpanes.length;colpane++){for(t=e.colpanes[colpane].first;t<=e.colpanes[colpane].last;t++){if(n=document.createElement("td"),e.classnames&&(n.className=e.classnames.colname),e.explicitStyles&&(n.style.cssText=e.explicitStyles.colname),"yes"==o.colattribs.hide[r.rcColname(t)]&&(n.style.cssText+=";display:none"),n.innerHTML=r.rcColname(t),t<e.colpanes[e.colpanes.length-1].last&&"yes"==o.colattribs.hide[r.rcColname(t+1)]){var a=document.createElement("div");e.classnames&&(a.className=e.classnames.unhideleft),e.explicitStyles&&(a.style.cssText=e.explicitStyles.unhideleft),e.colunhideleft[t]=a,n.appendChild(a)}t>1&&"yes"==o.colattribs.hide[r.rcColname(t-1)]&&(a=document.createElement("div"),e.classnames&&(a.className=e.classnames.unhideright),e.explicitStyles&&(a.style.cssText=e.explicitStyles.unhideright),e.colunhideright[t]=a,n.appendChild(a)),s.appendChild(n)}colpane<e.colpanes.length-1&&(n=document.createElement("td"),n.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(n.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(n.style.cssText=e.explicitStyles.panedivider),s.appendChild(n))}return s},r.RenderColGroup=function(e){var t,n,o,s,a=e.sheetobj,i=document.createElement("colgroup");for(e.showRCHeaders&&(o=document.createElement("col"),o.width=e.rownamewidth,i.appendChild(o)),t=0;t<e.colpanes.length;t++){for(n=e.colpanes[t].first;n<=e.colpanes[t].last;n++)o=document.createElement("col"),"yes"==a.colattribs.hide[r.rcColname(n)]?o.width="1":(s=e.colwidth[n],s&&(o.width=s),i.appendChild(o));t<e.colpanes.length-1&&(o=document.createElement("col"),o.width=e.defaultpanedividerwidth,i.appendChild(o))}return i},r.RenderSizingRow=function(e){var t,n,o,s,a=e.sheetobj,i=document.createElement("tr");for(e.showRCHeaders&&(o=document.createElement("td"),o.style.width=e.rownamewidth+"px",o.height="1",i.appendChild(o)),t=0;t<e.colpanes.length;t++){for(n=e.colpanes[t].first;n<=e.colpanes[t].last;n++)o=document.createElement("td"),"yes"==a.colattribs.hide[r.rcColname(n)]?o.width="1":(s=e.colwidth[n],s&&(o.width=s)),o.height="1",i.appendChild(o);t<e.colpanes.length-1&&(o=document.createElement("td"),o.width=e.defaultpanedividerwidth,o.height="1",i.appendChild(o))}return i},r.RenderCell=function(e,t,n,o,s,a,i){var l,u,c,d,p,h,f,m=e.sheetobj,y="";t-=0,n-=0;var v=r.crToCoord(n,t);if(e.cellskip[v])return e.CoordInPane(e.cellskip[v],o,s)?null:(c=a?r.CreatePseudoElement():document.createElement("td"),e.classnames.skippedcell&&(c.className=e.classnames.skippedcell),e.explicitStyles.skippedcell&&(c.style.cssText=e.explicitStyles.skippedcell),c.innerHTML="&nbsp;",c);if(c=a?r.CreatePseudoElement():document.createElement("td"),e.cellIDprefix&&(c.id=e.cellIDprefix+v),p=m.cells[v],p||(p=new r.Cell(v)),f=m.attribs,scc=r.Constants,p.colspan>1){for(d=1,l=1;l<p.colspan;l++)"yes"!=m.colattribs.hide[r.rcColname(n+l)]&&e.CellInPane(t,n+l,o,s)&&d++;c.colSpan=d}if(p.rowspan>1){for(d=1,l=1;l<p.rowspan;l++)"yes"!=m.rowattribs.hide[t+l+""]&&e.CellInPane(t+l,n,o,s)&&d++;c.rowSpan=d}return void 0==p.displaystring&&(p.displaystring=r.FormatValueForDisplay(m,p.datavalue,v,i||e.defaultlinkstyle)),c.innerHTML=p.displaystring,l=p.layout||f.defaultlayout,y+=l&&"undefined"!=typeof e.layouts[l]?e.layouts[l]:scc.defaultCellLayout,l=p.font||f.defaultfont,l&&"undefined"!=typeof e.fonts[l]?(u=e.fonts[l],y+="font-style:"+u.style+";font-weight:"+u.weight+";font-size:"+u.size+";font-family:"+u.family+";"):(scc.defaultCellFontSize&&(y+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(y+="font-family:"+scc.defaultCellFontFamily+";")),l=p.color||f.defaultcolor,l&&"undefined"!=typeof m.colors[l]&&(y+="color:"+m.colors[l]+";"),l=p.bgcolor||f.defaultbgcolor,l&&"undefined"!=typeof m.colors[l]&&(y+="background-color:"+m.colors[l]+";"),l=p.cellformat,l&&"undefined"!=typeof m.cellformats[l]?y+="text-align:"+m.cellformats[l]+";":(u=p.valuetype.charAt(0),"t"==u?(l=f.defaulttextformat,l&&"undefined"!=typeof m.cellformats[l]&&(y+="text-align:"+m.cellformats[l]+";")):"n"==u?(l=f.defaultnontextformat,y+=l&&"undefined"!=typeof m.cellformats[l]?"text-align:"+m.cellformats[l]+";":"text-align:right;"):y+="text-align:left;"),(p.colspan>1||p.rowspan>1)&&(h=m.cells[r.crToCoord(n+(p.colspan||1)-1,t+(p.rowspan||1)-1)]),l=p.bt,l&&"undefined"!=typeof m.borderstyles[l]&&(y+="border-top:"+m.borderstyles[l]+";"),l="undefined"!=typeof h?h.br:p.br,l&&"undefined"!=typeof m.borderstyles[l]?y+="border-right:"+m.borderstyles[l]+";":e.showGrid&&(u=e.CellInPane(t,n+(p.colspan||1),o,s)?r.crToCoord(n+(p.colspan||1),t):"nomatch",e.cellskip[u]&&(u=e.cellskip[u]),m.cells[u]&&m.cells[u].bl||(y+="border-right:"+e.gridCSS)),l="undefined"!=typeof h?h.bb:p.bb,l&&"undefined"!=typeof m.borderstyles[l]?y+="border-bottom:"+m.borderstyles[l]+";":e.showGrid&&(u=e.CellInPane(t+(p.rowspan||1),n,o,s)?r.crToCoord(n,t+(p.rowspan||1)):"nomatch",e.cellskip[u]&&(u=e.cellskip[u]),m.cells[u]&&m.cells[u].bt||(y+="border-bottom:"+e.gridCSS)),l=p.bl,l&&"undefined"!=typeof m.borderstyles[l]&&(y+="border-left:"+m.borderstyles[l]+";"),p.comment&&(c.title=p.comment,e.showGrid?(e.commentClassName&&(c.className=(c.className?c.className+" ":"")+e.commentClassName),y+=e.commentCSS):(e.commentNoGridClassName&&(c.className=(c.className?c.className+" ":"")+e.commentNoGridClassName),y+=e.commentNoGridCSS)),p.readonly&&(p.comment||(c.title=e.readonlyComment),e.showGrid?(e.readonlyClassName&&(c.className=(c.className?c.className+" ":"")+e.readonlyClassName),y+=e.readonlyCSS):(e.readonlyNoGridClassName&&(c.className=(c.className?c.className+" ":"")+e.readonlyNoGridClassName),y+=e.readonlyNoGridCSS)),c.style.cssText=y,u=e.highlights[v],u&&("cursor"==u&&(u+=e.cursorsuffix),e.highlightTypes[u].className&&(c.className=(c.className?c.className+" ":"")+e.highlightTypes[u].className),r.setStyles(c,e.highlightTypes[u].style)),"yes"==m.colattribs.hide[r.rcColname(n)]&&(c.style.cssText+=";display:none"),"yes"==m.rowattribs.hide[t]&&(c.style.cssText+=";display:none"),c},r.CoordInPane=function(e,t,r,n){var o=e.coordToCR[t];if(!o||!o.row||!o.col)throw"Bad coordToCR for "+t;return e.CellInPane(o.row,o.col,r,n)},r.CellInPane=function(e,t,r,n,o){var s=e.rowpanes[n],a=e.colpanes[o];if(!s||!a)throw"CellInPane called with unknown panes "+n+"/"+o;return t<s.first||t>s.last?!1:r<a.first||r>a.last?!1:!0},r.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}},r.rcColname=function(e){e>702&&(e=702),1>e&&(e=1);var t=(e-1)%26+65,r=Math.floor((e-1)/26);return r?String.fromCharCode(r+64)+String.fromCharCode(t):String.fromCharCode(t)},r.letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r.crToCoord=function(e,t){var n;1>e&&(e=1),e>702&&(e=702),1>t&&(t=1);var o=(e-1)%26,s=Math.floor((e-1)/26);return n=s?r.letters[s-1]+r.letters[o]+t:r.letters[o]+t},r.coordToCol={},r.coordToRow={},r.coordToCr=function(e){var t,n,o,s=r.coordToRow[e];if(s)return{row:s,col:r.coordToCol[e]};for(t=0,s=0,n=0;n<e.length;n++)o=e.charCodeAt(n),36==o||(57>=o?s=10*s+o-48:o>=97?t=26*t+o-96:o>=65&&(t=26*t+o-64));return r.coordToCol[e]=t,r.coordToRow[e]=s,{row:s,col:t}},r.ParseRange=function(e){var t,n,o,s;return e||(e="A1:A1"),e=e.toUpperCase(),t=e.indexOf(":"),t>=0?(n=e.substring(0,t),o=r.coordToCr(n),o.coord=n,n=e.substring(t+1),s=r.coordToCr(n),s.coord=n):(o=r.coordToCr(e),o.coord=e,s=r.coordToCr(e),s.coord=e),{cr1:o,cr2:s}},r.decodeFromSave=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t.replace(/\\b/g,"\\")},r.decodeFromAjax=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t=t.replace(/\\e/g,"]]"),t.replace(/\\b/g,"\\")},r.encodeForSave=function(e){return"string"!=typeof e?e:(-1!=e.indexOf("\\")&&(e=e.replace(/\\/g,"\\b")),-1!=e.indexOf(":")&&(e=e.replace(/:/g,"\\c")),-1!=e.indexOf("\n")&&(e=e.replace(/\n/g,"\\n")),e)},r.special_chars=function(e){return/[&<>"]/.test(e)&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;")),e},r.Lookup=function(e,t){for(i=0;i<t.length;i++)if(t[i]>e)return i>0?i-1:null;return t.length-1},r.setStyles=function(e,t){var r,n,o,s,a;if(t)for(r=t.split(";"),n=0;n<r.length;n++)o=r[n].indexOf(":"),-1!=o&&(s=r[n].substring(0,o),a=r[n].substring(o+1),s&&a&&(e.style[s]=a))},r.GetViewportInfo=function(){var e={};return n.innerWidth?(e.width=n.innerWidth,e.height=n.innerHeight,e.horizontalScroll=n.pageXOffset,e.verticalScroll=n.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight,e.horizontalScroll=document.documentElement.scrollLeft,e.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(e.width=document.body.clientWidth,e.height=document.body.clientHeight,e.horizontalScroll=document.body.scrollLeft,e.verticalScroll=document.body.scrollTop),e},r.GetElementPosition=function(e){for(var t=0,n=0;e&&"relative"!=r.GetComputedStyle(e,"position");)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},r.GetElementPositionWithScroll=function(e){var t=e.getBoundingClientRect();return{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width?t.width:t.right-t.left,height:t.height?t.height:t.bottom-t.top}},r.GetElementFixedParent=function(e){for(;e&&"HTML"!=e.tagName;){if("fixed"==r.GetComputedStyle(e,"position"))return e;e=e.parentNode}return!1},r.GetComputedStyle=function(e,t){var r;return r="undefined"!=typeof e.currentStyle?e.currentStyle:document.defaultView.getComputedStyle(e,null),r[t]},r.LookupElement=function(e,t){var r;for(r=0;r<t.length;r++)if(t[r].element==e)return t[r];return null},r.AssignID=function(e,t,r){e.idPrefix&&(t.id=e.idPrefix+r)},r.GetCellContents=function(e,t){var r="",n=e.cells[t];if(n)switch(n.datatype){case"v":r=n.datavalue+"";break;case"t":r="'"+n.datavalue;break;case"f":r="="+n.formula;break;case"c":r=n.formula}return r},r.FormatValueForDisplay=function(e,t,n,o){var s,a,i,l,u=e.attribs,c=(r.Constants,e.cells[n]);if(c||(c=new r.Cell(n)),l=t,a=c.valuetype||"",i=a.substring(1),a=a.charAt(0),c.errors||"e"==a)return l=c.errors||i||"Error in cell";if("t"==a){if(s=e.valueformats[c.textvalueformat-0]||e.valueformats[u.defaulttextvalueformat-0]||"","formula"==s)return l="f"==c.datatype?r.special_chars("="+c.formula)||"&nbsp;":"c"==c.datatype?r.special_chars("'"+c.formula)||"&nbsp;":r.special_chars("'"+l)||"&nbsp;";l=r.format_text_for_display(l,c.valuetype,s,e,o,c.nontextvalueformat)}else if("n"==a){if(s=c.nontextvalueformat,(null==s||""==s)&&(s=u.defaultnontextvalueformat),s=e.valueformats[s-0],(null==s||"none"==s)&&(s=""),"formula"==s)return l="f"==c.datatype?r.special_chars("="+c.formula)||"&nbsp;":"c"==c.datatype?r.special_chars("'"+c.formula)||"&nbsp;":r.special_chars("'"+l)||"&nbsp;";if("forcetext"==s)return l="f"==c.datatype?r.special_chars("="+c.formula)||"&nbsp;":"c"==c.datatype?r.special_chars(c.formula)||"&nbsp;":r.special_chars(l)||"&nbsp;";l=r.format_number_for_display(l,c.valuetype,s)}else l="&nbsp;";return l},r.format_text_for_display=function(e,t,n,o,s,a){var n,i,l,u,c,d;return i=t.substring(1),d=e,("none"==n||null==n)&&(n=""),/^(text-|custom|hidden)/.test(n)||(n=""),(""==n||"General"==n)&&("h"==i&&(n="text-html"),("w"==i||"r"==i)&&(n="text-wiki"),"l"==i&&(n="text-link"),i||(n="text-plain")),"text-html"==n||(r.Callbacks.expand_wiki&&/^text-wiki/.test(n)?d=r.Callbacks.expand_wiki(d,o,s,n):"text-wiki"==n?d=r.Callbacks.expand_markup&&r.Callbacks.expand_markup(d,o,s)||r.special_chars("wiki-text:"+d):"text-url"==n?(l=r.special_chars(d),u=encodeURI(d),d='<a href="'+u+'">'+l+"</a>"):"text-link"==n?d=r.expand_text_link(d,o,s,n):"text-image"==n?(u=encodeURI(d),d='<img src="'+u+'">'):"text-custom:"==n.substring(0,12)?(l=r.special_chars(d),l=l.replace(/  /g,"&nbsp; "),l=l.replace(/\n/g,"<br>"),u=encodeURI(d),c={},c.r=d,c.s=l,c.u=u,d=n.substring(12),d=d.replace(/@(r|s|u)/g,function(e,t){return c[t]})):"custom"==n.substring(0,6)?(d=r.special_chars(d),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"),d+=" (custom format)"):"hidden"==n?d="&nbsp;":null!=a&&""!=a&&"none"!=o.valueformats[a-0]&&""!=o.valueformats[a-0]?(n=o.valueformats[a],d=r.format_number_for_display(e,t,n)):(d=r.special_chars(d),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"))),d},r.format_number_for_display=function(e,t,n){var o,s,a=r.Constants;return o=e-0,s=t.substring(1),("Auto"==n||""==n)&&(n="%"==s?a.defaultFormatp:"$"==s?a.defaultFormatc:"dt"==s?a.defaultFormatdt:"d"==s?a.defaultFormatd:"t"==s?a.defaultFormatt:"l"==s?"logical":"General"),"logical"==n?o?a.defaultDisplayTRUE:a.defaultDisplayFALSE:"hidden"==n?"&nbsp;":r.FormatNumber.formatNumberWithFormat(e,n,"")},r.DetermineValueType=function(e){var t,n,o,s,a,i,l,u,c,d,p=e+"",h="t";return t=p.replace(/^\s+/,""),t=t.replace(/\s+$/,""),0==p.length?h="":p.match(/^\s+$/)||(t.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/)?(p=t-0,isNaN(p)?p=e+"":h="n"):t.match(/^[-+]?\d*(?:\.)?\d*\s*%$/)?(p=(t.slice(0,-1)-0)/100,h="n%"):t.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&t.match(/\d/)?(p=t.replace(/\$/,"")-0,h="n$"):t.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/)?(p=t.replace(/,/g,"")-0,h="n"):t.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/)?(p=(t.replace(/[%,]/g,"")-0)/100,h="n%"):t.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&t.match(/\d/)?(p=t.replace(/[\$,]/g,"")-0,h="n$"):(n=p.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))?(o=n[3]-0,o=1e3>o?o+2e3:o,p=r.FormatNumber.convert_date_gregorian_to_julian(o,n[1]-0,n[2]-0)-2415019,h="nd"):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))?(o=n[1]-0,o=1e3>o?o+2e3:o,p=r.FormatNumber.convert_date_gregorian_to_julian(o,n[2]-0,n[3]-0)-2415019,h="nd"):(n=p.match(/^(\d{1,2}):(\d{1,2})\s*$/))?(s=n[1]-0,a=n[2]-0,24>s&&60>a&&(p=s/24+a/1440,h="nt")):(n=p.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(s=n[1]-0,a=n[2]-0,i=n[3]-0,24>s&&60>a&&60>i&&(p=s/24+a/1440+i/86400,h="nt")):(n=p.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/))?(c=n[1]-0,u=n[2]-0,l=n[3]-0,l&&l>0&&(p=c+(0>c?-u/l:u/l),h="n")):(d=r.InputConstants[p.toUpperCase()])?(u=d.indexOf(","),p=d.substring(0,u)-0,h=d.substring(u+1)):t.length>7&&"http://"==t.substring(0,7).toLowerCase()?(p=t,h="tl"):t.match(/<([A-Z][A-Z0-9]*)\b[^>]*>[\s\S]*?<\/\1>/i)&&(p=t,h="th")),{value:p,type:h}},r.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},r.default_expand_markup=function(e,t,n){var o=e;return o=r.special_chars(o),o=o.replace(/  /g,"&nbsp; "),o=o.replace(/\n/g,"<br>")},r.expand_text_link=function(e,t,n,o){var s,a,i,l=r.Constants,u="",c=r.ParseCellLinkText(e+"");return s=c.desc?r.special_chars(c.desc):c.pagename?l.defaultPageLinkFormatString:l.defaultLinkFormatString,e.length>7&&"http://"==e.substring(0,7).toLowerCase()&&">"!=e.charAt(e.length-1)&&(s=s.substring(7)),a=c.newwin||!n?' target="_blank"':"",c.pagename?r.Callbacks.MakePageLink&&(u=r.Callbacks.MakePageLink(c.pagename,c.workspacename,n,o)):u=encodeURI(c.url),i='<a href="'+u+'"'+a+">"+s+"</a>"},r.ParseCellLinkText=function(e){var t={url:"",desc:"",newwin:!1,pagename:"",workspace:""},r=!1,n=e.length-1,o=0,s=e.lastIndexOf("<"),a=e.lastIndexOf("["),i=e.lastIndexOf("{"),l=-1;return">"==e.charAt(n)&&-1!=s||"]"==e.charAt(n)&&-1!=a||!("}"!=e.charAt(n)||"]"!=e.charAt(n-1)||-1==i||-1==a||i>a)?(">"==e.charAt(n)?(l=s-1,s>0&&"<"==e.charAt(l)&&">"==e.charAt(n-1)&&(l--,n--,t.newwin=!0)):"]"==e.charAt(n)?(l=a-1,r=!0,a>0&&"["==e.charAt(l)&&"]"==e.charAt(n-1)&&(l--,n--,t.newwin=!0)):"}"==e.charAt(n)&&(l=i-1,r=!0,wsend=a,n--,a>0&&"["==e.charAt(a-1)&&"]"==e.charAt(n-1)&&(wsend=a-1,n--,t.newwin=!0)," "==e.charAt(wsend-1)&&wsend--,t.workspace=e.substring(i+1,wsend)||"")," "==e.charAt(l)&&l--,'"'==e.charAt(o)&&'"'==e.charAt(l)&&(o++,l--)):(n++,l=n),r?t.pagename=e.substring(a+1,n)||"":t.url=e.substring(s+1,n)||"",l>=o&&(t.desc=e.substring(o,l+1)),t},r.ConvertSaveToOtherFormat=function(e,t,n){var o,s,a,i,l,u,c,d,p,h,f="";if("scsave"==t)return e;if(""==e)return"";if(o=new r.Sheet,o.ParseSheetSave(e),n)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";if(a=o.copiedfrom?r.ParseRange(o.copiedfrom):{cr1:{row:1,col:1},cr2:{row:o.attribs.lastrow,col:o.attribs.lastcol}},"html"==t)return s=new r.RenderContext(o),o.copiedfrom&&(s.rowpanes[0]={first:a.cr1.row,last:a.cr2.row},s.colpanes[0]={first:a.cr1.col,last:a.cr2.col}),i=document.createElement("div"),l=s.RenderSheet(null,s.defaultHTMLlinkstyle),i.appendChild(l),delete s,delete o,f=i.innerHTML,delete l,delete i,f;for(u=a.cr1.row;u<=a.cr2.row;u++){for(c=a.cr1.col;c<=a.cr2.col;c++)d=r.crToCoord(c,u),p=o.GetAssuredCell(d),h=p.errors?p.errors:p.datavalue+"","csv"==t?(-1!=h.indexOf('"')&&(h=h.replace(/"/g,'""')),/[, \n"]/.test(h)&&(h='"'+h+'"'),c>a.cr1.col&&(h=","+h)):"tab"==t&&(-1!=h.indexOf("\n")&&(-1!=h.indexOf('"')&&(h=h.replace(/"/g,'""')),h='"'+h+'"'),c>a.cr1.col&&(h="	"+h)),f+=h;f+="\n"}return f},r.ConvertOtherFormatToSave=function(e,t){var n,o,s,a,i,l,u,c,d,p,h,f,m="",y=function(){p++,p>f&&(f=p),h=r.crToCoord(p,d),r.SetConvertedCell(n,h,i),i=""};if("scsave"==t)return e;if(n=new r.Sheet,o=e.split(/\r\n|\n/),f=0,"csv"==t){for(d=0,l=!1,s=0;s<o.length&&(s!=o.length-1||""!=o[s]);s++)for(l?i+="\n":(i="",d++,p=0),a=o[s],u=0;u<a.length;u++)c=a.charAt(u),'"'!=c?(","!=c||l?i+=c:y(),u!=a.length-1||l||y()):l?u<a.length-1&&'"'==a.charAt(u+1)?(u++,i+='"'):(l=!1,u==a.length-1&&y()):l=!0;f>0&&(n.attribs.lastrow=d,n.attribs.lastcol=f,m=n.CreateSheetSave("A1:"+r.crToCoord(f,d)))}if("tab"==t){for(d=0,l=!1,s=0;s<o.length&&(s!=o.length-1||""!=o[s]);s++)for(l?i+="\n":(i="",d++,p=0),a=o[s],u=0;u<a.length;u++){if(c=a.charAt(u),'"'==c){if(l){u<a.length-1?'"'==a.charAt(u+1)?(u++,i+='"'):"	"==a.charAt(u+1)&&(u++,l=!1,y()):(l=!1,y());continue}if(""==i){l=!0;continue}}"	"!=c||l?i+=c:y(),u!=a.length-1||l||y()}f>0&&(n.attribs.lastrow=d,n.attribs.lastcol=f,m=n.CreateSheetSave("A1:"+r.crToCoord(f,d)))}return m},r.SetConvertedCell=function(e,t,n){var o,s;o=e.GetAssuredCell(t),s=r.DetermineValueType(n),"n"==s.type&&s.value==n?(o.datatype="v",o.valuetype="n",o.datavalue=s.value):"t"==s.type.charAt(0)?(o.datatype="t",o.valuetype=s.type,o.datavalue=s.value):(o.datatype="c",o.valuetype=s.type,o.datavalue=s.value,o.formula=n)};var r;r||(r={}),r.Formula={},r.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9},r.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7},r.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10},r.Formula.CharClassTable={" ":9,"!":3,'"':8,"'":8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5},r.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z"},r.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},r.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9},r.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"},r.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|","t*":"|t*:t|e*:2|","e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}},r.Formula.ParseFormulaIntoTokens=function(e){var t,n,o,s,a,i,l,u,c=r.Formula,d=r.Constants,p=c.ParseState,h=c.TokenType,f=c.CharClass,m=c.CharClassTable,y=c.UpperCaseTable,v=c.ParsePushToken,g=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,b=[],_="",C=0,s=!1;for(t=0;t<=e.length;t++)t<e.length?(n=e.charAt(t),o=m[n]):(n="",o=f.eof),C==p.num&&(o==f.num?_+=n:o!=f.numstart||s?"E"==n||"e"==n?(_+=n,s=!1,C=p.numexp1):(v(b,_,h.num,0),s=!1,C=0):(s=!0,_+=n)),C==p.numexp1&&(o==p.num?C=p.numexp2:"+"!=n&&"-"!=n||"E"!=y[_.charAt(_.length-1)]?"E"==n||"e"==n||(v(b,d.s_parseerrexponent,h.error,0),C=0):_+=n),C==p.numexp2&&(o==f.num?_+=n:(v(b,_,h.num,0),C=0)),C==p.alpha&&(o==f.num?C=p.coord:o==f.alpha||"."==n?_+=n:o==f.incoord?C=p.coord:o==f.op||o==f.numstart||o==f.space||o==f.eof?(v(b,_.toUpperCase(),h.name,0),C=0):(v(b,d.s_parseerrchar,h.error,0),C=0)),C==p.coord&&(o==f.num?_+=n:o==f.incoord?_+=n:o==f.alpha?C=p.alphanumeric:o==f.op||o==f.numstart||o==f.eof||o==f.space?(u=g.test(_)?h.coord:h.name,v(b,_.toUpperCase(),u,0),C=0):(v(b,d.s_parseerrchar,h.error,0),C=0)),C==p.alphanumeric&&(o==f.num||o==f.alpha?_+=n:o==f.op||o==f.numstart||o==f.space||o==f.eof?(v(b,_.toUpperCase(),h.name,0),C=0):(v(b,d.s_parseerrchar,h.error,0),C=0)),C==p.string?o==f.quote?C=p.stringquote:o==f.eof?(v(b,d.s_parseerrstring,h.error,0),C=0):_+=n:C==p.stringquote?o==f.quote?(_+=n,C=p.string):(v(b,_,h.string,0),C=0):C==p.specialvalue&&("!"==_.charAt(_.length-1)?(v(b,_,h.name,0),C=0):o==f.eof?(v(b,d.s_parseerrspecialvalue,h.error,0),C=0):_+=n),0==C&&(o==f.num?(_=n,C=p.num):o==f.numstart?(_=n,s=!0,C=p.num):o==f.alpha||o==f.incoord?(_=n,C=p.alpha):o==f.specialstart?(_=n,C=p.specialvalue):o==f.op?(_=n,b.length>0?(a=b[b.length-1],i=a.type,l=a.text,i==f.op&&("<"==l||">"==l)&&(_=l+_,b.pop(),b.length>0?(a=b[b.length-1],i=a.type,l=a.text):(i=f.eof,l="EOF"))):(i=f.eof,l="EOF"),u=h.op,0==b.length||i==f.op&&")"!=l&&"%"!=l?"-"==_?(_="M",n="M"):"+"==_?(_="P",n="P"):")"==_&&"("==l||"("!=_&&(u=h.error,_=d.s_parseerrtwoops):_.length>1&&(">="==_?(_="G",n="G"):"<="==_?(_="L",n="L"):"<>"==_?(_="N",n="N"):(u=h.error,_=d.s_parseerrtwoops)),v(b,_,u,n),C=0):o==f.quote?(_="",C=p.string):o==f.space||o==f.eof||v(b,d.s_parseerrchar,h.error,0));return b},r.Formula.ParsePushToken=function(e,t,r,n){e.push({text:t,type:r,opcode:n})},r.Formula.evaluate_parsed_formula=function(e,t,n){var o,s,a=r.Formula;a.TokenType;return s=a.ConvertInfixToPolish(e),o=a.EvaluatePolish(e,s,t,n)},r.Formula.ConvertInfixToPolish=function(e){var t,n,o,s,a,i,l=r.Formula,u=r.Constants,c=l.TokenType,d=l.TokenPrecedence,p=[],h=[],f="",m=-1;for(t=0;t<e.length;t++)if(n=e[t],o=n.type,s=n.text,o==c.num||o==c.coord||o==c.string)p.push(t);else if(o==c.name)h.push(t),p.push(m);else{if(o==c.space)continue;if(","==s){for(;h.length&&"("!=e[h[h.length-1]].text;)p.push(h.pop());if(0==h.length){f=u.s_parseerrmissingopenparen;break}}else if("("==s)h.push(t);else if(")"==s){for(;h.length&&"("!=e[h[h.length-1]].text;)p.push(h.pop());if(0==h.length){f=u.s_parseerrcloseparennoopen;break}h.pop(),h.length&&e[h[h.length-1]].type==c.name&&p.push(h.pop())}else{if(o!=c.op){if(o==c.error){f=s;break}f="Internal error while processing parsed formula. ";break}for(h.length&&e[h[h.length-1]].type==c.name&&p.push(h.pop());h.length&&e[h[h.length-1]].type==c.op&&"("!=e[h[h.length-1]].text&&(a=d[n.opcode],i=d[e[h[h.length-1]].opcode],!(a>=0&&i>a))&&!(0>a&&(a=-a,0>i&&(i=-i),i>=a));)p.push(h.pop());h.push(t)}}for(;h.length>0;){if("("==e[h[h.length-1]].text){f=u.s_parseerrmissingcloseparen;break}p.push(h.pop())}return f?f:p},r.Formula.EvaluatePolish=function(e,t,n,o){var s,a,i,l,u,c,d,p,h,f,m,y,v,g,b=r.Formula,_=r.Constants,C=b.TokenType,x=b.LookupResultType,w=b.TypeLookupTable,S=b.OperandAsNumber,k=b.OperandAsText,F=b.OperandValueAndType,T=b.OperandsAsCoordOnSheet,N=r.format_number_for_display||function(e,t,r){return e+""},A="",E=-1,L={value:"",type:"e#VALUE!",error:_.s_parseerrmissingoperand},R=[],O=function(e,t){R.push({type:e,value:t})};if(!(e.length&&t instanceof Array))return{value:"",type:"e#VALUE!",error:"string"==typeof t?t:""};for(s=0;s<t.length;s++)if(a=t[s],a!=E)if(i=e[a],l=i.type,u=i.text,l==C.num)O("n",u-0);else if(l==C.coord)O("coord",u);else if(l==C.string)O("t",u);else if(l==C.op){if(R.length<=0)return L;if("M"==u)c=S(n,R),f=x(c.type,c.type,w.unaryminus),O(f,-c.value);else if("P"==u)c=S(n,R),f=x(c.type,c.type,w.unaryplus),O(f,c.value);else if("%"==u)c=S(n,R),f=x(c.type,c.type,w.unarypercent),O(f,.01*c.value);else if("&"==u){if(R.length<=1)return L;d=k(n,R),c=k(n,R),f=x(c.type,c.type,w.concat),O(f,c.value+d.value)}else if(":"==u){if(R.length<=1)return L;c=b.OperandsAsRangeOnSheet(n,R),c.error&&(A=A||c.error),O(c.type,c.value)}else if("!"==u){if(R.length<=1)return L;c=T(n,R),c.error&&(A=A||c.error),O(c.type,c.value)}else if("<"==u||"L"==u||"="==u||"G"==u||">"==u||"N"==u){if(R.length<=1){A=_.s_parseerrmissingoperand;break}d=F(n,R),c=F(n,R),"n"==c.type.charAt(0)&&"n"==d.type.charAt(0)?(y=0,"<"==u?y=c.value<d.value?1:0:"L"==u?y=c.value<=d.value?1:0:"="==u?y=c.value==d.value?1:0:"G"==u?y=c.value>=d.value?1:0:">"==u?y=c.value>d.value?1:0:"N"==u&&(y=c.value!=d.value?1:0),O("nl",y)):"e"==c.type.charAt(0)?O(c.type,0):"e"==d.type.charAt(0)?O(d.type,0):(p=c.type.charAt(0),h=d.type.charAt(0),"n"==p?c.value=N(c.value,"n",""):"b"==p&&(c.value=""),"n"==h?d.value=N(d.value,"n",""):"b"==h&&(d.value=""),y=0,c.value=c.value.toLowerCase(),d.value=d.value.toLowerCase(),"<"==u?y=c.value<d.value?1:0:"L"==u?y=c.value<=d.value?1:0:"="==u?y=c.value==d.value?1:0:"G"==u?y=c.value>=d.value?1:0:">"==u?y=c.value>d.value?1:0:"N"==u&&(y=c.value!=d.value?1:0),O("nl",y))}else{if(R.length<=1){A=_.s_parseerrmissingoperand;break}d=S(n,R),c=S(n,R),"+"==u?(f=x(c.type,d.type,w.plus),O(f,c.value+d.value)):"-"==u?(f=x(c.type,d.type,w.plus),O(f,c.value-d.value)):"*"==u?(f=x(c.type,d.type,w.plus),O(f,c.value*d.value)):"/"==u?0!=d.value?O("n",c.value/d.value):O("e#DIV/0!",0):"^"==u&&(c.value=Math.pow(c.value,d.value),c.type="n",isNaN(c.value)&&(c.value=0,c.type="e#NUM!"),O(c.type,c.value))}}else{if(l!=C.name){A=_.s_InternalError+"Unknown token "+l+" ("+u+"). ";break}if(A=b.CalculateFunction(u,R,n))break}else O("start",0);return value=R[0]?R[0].value:"",p=R[0]?R[0].type:"","name"==p&&(c=r.Formula.LookupName(n,value),value=c.value,p=c.type,A=A||c.error),"coord"==p&&(c=F(n,R),value=c.value,p=c.type,"b"==p&&(p="n",value=0)),R.length>1&&!A&&(A+=_.s_parseerrerrorinformula),m=p,"e"==p.charAt(0)?A=A||p.substring(1)||_.s_calcerrerrorvalueinformula:"range"==p&&(v=value.match(/^(.*)\|(.*)\|/),g=v[1].indexOf("!"),g>=0?v[1]=v[1].substring(g+1)+"!"+v[1].substring(0,g).toUpperCase():v[1]=v[1].toUpperCase(),value=v[1]+":"+v[2].toUpperCase(),o||(A=_.s_formularangeresult+" "+value)),A&&"e"!=m.charAt(0)&&(value=A,m="e"),"n"!=m.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,m="e#NUM!",A=isNaN(value)?_.s_calcerrnumericnan:_.s_calcerrnumericoverflow),{value:value,type:m,error:A}},r.Formula.LookupResultType=function(e,t,r){var n,o,s,a=r[e];return a||(a=r[e.charAt(0)+"*"])?(n=a.indexOf("|"+t+":"),n>=0?(o=a.indexOf("|",n+1),0>o?"e#VALUE! (internal error, incorrect LookupResultType "+a+")":(s=a.substring(n+t.length+2,o),"1"==s?e:"2"==s?t:s)):(n=a.indexOf("|"+t.charAt(0)+"*:"),n>=0?(o=a.indexOf("|",n+1),0>o?"e#VALUE! (internal error, incorrect LookupResultType "+a+")":(s=a.substring(n+4,o),"1"==s?e:"2"==s?t:s)):"e#VALUE!")):"e#VALUE! (internal error, missing LookupResultType "+e.charAt(0)+"*)"},r.Formula.TopOfStackValueAndType=function(e,t){var n=r.Formula,o={type:"",value:""},s=t.length;return s?(o.value=t[s-1].value,o.type=t[s-1].type,t.pop(),"name"==o.type&&(o=n.LookupName(e,o.value)),o):(o.error=r.Constants.s_InternalError+"no operand on stack",o)},r.Formula.OperandAsNumber=function(e,t){var n,o,s=r.Formula.OperandValueAndType(e,t);
return n=s.type.charAt(0),"n"==n?s.value=s.value-0:"b"==n?(s.type="n",s.value=0):"e"==n?s.value=0:(o=r.DetermineValueType?r.DetermineValueType(s.value):{value:s.value-0,type:"n"},"n"==o.type.charAt(0)?(s.value=o.value-0,s.type=o.type):(s.value=0,s.type=o.type)),s},r.Formula.OperandAsText=function(e,t){var n,o=r.Formula.OperandValueAndType(e,t);return n=o.type.charAt(0),"t"==n||("n"==n?(o.value=r.format_number_for_display?r.format_number_for_display(o.value,o.type,""):o.value=o.value+"",o.type="t"):"b"==n?(o.value="",o.type="t"):"e"==n?o.value="":(t.value=o.value+"",t.type="t")),o},r.Formula.OperandValueAndType=function(e,t){var n,o,s,a,i=r.Formula,l={type:"",value:""},u=t.length;if(!u)return l.error=r.Constants.s_InternalError+"no operand on stack",l;if(l.value=t[u-1].value,l.type=t[u-1].type,t.pop(),"name"==l.type&&(l=i.LookupName(e,l.value)),"range"==l.type&&(l=i.StepThroughRangeDown(t,l.value)),"coord"==l.type){if(a=e,s=l.value.indexOf("!"),-1!=s){if(a=i.FindInSheetCache(l.value.substring(s+1)),null==a)return l.type="e#REF!",l.error=r.Constants.s_sheetunavailable+" "+l.value.substring(s+1),l.value=0,l;l.value=l.value.substring(0,s)}a?(o=a.cells[r.Formula.PlainCoord(l.value)],o?(n=o.valuetype,l.value=o.datavalue):n="b"):(n="e#N/A",l.value=0),l.type=n||"b","b"==l.type&&(l.value=0)}return l},r.Formula.OperandAsCoord=function(e,t){var n=(r.Formula,{type:"",value:""}),o=t.length;return n.value=t[o-1].value,n.type=t[o-1].type,t.pop(),"name"==n.type&&(n=r.Formula.LookupName(e,n.value)),"coord"==n.type?n:(n.value=r.Constants.s_calcerrcellrefmissing,n.type="e#REF!",n)},r.Formula.OperandsAsCoordOnSheet=function(e,t){var n,o,s,a,i={},l={},u=r.Formula,c=t.length;return i.value=t[c-1].value,i.type=t[c-1].type,t.pop(),n=u.OperandAsSheetName(e,t),o=u.FindInSheetCache(n.value),null==o?(l.type="e#REF!",l.value=0,l.error=r.Constants.s_sheetunavailable+" "+n.value,l):("name"==i.type&&(i=u.LookupName(o,i.value)),l.type=i.type,"coord"==i.type?l.value=i.value+"!"+n.value:"range"==i.type?(s=i.value.indexOf("|"),a=i.value.indexOf("|",s+1),l.value=i.value.substring(0,s)+"!"+n.value+"|"+i.value.substring(s+1,a)+"|"):"e"==i.type.charAt(0)?l.value=i.value:(l.error=r.Constants.s_calcerrcellrefmissing,l.type="e#REF!",l.value=0),l)},r.Formula.OperandsAsRangeOnSheet=function(e,t){var n,o,s,a,i={},l=r.Formula,u=r.Constants,c=t.length;return i.value=t[c-1].value,i.type=t[c-1].type,t.pop(),n=l.OperandAsCoord(e,t),"coord"!=n.type?{value:0,type:"e#REF!"}:(o=e,s=n.value.indexOf("!"),-1!=s&&(a=n.value.indexOf("|",s+1),0>a&&(a=n.value.length),o=l.FindInSheetCache(n.value.substring(s+1,a)),null==o)?{value:0,type:"e#REF!",errortext:u.s_sheetunavailable+" "+n.value.substring(s+1,a)}:("name"==i.type&&(i=l.LookupName(o,i.value,"end")),"coord"==i.type?{value:n.value+"|"+i.value+"|",type:"range"}:{value:u.s_calcerrcellrefmissing,type:"e#REF!"}))},r.Formula.OperandAsSheetName=function(e,t){var n,o,s=(r.Formula,{type:"",value:""}),a=t.length;if(s.value=t[a-1].value,s.type=t[a-1].type,t.pop(),"name"==s.type){if(n=r.Formula.LookupName(e,s.value),!n.value)return s;s.value=n.value,s.type=n.type}return"coord"==s.type&&(o=e.cells[r.Formula.PlainCoord(s.value)],o?(s.value=o.datavalue,s.type=o.valuetype):(s.value="",s.type="b")),"t"==s.type.charAt(0)?s:(s.value="",s.error=r.Constants.s_calcerrsheetnamemissing,s)},r.Formula.LookupName=function(e,t,n){var o,s,a,i=e.names,l={},u=!1;if(i[t.toUpperCase()]){if(l.value=i[t.toUpperCase()].definition,"="==l.value.charAt(0)){if(e.checknamecirc){if(e.checknamecirc[t])return l.type="e#NAME?",l.error=r.Constants.s_circularnameref+' "'+t+'".',l}else e.checknamecirc={},u=!0;if(e.checknamecirc[t]=!0,a=r.Formula.ParseFormulaIntoTokens(l.value.substring(1)),l=r.Formula.evaluate_parsed_formula(a,e,1),delete e.checknamecirc[t],u&&delete e.checknamecirc,"range"!=l.type)return l}return o=l.value.indexOf(":"),-1!=o?(l.type="range",l.value=l.value.substring(0,o)+"|"+l.value.substring(o+1)+"|",l.value=l.value.toUpperCase()):(l.type="coord",l.value=l.value.toUpperCase()),l}return(s=r.Formula.SpecialConstants[t.toUpperCase()])?(o=s.indexOf(","),l.value=s.substring(0,o)-0,l.type=s.substring(o+1),l):/^[a-zA-Z][a-zA-Z]?$/.test(t)?(l.type="coord",l.value=t.toUpperCase()+(n?e.attribs.lastrow:1),l):(l.value="",l.type="e#NAME?",l.error=r.Constants.s_calcerrunknownname+' "'+t+'"',l)},r.Formula.StepThroughRangeDown=function(e,t){var n,o,s,a,i,l,u,c,d,p,h=r.Formula;for(a=t.indexOf("|"),i=t.indexOf("|",a+1),n=t.substring(0,a),o=t.substring(a+1,i),s=t.substring(i+1)-0,a=n.indexOf("!"),-1!=a?(l=n.substring(a),n=n.substring(0,a)):l="",a=o.indexOf("!"),-1!=a&&(o=o.substring(0,a)),u=h.OrderRangeParts(n,o),p=0,d=u.r1;d<=u.r2;d++)for(c=u.c1;c<=u.c2;c++)if(p++,p>s)return(d!=u.r2||c!=u.c2)&&h.PushOperand(e,"range",n+l+"|"+o+"|"+p),{value:r.crToCoord(c,d)+l,type:"coord"}},r.Formula.DecodeRangeParts=function(e,t){var n,o,s,a,i,l,u,c=r.Formula;return s=t.indexOf("|"),a=t.indexOf("|",s+1),n=t.substring(0,s),o=t.substring(s+1,a),s=n.indexOf("!"),-1!=s?(i=n.substring(s+1),n=n.substring(0,s)):i="",s=o.indexOf("!"),-1!=s&&(o=o.substring(0,s)),l=e,i&&(l=c.FindInSheetCache(i),null==l)?null:(u=c.OrderRangeParts(n,o),{sheetdata:l,sheetname:i,col1num:u.c1,ncols:u.c2-u.c1+1,row1num:u.r1,nrows:u.r2-u.r1+1})},r.Formula.FunctionList||(r.Formula.FunctionList={}),r.Formula.FunctionClasses=null,r.Formula.FunctionArgDefs={},r.Formula.CalculateFunction=function(e,t,n){var o,s,a,i,l,u=r.Formula,c="";if(o=u.FunctionList[e]){if(s=[],a=o[0],i=o[1],u.CopyFunctionArgs(t,s),100!=i)if(0>i){if(s.length<-i)return c=u.FunctionArgsError(e,t)}else if(s.length!=i)return c=u.FunctionArgsError(e,t);c=a(e,t,s,n)}else l=e,t.length&&"start"==t[t.length-1].type?(t.pop(),u.PushOperand(t,"name",l)):c=r.Constants.s_sheetfuncunknownfunction+" "+l+". ";return c},r.Formula.PushOperand=function(e,t,r){e.push({type:t,value:r})},r.Formula.CopyFunctionArgs=function(e,t){var t;for(r.Formula;e.length>0&&"start"!=e[e.length-1].type;)t.push(e.pop());e.pop()},r.Formula.FunctionArgsError=function(e,t){var n=r.Constants.s_calcerrincorrectargstofunction+" "+e+". ";return r.Formula.PushOperand(t,"e#VALUE!",n),n},r.Formula.FunctionSpecificError=function(e,t,n,o){return r.Formula.PushOperand(t,n,o),o},r.Formula.CheckForErrorValue=function(e,t){return"e"==t.type.charAt(0)?(e.push(t),!0):!1},r.Formula.FillFunctionInfo=function(){var e,t,n,o,s,a=r.Formula,i=r.Constants;if(!a.FunctionClasses){for(e in a.FunctionList)t=a.FunctionList[e],t[2]&&(a.FunctionArgDefs[t[2]]=i["s_farg_"+t[2]]||""),t[3]||i["s_fdef_"+e]&&(a.FunctionList[e][3]=i["s_fdef_"+e]);for(a.FunctionClasses={},s=0;s<i.function_classlist.length;s++)o=i.function_classlist[s],a.FunctionClasses[o]={name:i["s_fclass_"+o],items:[]};for(e in a.FunctionList)for(t=a.FunctionList[e],n=t[4]?t[4].split(","):[],n.push("all"),s=0;s<n.length;s++)o=n[s],a.FunctionClasses[o].items.push(e);for(o in a.FunctionClasses)a.FunctionClasses[o].items.sort()}},r.Formula.FunctionArgString=function(e){var t,n,o,s=r.Formula,a=s.FunctionList[e],i=a[2];if(!i){if(t=a[1],0!=t){if(t>0){for(o="v1",n=2;t>=n;n++)o+=", v"+n;return o}if(0>t){for(o="v1",n=2;-t>n;n++)o+=", v"+n;return o+", ..."}return"nargs: "+t}i=" "}return o=s.FunctionArgDefs[i]||i},r.Formula.SeriesFunctions=function(e,t,n,o){for(var s,a,i,l,u,c,d,p,h,f=r.Formula,m=f.OperandValueAndType,y=f.LookupResultType,v=f.TypeLookupTable.plus,g=function(e,r){t.push({type:e,value:r})},b=0,_="",C=0,x=0,w=0,S=1;n.length>0;)s=m(o,n),a=s.type.charAt(0),"n"==a&&(C+=1),"b"!=a&&(x+=1),"b"==a&&(w+=1),"n"==a?(i=s.value-0,b+=i,S*=i,l=void 0!=l?i>l?i:l:i,u=void 0!=u?u>i?i:u:i,1==C?(p=i,h=0):(c=p+(i-p)/C,d=h+(i-p)*(i-c),h=d,p=c),_=y(s.type,_||s.type,v)):"e"==a&&"e"!=_.charAt(0)&&(_=s.type);switch(_=_||"n",e){case"SUM":g(_,b);break;case"PRODUCT":g(_,S);break;case"MIN":g(_,u||0);break;case"MAX":g(_,l||0);break;case"COUNT":g("n",C);break;case"COUNTA":g("n",x);break;case"COUNTBLANK":g("n",w);break;case"AVERAGE":C>0?g(_,b/C):g("e#DIV/0!",0);break;case"STDEV":C>1?g(_,Math.sqrt(d/(C-1))):g("e#DIV/0!",0);break;case"STDEVP":C>1?g(_,Math.sqrt(d/C)):g("e#DIV/0!",0);break;case"VAR":C>1?g(_,d/(C-1)):g("e#DIV/0!",0);break;case"VARP":C>1?g(_,d/C):g("e#DIV/0!",0)}return null},r.Formula.FunctionList.AVERAGE=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.COUNT=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.COUNTA=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.COUNTBLANK=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.MAX=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.MIN=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.PRODUCT=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.STDEV=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.STDEVP=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.SUM=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.VAR=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.FunctionList.VARP=[r.Formula.SeriesFunctions,-1,"vn",null,"stat"],r.Formula.SumProductFunction=function(e,t,n,o){for(var s,a=[],l=0,u=r.Formula,c=0,d=0,p=function(e,r){t.push({type:e,value:r})};n.length>0;){if(s=u.TopOfStackValueAndType(o,n),"range"!=s.type)return void p("e#VALUE!",0);if(rangeinfo=u.DecodeRangeParts(o,s.value),c){if(c!=rangeinfo.ncols)return void p("e#VALUE!",0)}else c=rangeinfo.ncols;if(d){if(d!=rangeinfo.nrows)return void p("e#VALUE!",0)}else d=rangeinfo.nrows;for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=r.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,a[k]=(a[k]||1)*value}for(i=0;i<a.length;i++)l+=a[i];p("n",l)},r.Formula.FunctionList.SUMPRODUCT=[r.Formula.SumProductFunction,-1,"rangen","","stat"],r.Formula.DSeriesFunctions=function(e,t,n,o){var s,a,i,l,u,c,d,p,h,f,m,y,v,g,b,_,C,x,w,S,k,F,T,N,A,E,L=r.Formula,R=(L.OperandValueAndType,L.LookupResultType),O=L.TypeLookupTable.plus,P=function(e,r){t.push({type:e,value:r})},s={},I=0,j="",M=0,D=0,U=0,V=1;if(i=L.TopOfStackValueAndType(o,n),l=L.OperandValueAndType(o,n),u=L.TopOfStackValueAndType(o,n),"range"!=i.type||"range"!=u.type)return L.FunctionArgsError(e,t);if(c=L.DecodeRangeParts(o,i.value),d=L.DecodeRangeParts(o,u.value),p=L.FieldToColnum(c.sheetdata,c.col1num,c.ncols,c.row1num,l.value,l.type),0>=p)return void P("e#VALUE!",0);for(h=c.col1num+p-1,g=[],f=0;f<d.ncols;f++){if(v=d.sheetdata.GetAssuredCell(r.crToCoord(d.col1num+f,d.row1num)),criterianum=L.FieldToColnum(c.sheetdata,c.col1num,c.ncols,c.row1num,v.datavalue,v.valuetype),criterianum<=0)return void P("e#VALUE!",0);g.push(c.col1num+criterianum-1)}for(f=1;f<c.nrows;f++){b=!1;e:for(m=1;m<d.nrows;m++){for(y=0;y<d.ncols;y++)if(_=r.crToCoord(d.col1num+y,d.row1num+m),v=d.sheetdata.GetAssuredCell(_),C=v.datavalue,("string"!=typeof C||0!=C.length)&&(x=g[y],w=r.crToCoord(x,c.row1num+f),v=d.sheetdata.GetAssuredCell(w),!L.TestCriteria(v.datavalue,v.valuetype||"b",C)))continue e;b=!0;break e}b&&(a=r.crToCoord(h,c.row1num+f),v=c.sheetdata.GetAssuredCell(a),s.value=v.datavalue,s.type=v.valuetype,S=s.type.charAt(0),"n"==S&&(M+=1),"b"!=S&&(D+=1),"b"==S&&(U+=1),"n"==S?(v1=s.value-0,I+=v1,V*=v1,k=void 0!=k?v1>k?v1:k:v1,F=void 0!=F?v1<F?v1:F:v1,1==M?(A=v1,E=0):(T=A+(v1-A)/M,N=E+(v1-A)*(v1-T),E=N,A=T),j=R(s.type,j||s.type,O)):"e"==S&&"e"!=j.charAt(0)&&(j=s.type))}switch(j=j||"n",e){case"DSUM":P(j,I);break;case"DPRODUCT":P(j,V);break;case"DMIN":P(j,F||0);break;case"DMAX":P(j,k||0);break;case"DCOUNT":P("n",M);break;case"DCOUNTA":P("n",D);break;case"DAVERAGE":M>0?P(j,I/M):P("e#DIV/0!",0);break;case"DSTDEV":M>1?P(j,Math.sqrt(N/(M-1))):P("e#DIV/0!",0);break;case"DSTDEVP":M>1?P(j,Math.sqrt(N/M)):P("e#DIV/0!",0);break;case"DVAR":M>1?P(j,N/(M-1)):P("e#DIV/0!",0);break;case"DVARP":M>1?P(j,N/M):P("e#DIV/0!",0);break;case"DGET":1==M?P(j,I):0==M?P("e#VALUE!",0):P("e#NUM!",0)}},r.Formula.FunctionList.DAVERAGE=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DCOUNT=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DCOUNTA=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DGET=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DMAX=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DMIN=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DPRODUCT=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DSTDEV=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DSTDEVP=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DSUM=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DVAR=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FunctionList.DVARP=[r.Formula.DSeriesFunctions,3,"dfunc","","stat"],r.Formula.FieldToColnum=function(e,t,n,o,s,a){var i,l,u;if("n"==a.charAt(0))return i=s-0,0>=i||i>n?0:Math.floor(i);if("t"!=a.charAt(0))return 0;for(s=s?s.toLowerCase():"",i=0;n>i;i++)if(l=e.GetAssuredCell(r.crToCoord(t+i,o)),u=l.datavalue,u=(u+"").toLowerCase(),u==s)return i+1;return 0},r.Formula.LookupFunctions=function(e,t,n,o){var s,a,i,l,u,c,d,p,h,f,m,y,v,g,b,_,s,C=r.Formula,x=C.OperandValueAndType,w=(C.LookupResultType,C.TypeLookupTable.plus,function(e,r){t.push({type:e,value:r})});if(s=x(o,n),"string"==typeof s.value&&(s.value=s.value.toLowerCase()),a=C.TopOfStackValueAndType(o,n),i=1,"MATCH"==e){if(n.length){if(i=C.OperandAsNumber(o,n),"n"!=i.type.charAt(0))return void w("e#VALUE!",0);if(n.length)return C.FunctionArgsError(e,t),0;i=i.value-0}}else{if(l=C.OperandAsNumber(o,n),"n"!=l.type.charAt(0))return void w("e#VALUE!",0);if(l=Math.floor(l.value),n.length){if(i=C.OperandAsNumber(o,n),"n"!=i.type.charAt(0))return void w("e#VALUE!",0);if(n.length)return C.FunctionArgsError(e,t),0;i=i.value?1:0}}if(s.type=s.type.charAt(0),"n"==s.type&&(s.value=s.value-0),"range"!=a.type)return C.FunctionArgsError(e,t),0;if(u=C.DecodeRangeParts(o,a.value,a.type),!u)return void w("e#REF!",0);if(c=0,d=0,p=0,h=0,"HLOOKUP"==e){if(p=1,l>u.nrows)return void w("e#REF!",0)}else if("VLOOKUP"==e){if(h=1,l>u.ncols)return void w("e#REF!",0)}else{if("MATCH"!=e)return C.FunctionArgsError(e,t),0;if(u.ncols>1){if(u.nrows>1)return void w("e#N/A",0);p=1}else h=1}if(1>l&&"MATCH"!=e)return w("e#VALUE!",0),0;for(;;){if(_=r.crToCoord(u.col1num+c,u.row1num+d),v=u.sheetdata.GetAssuredCell(_),g=v.datavalue,b=v.valuetype?v.valuetype.charAt(0):"b","n"==b&&(g-=0),i){if("n"==s.type&&"n"==b){if(s.value==g)break;if(i>0&&s.value>g||0>i&&s.value<g)f=1,m=c,y=d;else if(f){f=2;break}}else if("t"==s.type&&"t"==b){if(g="string"==typeof g?g.toLowerCase():"",s.value==g)break;if(i>0&&s.value>g||0>i&&s.value<g)f=1,m=c,y=d;else if(f){f=2;break}}}else if("n"==s.type&&"n"==b){if(s.value==g)break}else if("t"==s.type&&"t"==b&&(g="string"==typeof g?g.toLowerCase():"",s.value==g))break;if(d+=h,c+=p,d>=u.nrows||c>=u.ncols){if(f){f=2;break}return void w("e#N/A",0)}}2==f&&(d=y,c=m),"MATCH"==e?(g=c+d+1,b="n"):(_=r.crToCoord(u.col1num+c+("VLOOKUP"==e?l-1:0),u.row1num+d+("HLOOKUP"==e?l-1:0)),v=u.sheetdata.GetAssuredCell(_),g=v.datavalue,b=v.valuetype),w(b,g)},r.Formula.FunctionList.HLOOKUP=[r.Formula.LookupFunctions,-3,"hlookup","","lookup"],r.Formula.FunctionList.MATCH=[r.Formula.LookupFunctions,-2,"match","","lookup"],r.Formula.FunctionList.VLOOKUP=[r.Formula.LookupFunctions,-3,"vlookup","","lookup"],r.Formula.IndexFunction=function(e,t,n,o){var s,a,i,l,u,c,d,p=r.Formula,h=function(e,r){t.push({type:e,value:r})};if(s=p.TopOfStackValueAndType(o,n),"range"!=s.type)return p.FunctionArgsError(e,t),0;if(i=p.DecodeRangeParts(o,s.value,s.type),a=i.sheetname?"!"+i.sheetname:"",l={value:0},u={value:0},n.length){if(l=p.OperandAsNumber(o,n),"n"!=l.type.charAt(0)||l.value<0)return void h("e#VALUE!",0);if(n.length){if(u=p.OperandAsNumber(o,n),"n"!=u.type.charAt(0)||u.value<0)return void h("e#VALUE!",0);if(n.length)return p.FunctionArgsError(e,t),0}else 1==i.nrows&&(u.value=l.value,l.value=0)}return l.value>i.nrows||u.value>i.ncols?void h("e#REF!",0):(0==l.value?0==u.value?1==i.nrows&&1==i.ncols?(c=r.crToCoord(i.col1num,i.row1num)+a,d="coord"):(c=r.crToCoord(i.col1num,i.row1num)+a+"|"+r.crToCoord(i.col1num+i.ncols-1,i.row1num+i.nrows-1)+"|",d="range"):1==i.nrows?(c=r.crToCoord(i.col1num+u.value-1,i.row1num)+a,d="coord"):(c=r.crToCoord(i.col1num+u.value-1,i.row1num)+a+"|"+r.crToCoord(i.col1num+u.value-1,i.row1num+i.nrows-1)+"|",d="range"):0==u.value?1==i.ncols?(c=r.crToCoord(i.col1num,i.row1num+l.value-1)+a,d="coord"):(c=r.crToCoord(i.col1num,i.row1num+l.value-1)+a+"|"+r.crToCoord(i.col1num+i.ncols-1,i.row1num+l.value-1)+"|",d="range"):(c=r.crToCoord(i.col1num+u.value-1,i.row1num+l.value-1)+a,d="coord"),void h(d,c))},r.Formula.FunctionList.INDEX=[r.Formula.IndexFunction,-1,"index","","lookup"],r.Formula.CountifSumifFunctions=function(e,t,n,o){var s,a,i,l,u,c,d=0,p="",h=0,f=r.Formula,m=f.OperandValueAndType,y=f.LookupResultType,v=f.TypeLookupTable.plus,g=function(e,r){t.push({type:e,value:r})};if(s=f.TopOfStackValueAndType(o,n),a=f.OperandAsText(o,n),"SUMIF"==e)if(1==n.length)i=f.TopOfStackValueAndType(o,n);else{if(0!=n.length)return f.FunctionArgsError(e,t),0;i={value:s.value,type:s.type}}else i={value:s.value,type:s.type};if("n"==a.type.charAt(0)?a.value=a.value+"":"e"==a.type.charAt(0)?a.value=null:"b"==a.type.charAt(0)&&(a.value=null),"coord"!=s.type&&"range"!=s.type)return f.FunctionArgsError(e,t),0;if("SUMIF"==e&&"coord"!=i.type&&"range"!=i.type)return f.FunctionArgsError(e,t),0;for(n.push(s),l=[],l.push(i);n.length;)u=m(o,n),c=m(o,l),f.TestCriteria(u.value,u.type,a.value)&&(h+=1,"n"==c.type.charAt(0)?(d+=c.value-0,p=y(c.type,p||c.type,v)):"e"==c.type.charAt(0)&&"e"!=p.charAt(0)&&(p=c.type));p=p||"n","SUMIF"==e?g(p,d):"COUNTIF"==e&&g("n",h)},r.Formula.FunctionList.COUNTIF=[r.Formula.CountifSumifFunctions,2,"rangec","","stat"],r.Formula.FunctionList.SUMIF=[r.Formula.CountifSumifFunctions,-2,"sumif","","stat"],r.Formula.SumifsFunction=function(e,t,n,o){var s,a,i,l,u,c,d=0,p="",h=r.Formula,f=h.OperandValueAndType,m=h.LookupResultType,y=h.TypeLookupTable.plus,v=function(e,r){t.push({type:e,value:r})};if(i=h.TopOfStackValueAndType(o,n),"coord"!=i.type&&"range"!=i.type)return h.FunctionArgsError(e,t),0;for(var g=[],b=[];n.length;){if(s=h.TopOfStackValueAndType(o,n),a=h.OperandAsText(o,n),"n"==a.type.charAt(0)?a.value=a.value+"":"e"==a.type.charAt(0)?a.value=null:"b"==a.type.charAt(0)&&(a.value=null),"coord"!=s.type&&"range"!=s.type)return h.FunctionArgsError(e,t),0;g.push([s]),b.push(a)}for(l=[],l.push(i);l.length;){c=f(o,l);for(var _=!0,C=0;C<g.length;C++)if(u=f(o,g[C]),!h.TestCriteria(u.value,u.type,b[C].value)){_=!1;break}_&&("n"==c.type.charAt(0)?(d+=c.value-0,p=m(c.type,p||c.type,y)):"e"==c.type.charAt(0)&&"e"!=p.charAt(0)&&(p=c.type))}p=p||"n",v(p,d)},r.Formula.FunctionList.SUMIFS=[r.Formula.SumifsFunction,-3,"sumifs","","stat"],r.Formula.IfFunction=function(e,t,n,o){var s,a;if(s=r.Formula.OperandValueAndType(o,n),a=s.type.charAt(0),"n"!=a&&"b"!=a)return void t.push({type:"e#VALUE!",value:0});var i,l;if(i=n.pop(),1==n.length)l=n.pop();else{if(0!=n.length)return void scf.FunctionArgsError(e,t);l={type:"n",value:0}}t.push(s.value?i:l)},r.Formula.FunctionList.IF=[r.Formula.IfFunction,-2,"iffunc","","test"],r.Formula.DateFunction=function(e,t,n,o){var s=r.Formula,a=0,i=s.OperandAsNumber(o,n),l=s.OperandAsNumber(o,n),u=s.OperandAsNumber(o,n),c=s.LookupResultType(i.type,l.type,s.TypeLookupTable.twoargnumeric);c=s.LookupResultType(c,u.type,s.TypeLookupTable.twoargnumeric),"n"==c.charAt(0)&&(a=r.FormatNumber.convert_date_gregorian_to_julian(Math.floor(i.value),Math.floor(l.value),Math.floor(u.value))-r.FormatNumber.datevalues.julian_offset,c="nd"),s.PushOperand(t,c,a)},r.Formula.FunctionList.DATE=[r.Formula.DateFunction,3,"date","","datetime"],r.Formula.TimeFunction=function(e,t,n,o){var s=r.Formula,a=0,i=s.OperandAsNumber(o,n),l=s.OperandAsNumber(o,n),u=s.OperandAsNumber(o,n),c=s.LookupResultType(i.type,l.type,s.TypeLookupTable.twoargnumeric);c=s.LookupResultType(c,u.type,s.TypeLookupTable.twoargnumeric),"n"==c.charAt(0)&&(a=(60*i.value*60+60*l.value+u.value)/86400,c="nt"),s.PushOperand(t,c,a)},r.Formula.FunctionList.TIME=[r.Formula.TimeFunction,3,"hms","","datetime"],r.Formula.DMYFunctions=function(e,t,n,o){var s,a,i,l=r.Formula,u=0,c=l.OperandAsNumber(o,n),d=l.LookupResultType(c.type,c.type,l.TypeLookupTable.oneargnumeric);if("n"==d.charAt(0))switch(s=r.FormatNumber.convert_date_julian_to_gregorian(Math.floor(c.value+r.FormatNumber.datevalues.julian_offset)),e){case"DAY":u=s.day;break;case"MONTH":u=s.month;break;case"YEAR":u=s.year;break;case"WEEKDAY":if(a={value:1},n.length){if(a=l.OperandAsNumber(o,n),"n"!=a.type.charAt(0)||a.value<1||a.value>3)return void l.PushOperand(t,"e#VALUE!",0);if(n.length)return void l.FunctionArgsError(e,t)}i=6,a.value>1&&(i-=1),u=Math.floor(c.value+i)%7+(a.value<3?1:0)}l.PushOperand(t,d,u)},r.Formula.FunctionList.DAY=[r.Formula.DMYFunctions,1,"v","","datetime"],r.Formula.FunctionList.MONTH=[r.Formula.DMYFunctions,1,"v","","datetime"],r.Formula.FunctionList.YEAR=[r.Formula.DMYFunctions,1,"v","","datetime"],r.Formula.FunctionList.WEEKDAY=[r.Formula.DMYFunctions,-1,"weekday","","datetime"],r.Formula.HMSFunctions=function(e,t,n,o){var s,a,i,l,u=r.Formula,c=0,d=u.OperandAsNumber(o,n),p=u.LookupResultType(d.type,d.type,u.TypeLookupTable.oneargnumeric);if("n"==p.charAt(0)){if(d.value<0)return void u.PushOperand(t,"e#NUM!",0);l=d.value-Math.floor(d.value),l*=24,s=Math.floor(l),l-=Math.floor(l),l*=60,a=Math.floor(l),l-=Math.floor(l),l*=60,i=Math.floor(l+(d.value>=0?.5:-.5)),"HOUR"==e?c=s:"MINUTE"==e?c=a:"SECOND"==e&&(c=i)}u.PushOperand(t,p,c)},r.Formula.FunctionList.HOUR=[r.Formula.HMSFunctions,1,"v","","datetime"],r.Formula.FunctionList.MINUTE=[r.Formula.HMSFunctions,1,"v","","datetime"],r.Formula.FunctionList.SECOND=[r.Formula.HMSFunctions,1,"v","","datetime"],r.Formula.ExactFunction=function(e,t,n,o){var s=r.Formula,a=0,i="nl",l=s.OperandValueAndType(o,n),u=l.type.charAt(0),c=s.OperandValueAndType(o,n),d=c.type.charAt(0);"t"==u?"t"==d?a=l.value==c.value?1:0:"b"==d?a=l.value.length?0:1:"n"==d?a=l.value==c.value+""?1:0:"e"==d?(a=c.value,i=c.type):a=0:"n"==u?"n"==d?a=l.value-0==c.value-0?1:0:"b"==d?a=0:"t"==d?a=l.value+""==c.value?1:0:"e"==d?(a=c.value,i=c.type):a=0:"b"==u?"t"==d?a=c.value.length?0:1:"b"==d?a=1:"n"==d?a=0:"e"==d?(a=c.value,i=c.type):a=0:"e"==u&&(a=l.value,i=l.type),s.PushOperand(t,i,a)},r.Formula.FunctionList.EXACT=[r.Formula.ExactFunction,2,"","","text"],r.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],HEXCODE:[1],UPPER:[1]},r.Formula.StringFunctions=function(e,t,n,o){var s,a,i,l,u,c,d=r.Formula,p=0,h="e#VALUE!",f=n.length,m=d.ArgList[e],y=[],v=[];for(s=1;f>=s;s++){if(s>m.length)return void d.FunctionArgsError(e,t);if(0==m[s-1]?a=d.OperandAsNumber(o,n):1==m[s-1]?a=d.OperandAsText(o,n):-1==m[s-1]&&(a=d.OperandValueAndType(o,n)),y[s]=a.value,v[s]=a.type,"e"==a.type.charAt(0))return void d.PushOperand(t,a.type,p)}switch(e){case"FIND":i=v[3]?y[3]-1:0,0>i?p="Start is before string":(p=y[2].indexOf(y[1],i),p>=0?(p+=1,h="n"):p="Not found");break;case"LEFT":l=v[2]?y[2]-0:1,0>l?p="Negative length":(p=y[1].substring(0,l),h="t");break;case"LEN":p=y[1].length,h="n";break;case"LOWER":p=y[1].toLowerCase(),h="t";break;case"MID":u=y[2]-0,l=y[3]-0,1>l||1>u?p="Bad arguments":(p=y[1].substring(u-1,u+l-1),h="t");break;case"PROPER":p=y[1].replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),h="t";break;case"REPLACE":u=y[2]-0,l=y[3]-0,0>l||1>u?p="Bad arguments":(p=y[1].substring(0,u-1)+y[4]+y[1].substring(u-1+l),h="t");break;case"REPT":if(c=y[2]-0,0>c)p="Negative count";else{for(p="";c>0;c--)p+=y[1];h="t"}break;case"RIGHT":l=v[2]?y[2]-0:1,0>l?p="Negative length":(p=y[1].slice(-l),h="t");break;case"SUBSTITUTE":if(fulltext=y[1],oldtext=y[2],newtext=y[3],null!=y[4]){if(which=y[4]-0,which<=0){p="Non-positive instance number";break}}else which=0;for(c=0,oldpos=0,p="";;){if(pos=fulltext.indexOf(oldtext,oldpos),!(pos>=0)){p+=fulltext.substring(oldpos);break}if(c++,p+=fulltext.substring(oldpos,pos),0==which)p+=newtext;else{if(which==c){p+=newtext+fulltext.substring(pos+oldtext.length);break}p+=oldtext}oldpos=pos+oldtext.length}h="t";break;case"TRIM":p=y[1],p=p.replace(/^ */,""),p=p.replace(/ *$/,""),p=p.replace(/ +/g," "),h="t";break;case"HEXCODE":p=String(y[1]);var g=p.charCodeAt(0);if(g>=55296&&56319>=g){var b=p.charCodeAt(1);b>=56320&&57343>=b&&(g=1024*(g-55296)+(b-56320)+65536)}p=g.toString(16).toUpperCase(),h="t";break;case"UPPER":p=y[1].toUpperCase(),h="t"}d.PushOperand(t,h,p)},r.Formula.FunctionList.FIND=[r.Formula.StringFunctions,-2,"find","","text"],r.Formula.FunctionList.LEFT=[r.Formula.StringFunctions,-2,"tc","","text"],r.Formula.FunctionList.LEN=[r.Formula.StringFunctions,1,"txt","","text"],r.Formula.FunctionList.LOWER=[r.Formula.StringFunctions,1,"txt","","text"],r.Formula.FunctionList.MID=[r.Formula.StringFunctions,3,"mid","","text"],r.Formula.FunctionList.PROPER=[r.Formula.StringFunctions,1,"v","","text"],r.Formula.FunctionList.REPLACE=[r.Formula.StringFunctions,4,"replace","","text"],r.Formula.FunctionList.REPT=[r.Formula.StringFunctions,2,"tc","","text"],r.Formula.FunctionList.RIGHT=[r.Formula.StringFunctions,-1,"tc","","text"],r.Formula.FunctionList.SUBSTITUTE=[r.Formula.StringFunctions,-3,"subs","","text"],r.Formula.FunctionList.TRIM=[r.Formula.StringFunctions,1,"v","","text"],r.Formula.FunctionList.HEXCODE=[r.Formula.StringFunctions,1,"v","","text"],r.Formula.FunctionList.UPPER=[r.Formula.StringFunctions,1,"v","","text"],r.Formula.IsFunctions=function(e,t,n,o){var s=r.Formula,a=0,i="nl",l=s.OperandValueAndType(o,n),u=l.type.charAt(0);switch(e){case"ISBLANK":a="b"==l.type?1:0;break;case"ISERR":a="e"==u?"e#N/A"==l.type?0:1:0;break;case"ISERROR":a="e"==u?1:0;break;case"ISLOGICAL":a="nl"==l.type?1:0;break;case"ISNA":a="e#N/A"==l.type?1:0;break;case"ISNONTEXT":a="t"==u?0:1;break;case"ISNUMBER":a="n"==u?1:0;break;case"ISTEXT":a="t"==u?1:0}s.PushOperand(t,i,a)},r.Formula.FunctionList.ISBLANK=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISERR=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISERROR=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISLOGICAL=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISNA=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISNONTEXT=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISNUMBER=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.FunctionList.ISTEXT=[r.Formula.IsFunctions,1,"v","","test"],r.Formula.NTVFunctions=function(e,t,n,o){var s=r.Formula,a=0,i="e#VALUE!",l=s.OperandValueAndType(o,n),u=l.type.charAt(0);switch(e){case"N":a="n"==u?l.value-0:0,i="n";break;case"T":a="t"==u?l.value+"":"",i="t";break;case"VALUE":"n"==u||"b"==u?(a=l.value||0,i="n"):"t"==u&&(l=r.DetermineValueType(l.value),"n"!=l.type.charAt(0)?(a=0,i="e#VALUE!"):(a=l.value-0,i="n"))}"e"==u&&(i=l.type),s.PushOperand(t,i,a)},r.Formula.FunctionList.N=[r.Formula.NTVFunctions,1,"v","","math"],r.Formula.FunctionList.T=[r.Formula.NTVFunctions,1,"v","","text"],r.Formula.FunctionList.VALUE=[r.Formula.NTVFunctions,1,"v","","text"],r.Formula.Math1Functions=function(e,t,n,o){var s,a,i,l={},u=r.Formula;if(s=u.OperandAsNumber(o,n),a=s.value,l.type=u.LookupResultType(s.type,s.type,u.TypeLookupTable.oneargnumeric),"n"==l.type)switch(e){case"ABS":a=Math.abs(a);break;case"ACOS":a>=-1&&1>=a?a=Math.acos(a):l.type="e#NUM!";break;case"ASIN":a>=-1&&1>=a?a=Math.asin(a):l.type="e#NUM!";break;case"ATAN":a=Math.atan(a);break;case"COS":a=Math.cos(a);break;case"DEGREES":a=180*a/Math.PI;break;case"EVEN":a=0>a?-a:a,a!=Math.floor(a)?a=Math.floor(a+1)+Math.floor(a+1)%2:a+=a%2,s.value<0&&(a=-a);break;case"EXP":a=Math.exp(a);break;case"FACT":for(i=1,a=Math.floor(a);a>0;a--)i*=a;a=i;break;case"INT":a=Math.floor(a);break;case"LN":0>=a&&(l.type="e#NUM!",l.error=r.Constants.s_sheetfunclnarg),a=Math.log(a);break;case"LOG10":0>=a&&(l.type="e#NUM!",l.error=r.Constants.s_sheetfunclog10arg),a=Math.log(a)/Math.log(10);break;case"ODD":a=0>a?-a:a,a!=Math.floor(a)?a=Math.floor(a+1)+(1-Math.floor(a+1)%2):a+=1-a%2,s.value<0&&(a=-a);break;case"RADIANS":a=a*Math.PI/180;break;case"SIN":a=Math.sin(a);break;case"SQRT":a>=0?a=Math.sqrt(a):l.type="e#NUM!";break;case"TAN":0!=Math.cos(a)?a=Math.tan(a):l.type="e#NUM!"}return l.value=a,t.push(l),null},r.Formula.FunctionList.ABS=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.ACOS=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.ASIN=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.ATAN=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.COS=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.DEGREES=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.EVEN=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.EXP=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.FACT=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.INT=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.LN=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.LOG10=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.ODD=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.RADIANS=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.SIN=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.SQRT=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.FunctionList.TAN=[r.Formula.Math1Functions,1,"v","","math"],r.Formula.Math2Functions=function(e,t,n,o){var s,a,i,l,u,c,d={},p=r.Formula;if(s=p.OperandAsNumber(o,n),a=p.OperandAsNumber(o,n),i=0,d.type=p.LookupResultType(s.type,a.type,p.TypeLookupTable.twoargnumeric),"n"==d.type)switch(e){case"ATAN2":0==s.value&&0==a.value?d.type="e#DIV/0!":d.value=Math.atan2(a.value,s.value);break;case"POWER":d.value=Math.pow(s.value,a.value),isNaN(d.value)&&(d.value=0,d.type="e#NUM!");break;case"MOD":0==a.value?d.type="e#DIV/0!":(l=s.value/a.value,l=Math.floor(l),d.value=s.value-l*a.value);break;case"TRUNC":if(u=1,a.value>=0){for(a.value=Math.floor(a.value),c=0;c<a.value;c++)u*=10;d.value=Math.floor(Math.abs(s.value)*u)/u}else if(a.value<0){for(a.value=Math.floor(-a.value),c=0;c<a.value;c++)u*=10;d.value=Math.floor(Math.abs(s.value)/u)*u}s.value<0&&(d.value=-d.value)}return t.push(d),null},r.Formula.FunctionList.ATAN2=[r.Formula.Math2Functions,2,"xy","","math"],r.Formula.FunctionList.MOD=[r.Formula.Math2Functions,2,"","","math"],r.Formula.FunctionList.POWER=[r.Formula.Math2Functions,2,"","","math"],r.Formula.FunctionList.TRUNC=[r.Formula.Math2Functions,2,"valpre","","math"],r.Formula.LogFunction=function(e,t,n,o){var s,a,i={},l=r.Formula;if(i.value=0,s=l.OperandAsNumber(o,n),i.type=l.LookupResultType(s.type,s.type,l.TypeLookupTable.oneargnumeric),1==n.length){if(a=l.OperandAsNumber(o,n),"n"!=a.type.charAt(0)||a.value<=0)return l.FunctionSpecificError(e,t,"e#NUM!",r.Constants.s_sheetfunclogsecondarg),0}else{if(0!=n.length)return l.FunctionArgsError(e,t),0;a={value:Math.E,type:"n"}}if("n"==i.type){if(s.value<=0)return l.FunctionSpecificError(e,t,"e#NUM!",r.Constants.s_sheetfunclogfirstarg),0;i.value=Math.log(s.value)/Math.log(a.value)}t.push(i)},r.Formula.FunctionList.LOG=[r.Formula.LogFunction,-1,"log","","math"],r.Formula.RoundFunction=function(e,t,n,o){var s,a,i,l,u=r.Formula,c=0,d="e#VALUE!",p=u.OperandValueAndType(o,n),d=u.LookupResultType(p.type,p.type,u.TypeLookupTable.oneargnumeric);if(1==n.length){if(s=u.OperandValueAndType(o,n),"n"!=s.type.charAt(0))return u.FunctionSpecificError(e,t,"e#NUM!",r.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=n.length)return u.FunctionArgsError(e,t),0;s={value:0,type:"n"}}if("n"==d)if(s.value=s.value-0,
0==s.value)c=Math.round(p.value);else if(s.value>0){for(a=1,s.value=Math.floor(s.value),l=0;l<s.value;l++)a*=10;i=Math.round(p.value*a),c=i/a}else if(s.value<0){for(a=1,s.value=Math.floor(-s.value),l=0;l<s.value;l++)a*=10;i=Math.round(p.value/a),c=i*a}u.PushOperand(t,d,c)},r.Formula.FunctionList.ROUND=[r.Formula.RoundFunction,-1,"vp","","math"],r.Formula.CeilingFloorFunctions=function(e,t,n,o){var s,a,i,l=r.Formula,u=function(e,r){t.push({type:e,value:r})};if(s=l.OperandValueAndType(o,n),i=s.type.charAt(0),"n"!=i)return void u("e#VALUE!",0);if(0==s.value)return void u("n",0);if(1==n.length){if(a=l.OperandValueAndType(o,n),i=s.type.charAt(0),"n"!=i)return void u("e#VALUE!",0)}else{if(0!=n.length)return void u("e#VALUE!",0);a={type:"n",value:s.value>0?1:-1}}if(0==a.value)return void u("n",0);if(a.value*s.value<0)return void u("e#NUM!",0);switch(e){case"CEILING":u("n",Math.ceil(s.value/a.value)*a.value);break;case"FLOOR":u("n",Math.floor(s.value/a.value)*a.value)}},r.Formula.FunctionList.CEILING=[r.Formula.CeilingFloorFunctions,-1,"vsig","","math"],r.Formula.FunctionList.FLOOR=[r.Formula.CeilingFloorFunctions,-1,"vsig","","math"],r.Formula.AndOrFunctions=function(e,t,n,o){var s,a,i=r.Formula,l="";for("AND"==e?a=1:"OR"==e&&(a=0);n.length;)s=i.OperandValueAndType(o,n),"n"==s.type.charAt(0)?(s.value=s.value-0,"AND"==e?a=0!=s.value?a:0:"OR"==e&&(a=0!=s.value?1:a),l=i.LookupResultType(s.type,l||"nl",i.TypeLookupTable.propagateerror)):"e"==s.type.charAt(0)&&"e"!=l.charAt(0)&&(l=s.type);l.length<1&&(l="e#VALUE!",a=0),i.PushOperand(t,l,a)},r.Formula.FunctionList.AND=[r.Formula.AndOrFunctions,-1,"vn","","test"],r.Formula.FunctionList.OR=[r.Formula.AndOrFunctions,-1,"vn","","test"],r.Formula.NotFunction=function(e,t,n,o){var s=0,a=r.Formula,i=a.OperandValueAndType(o,n),l=a.LookupResultType(i.type,i.type,a.TypeLookupTable.propagateerror);"n"==i.type.charAt(0)||"b"==i.type?(s=i.value-0!=0?0:1,l="nl"):"t"==i.type.charAt(0)&&(l="e#VALUE!"),a.PushOperand(t,l,s)},r.Formula.FunctionList.NOT=[r.Formula.NotFunction,1,"v","","test"],r.Formula.ChooseFunction=function(e,t,n,o){var s,a,i,l=0,u=r.Formula,c=u.OperandAsNumber(o,n);for("n"!=c.type.charAt(0)&&(c.value=0),c.value=Math.floor(c.value),a=0;n.length;)if(i=u.TopOfStackValueAndType(o,n),a+=1,c.value==a){l=i.value,s=i.type;break}s?u.PushOperand(t,s,l):u.PushOperand(t,"e#VALUE!",0)},r.Formula.FunctionList.CHOOSE=[r.Formula.ChooseFunction,-2,"choose","","lookup"],r.Formula.ColumnsRowsFunctions=function(e,t,n,o){var s,a,i=0,l=r.Formula,u=l.TopOfStackValueAndType(o,n);"coord"==u.type?(i=1,s="n"):"range"==u.type?(a=l.DecodeRangeParts(o,u.value),"COLUMNS"==e?i=a.ncols:"ROWS"==e&&(i=a.nrows),s="n"):(i=0,s="e#VALUE!"),l.PushOperand(t,s,i)},r.Formula.FunctionList.COLUMNS=[r.Formula.ColumnsRowsFunctions,1,"range","","lookup"],r.Formula.FunctionList.ROWS=[r.Formula.ColumnsRowsFunctions,1,"range","","lookup"],r.Formula.ZeroArgFunctions=function(e,t,n,o){var s,a,i,l,u,c={value:0};switch(e){case"FALSE":c.type="nl",c.value=0;break;case"NA":c.type="e#N/A";break;case"NOW":s=new Date,a=s.getTimezoneOffset(),s=s.getTime()/1e3,i=25569,l=86400,u=i+s/l-a/1440,c.value=u,c.type="ndt",r.Formula.FreshnessInfo["volatile"].NOW=!0;break;case"PI":c.type="n",c.value=Math.PI;break;case"TODAY":s=new Date,a=s.getTimezoneOffset(),s=s.getTime()/1e3,i=25569,l=86400,u=i+s/l-a/1440,c.value=Math.floor(u),c.type="nd",r.Formula.FreshnessInfo["volatile"].TODAY=!0;break;case"TRUE":c.type="nl",c.value=1;break;case"RAND":c.type="n",c.value=Math.random(),r.Formula.FreshnessInfo["volatile"].RAND=!0}return t.push(c),null},r.Formula.FunctionList.FALSE=[r.Formula.ZeroArgFunctions,0,"","","test"],r.Formula.FunctionList.NA=[r.Formula.ZeroArgFunctions,0,"","","test"],r.Formula.FunctionList.NOW=[r.Formula.ZeroArgFunctions,0,"","","datetime"],r.Formula.FunctionList.RAND=[r.Formula.ZeroArgFunctions,0,"","","math"],r.Formula.FunctionList.PI=[r.Formula.ZeroArgFunctions,0,"","","math"],r.Formula.FunctionList.TODAY=[r.Formula.ZeroArgFunctions,0,"","","datetime"],r.Formula.FunctionList.TRUE=[r.Formula.ZeroArgFunctions,0,"","","test"],r.Formula.DDBFunction=function(e,t,n,o){var s,a,i,l,u=r.Formula,c=u.OperandAsNumber(o,n),d=u.OperandAsNumber(o,n),p=u.OperandAsNumber(o,n),h=u.OperandAsNumber(o,n);if(!(u.CheckForErrorValue(t,c)||u.CheckForErrorValue(t,d)||u.CheckForErrorValue(t,p)||u.CheckForErrorValue(t,h))){if(p.value<1)return u.FunctionSpecificError(e,t,"e#NUM!",r.Constants.s_sheetfuncddblife),0;if(s={value:2,type:"n"},n.length>0&&(s=u.OperandAsNumber(o,n)),0!=n.length)return u.FunctionArgsError(e,t),0;if(!u.CheckForErrorValue(t,s)){for(a=0,i=0,l=1;l<=h.value-0&&l<=p.value;l++)a=(c.value-i)*(s.value/p.value),c.value-i-a<d.value&&(a=c.value-i-d.value),i+=a;u.PushOperand(t,"n$",a)}}},r.Formula.FunctionList.DDB=[r.Formula.DDBFunction,-4,"ddb","","financial"],r.Formula.SLNFunction=function(e,t,n,o){var s,a=r.Formula,i=a.OperandAsNumber(o,n),l=a.OperandAsNumber(o,n),u=a.OperandAsNumber(o,n);if(!a.CheckForErrorValue(t,i)&&!a.CheckForErrorValue(t,l)&&!a.CheckForErrorValue(t,u)){if(u.value<1)return a.FunctionSpecificError(e,t,"e#NUM!",r.Constants.s_sheetfuncslnlife),0;s=(i.value-l.value)/u.value,a.PushOperand(t,"n$",s)}},r.Formula.FunctionList.SLN=[r.Formula.SLNFunction,3,"csl","","financial"],r.Formula.SYDFunction=function(e,t,n,o){var s,a,i=r.Formula,l=i.OperandAsNumber(o,n),u=i.OperandAsNumber(o,n),c=i.OperandAsNumber(o,n),d=i.OperandAsNumber(o,n);if(!(i.CheckForErrorValue(t,l)||i.CheckForErrorValue(t,u)||i.CheckForErrorValue(t,c)||i.CheckForErrorValue(t,d))){if(c.value<1||d.value<=0)return i.PushOperand(t,"e#NUM!",0),0;a=(c.value+1)*c.value/2,s=(l.value-u.value)*(c.value-d.value+1)/a,i.PushOperand(t,"n$",s)}},r.Formula.FunctionList.SYD=[r.Formula.SYDFunction,4,"cslp","","financial"],r.Formula.InterestFunctions=function(e,t,n,o){var s,a,i,l,u,c,d,p,h,f,m,y,v,g,b,_,C,x,w,S,p,k,F,T=r.Formula,N=T.OperandAsNumber(o,n),A=T.OperandAsNumber(o,n),E=T.OperandAsNumber(o,n);if(s=T.LookupResultType(N.type,A.type,T.TypeLookupTable.twoargnumeric),s=T.LookupResultType(s,E.type,T.TypeLookupTable.twoargnumeric),n.length&&(i=T.OperandAsNumber(o,n),s=T.LookupResultType(s,i.type,T.TypeLookupTable.twoargnumeric),n.length&&(l=T.OperandAsNumber(o,n),s=T.LookupResultType(s,l.type,T.TypeLookupTable.twoargnumeric),n.length))){if("RATE"!=e)return T.FunctionArgsError(e,t),0;u=T.OperandAsNumber(o,n),s=T.LookupResultType(s,u.type,T.TypeLookupTable.twoargnumeric)}if("n"==s)switch(e){case"FV":p=N.value,h=A.value,f=E.value,c=null!=i?i.value:0,m=null!=l&&l.value?1:0,d=0==p?-c-f*h:-(c*Math.pow(1+p,h)+f*(1+p*m)*(Math.pow(1+p,h)-1)/p),a=d,s="n$";break;case"NPER":if(p=N.value,f=A.value,c=E.value,d=null!=i?i.value:0,m=null!=l&&l.value?1:0,0==p){if(0==f)return void T.PushOperand(t,"e#NUM!",0);h=(c+d)/-f}else{if(v=f*(1+p*m)/p,g=c+v,0==g||-1>=p)return void T.PushOperand(t,"e#NUM!",0);if(b=(v-d)/g,0>=b)return void T.PushOperand(t,"e#NUM!",0);_=Math.log(b),C=Math.log(1+p),h=_/C}a=h,s="n";break;case"PMT":if(p=N.value,h=A.value,c=E.value,d=null!=i?i.value:0,m=null!=l&&l.value?1:0,0==h)return void T.PushOperand(t,"e#NUM!",0);f=0==p?(d-c)/h:(0-d-c*Math.pow(1+p,h))/((1+p*m)*(Math.pow(1+p,h)-1)/p),a=f,s="n$";break;case"PV":if(p=N.value,h=A.value,f=E.value,d=null!=i?i.value:0,m=null!=l&&l.value?1:0,-1==p)return void T.PushOperand(t,"e#DIV/0!",0);c=0==p?-d-f*h:(-d-f*(1+p*m)*(Math.pow(1+p,h)-1)/p)/Math.pow(1+p,h),a=c,s="n$";break;case"RATE":for(h=N.value,f=A.value,c=E.value,d=null!=i?i.value:0,m=null!=l&&l.value?1:0,y=null!=u?u.value:.1,w=100,S=0,delta=1,epsilon=1e-7,p=y||1e-8;(delta>=0?delta:-delta)>epsilon&&p!=k;)if(delta=d+c*Math.pow(1+p,h)+f*(1+p*m)*(Math.pow(1+p,h)-1)/p,null!=x?(F=(delta-x)/(p-k)||.001,k=p,p-=delta/F,x=delta):(k=p,p=1.1*p,x=delta),S++,S>=w)return void T.PushOperand(t,"e#NUM!",0);a=p,s="n%"}T.PushOperand(t,s,a)},r.Formula.FunctionList.FV=[r.Formula.InterestFunctions,-3,"fv","","financial"],r.Formula.FunctionList.NPER=[r.Formula.InterestFunctions,-3,"nper","","financial"],r.Formula.FunctionList.PMT=[r.Formula.InterestFunctions,-3,"pmt","","financial"],r.Formula.FunctionList.PV=[r.Formula.InterestFunctions,-3,"pv","","financial"],r.Formula.FunctionList.RATE=[r.Formula.InterestFunctions,-3,"rate","","financial"],r.Formula.NPVFunction=function(e,t,n,o){var s,a,i,l,u,c=r.Formula,a=c.OperandAsNumber(o,n);if(!c.CheckForErrorValue(t,a)){for(i=0,s="n",l=1;n.length;)if(u=c.OperandValueAndType(o,n),"n"==u.type.charAt(0)){if(l*=1+a.value,0==l)return void c.PushOperand(t,"e#DIV/0!",0);i+=u.value/l,s=c.LookupResultType(u.type,s||u.type,c.TypeLookupTable.plus)}else if("e"==u.type.charAt(0)&&"e"!=s.charAt(0)){s=u.type;break}"n"==s.charAt(0)&&(s="n$"),c.PushOperand(t,s,i)}},r.Formula.FunctionList.NPV=[r.Formula.NPVFunction,-2,"npv","","financial"],r.Formula.IRRFunction=function(e,t,n,o){var s,a,i,l,u,c,d,p,h,f,m,y,v=[],g=[],b=r.Formula;for(v.push(n.pop());v.length;)if(s=b.OperandValueAndType(o,v),"n"==s.type.charAt(0))g.push(s.value);else if("e"==s.type.charAt(0))return void b.PushOperand(t,"e#VALUE!",0);if(!g.length)return void b.PushOperand(t,"e#NUM!",0);if(a={value:0},n.length){if(a=b.OperandAsNumber(o,n),"n"!=a.type.charAt(0)&&"b"!=a.type.charAt(0))return void b.PushOperand(t,"e#VALUE!",0);if(n.length)return void b.FunctionArgsError(e,t)}for(a.value=a.value||.1,l=20,u=0,c=1e-7,d=a.value,f=1;(f>=0?f:-f)>c&&d!=p;){for(f=0,m=1,y=0;y<g.length;y++){if(m*=1+d,0==m)return void b.PushOperand(t,"e#DIV/0!",0);f+=g[y]/m}if(null!=i?(h=(f-i)/(d-p),p=d,d-=f/h,i=f):(p=d,d=1.1*d,i=f),u++,u>=l)return void b.PushOperand(t,"e#NUM!",0)}b.PushOperand(t,"n%",d)},r.Formula.FunctionList.IRR=[r.Formula.IRRFunction,-1,"irr","","financial"],r.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null},r.Formula.FindInSheetCache=function(e){var t=r.Formula.SheetCache,n=r.Formula.NormalizeSheetName(e);return t.sheets[n]?t.sheets[n].sheet:t.waitingForLoading?null:t.loadsheet?(alert("Using SocialCalc.Formula.SheetCache.loadsheet - deprecated"),r.Formula.AddSheetToCache(n,t.loadsheet(n))):(t.waitingForLoading=n,null)},r.Formula.AddSheetToCache=function(e,t,n){var o=null,s=r.Formula.SheetCache,a=s.constants,i=r.Formula.NormalizeSheetName(e);return t&&(o=new r.Sheet,o.ParseSheetSave(t)),s.sheets[i]={sheet:o,recalcstate:a.asloaded,name:i},r.Formula.FreshnessInfo.sheets[i]="undefined"==typeof n||n===!1,o},r.Formula.NormalizeSheetName=function(e){return r.Callbacks.NormalizeSheetName?r.Callbacks.NormalizeSheetName(e):e.toLowerCase()},r.Formula.RemoteFunctionInfo={waitingForServer:null},r.Formula.FreshnessInfo={sheets:{},"volatile":{},recalc_completed:!1},r.Formula.FreshnessInfoReset=function(){var e=r.Formula.FreshnessInfo,t=r.Formula.SheetCache;for(var n in e.sheets)e.sheets[n]===!1&&delete t.sheets[n];e.sheets={},e["volatile"]={},e.recalc_completed=!1},r.Formula.PlainCoord=function(e){return-1==e.indexOf("$")?e:e.replace(/\$/g,"")},r.Formula.OrderRangeParts=function(e,t){var n,o,s={};return n=r.coordToCr(e),o=r.coordToCr(t),n.col>o.col?(s.c1=o.col,s.c2=n.col):(s.c1=n.col,s.c2=o.col),n.row>o.row?(s.r1=o.row,s.r2=n.row):(s.r1=n.row,s.r2=o.row),s},r.Formula.TestCriteria=function(e,t,n){var o,s,a,i,l;if(null==n)return!1;if(n+="",o=n.charAt(0),"="==o||"<"==o||">"==o?s=n.substring(1):(o=n.substring(0,2),"<="==o||"<>"==o||">="==o?s=n.substring(2):(o="none",s=n)),a=r.DetermineValueType(s),!a.type){if("none"==o)return!1;if("b"==t.charAt(0)){if("="==o)return!0}else if("<>"==o)return!0;return!1}if(i=!1,"n"==a.type.charAt(0)&&"t"==t.charAt(0)&&(l=r.DetermineValueType(e),"n"==l.type.charAt(0)&&(e=l.value,t=l.type)),"n"==t.charAt(0)&&"n"==a.type.charAt(0))switch(e-=0,a.value=a.value-0,o){case"<":i=e<a.value;break;case"<=":i=e<=a.value;break;case"=":case"none":i=e==a.value;break;case">=":i=e>=a.value;break;case">":i=e>a.value;break;case"<>":i=e!=a.value}else if("e"==t.charAt(0))i=!1;else if("e"==a.type.charAt(0))i=!1;else{if("n"==t.charAt(0)&&(e=r.format_number_for_display(e,"n","")),"n"==a.type.charAt(0))return!1;switch(e=e?e.toLowerCase():"",a.value=a.value?a.value.toLowerCase():"",o){case"<":i=e<a.value;break;case"<=":i=e<=a.value;break;case"=":i=e==a.value;break;case"none":i=e.substring(0,a.value.length)==a.value;break;case">=":i=e>=a.value;break;case">":i=e>a.value;break;case"<>":i=e!=a.value}}return i};var r;if(r||(r={}),r.FormatNumber={},r.FormatNumber.format_definitions={},r.FormatNumber.separatorchar=",",r.FormatNumber.decimalchar=".",r.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"],r.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},r.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"},r.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},r.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600},r.FormatNumber.formatNumberWithFormat=function(e,t,n){var o,s,a,i,l,u,c,d,p,h,f,m,y,v,g,b,_,C,x,w,S,k,F,T,N,A,E,L,R,O,P,I,j,M,D,U,V,B,G,z=r.Constants,H=r.FormatNumber,$="";if("string"==typeof e&&!e.length)return"";if(G=e-0,!isFinite(G))return"string"==typeof e?H.formatTextWithFormat(e,t):"NaN";e=G;var W=0>G?1:0;W&&(G=-G);var q=0==G?1:0;if(n=n||z.FormatNumber_DefaultCurrency,H.parse_format_string(H.format_definitions,t),_=H.format_definitions[t],!_)throw"Format not parsed error!";if(C=_.sectioninfo.length-1,_.hascomparison)for(C=0,x=0,k=0;;k++){if(o=_.operators[k],s=_.operands[k],!o){x&&(t="General",H.parse_format_string(H.format_definitions,t),_=H.format_definitions[t],C=0);break}if(o!=H.commands.section){if(o==H.commands.comparison){if(N=s.indexOf(":"),w=s.substring(0,N),S=s.substring(N+1)-0,"<"==w&&S>e||"<="==w&&S>=e||"="==w&&e==S||"<>"==w&&e!=S||">="==w&&e>=S||">"==w&&e>S)break;x=1}}else{if(!x)break;x=0,C++}}else C>0&&(1==C?W?(W=0,C=1):C=0:(2==C||3==C)&&(W?(W=0,C=1):C=q?2:0));if(T=_.sectioninfo[C],T.commas>0)for(N=0;N<T.commas;N++)G/=1e3;if(T.percent>0)for(N=0;N<T.percent;N++)G*=100;for(A=1,N=0;N<T.fractiondigits;N++)A*=10;if(E=Math.floor(G*A+.5),E/=A,"number"!=typeof E)return"NaN";if(!isFinite(E))return"NaN";if(L=E+"",0==E&&(T.fractiondigits||T.integerdigits)&&(W=0),L.indexOf("e")>=0)return e+"";if(R=L.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!R)return"NaN";if(O=R[1],O&&"0"!=O||(O=""),P=R[2],P||(P=""),T.hasdate){if(0>e)return"??-???-??&nbsp;??:??:??";for(u=(e-Math.floor(e))*H.datevalues.seconds_in_a_day,c=e*H.datevalues.seconds_in_a_day,d=Math.floor(u/H.datevalues.seconds_in_an_hour),f=Math.floor(c/H.datevalues.seconds_in_an_hour),u-=d*H.datevalues.seconds_in_an_hour,p=Math.floor(u/60),m=Math.floor(c/60),h=u-60*p,A=1,N=0;N<T.fractiondigits;N++)A*=10;for(h=Math.floor(h*A+.5),h/=A,y=Math.floor(c*A+.5),y/=A,h>=60&&(h=0,p++,m++,p>=60&&(p=0,d++,f++,d>=24&&(d=0,e++))),P=h-Math.floor(h)+"",P=P.substring(2),g=r.FormatNumber.convert_date_julian_to_gregorian(Math.floor(e+H.datevalues.julian_offset)),b=0,mspos=T.sectionstart;(o=_.operators[mspos],s=_.operands[mspos],o)&&o!=H.commands.section;mspos++)o==H.commands.date?("am/pm"!=s.toLowerCase()&&"a/p"!=s.toLowerCase()||v||(d>=12?(d-=12,v="a/p"==s.toLowerCase()?z.s_FormatNumber_pm1:z.s_FormatNumber_pm):v="a/p"==s.toLowerCase()?z.s_FormatNumber_am1:z.s_FormatNumber_am,s.indexOf(v)<0&&(v=v.toLowerCase())),!b||"m"!=s&&"mm"!=s||(_.operands[mspos]+="in"),b="h"==s.charAt(0)?1:0):o!=H.commands.copy&&(b=0);for(b=0,--mspos;(o=_.operators[mspos],s=_.operands[mspos],o)&&o!=H.commands.section;mspos--)o==H.commands.date?(!b||"m"!=s&&"mm"!=s||(_.operands[mspos]+="in"),b="ss"==s?1:0):o!=H.commands.copy&&(b=0)}for(I=0,j=0,M=0,D="",U="",V=z.FormatNumber_separatorchar,V.indexOf(" ")>=0&&(V=V.replace(/ /g,"&nbsp;")),B=z.FormatNumber_decimalchar,B.indexOf(" ")>=0&&(B=B.replace(/ /g,"&nbsp;")),F=T.sectionstart;o=_.operators[F];)if(s=_.operands[F++],o==H.commands.copy)$+=s;else if(o==H.commands.color)D=s;else if(o==H.commands.style)U=s;else if(o==H.commands.integer_placeholder){if(W&&($+="-",W=0),I++,1==I&&O.length>T.integerdigits)for(;j<O.length-T.integerdigits;j++)$+=O.charAt(j),T.thousandssep&&(a=O.length-j-1,a>2&&a%3==0&&($+=V));O.length<T.integerdigits&&I<=T.integerdigits-O.length?("0"==s||"?"==s)&&($+="0"==s?"0":"&nbsp;",T.thousandssep&&(a=T.integerdigits-I,a>2&&a%3==0&&($+=V))):($+=O.charAt(j),T.thousandssep&&(a=O.length-j-1,a>2&&a%3==0&&($+=V)),j++)}else if(o==H.commands.fraction_placeholder)M>=P.length?("0"==s||"?"==s)&&($+="0"==s?"0":"&nbsp;"):$+=P.charAt(M),M++;else if(o==H.commands.decimal)W&&($+="-",W=0),$+=B;else if(o==H.commands.currency)W&&($+="-",W=0),$+=s;else if(o==H.commands.general){if(0!=G){var X=Math.floor(Math.LOG10E*Math.log(G));if(X=Math.pow(10,13-X),G=Math.floor(X*G+.5)/X,!isFinite(G))return"NaN"}if(W&&($+="-"),L=G+"",L.indexOf("e")>=0){$+=L;continue}if(R=L.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),O=R[1],O&&"0"!=O||(O=""),P=R[2],P||(P=""),j=0,M=0,O.length)for(;j<O.length;j++)$+=O.charAt(j),T.thousandssep&&(a=O.length-j-1,a>2&&a%3==0&&($+=V));else $+="0";if(P.length)for($+=B;M<P.length;M++)$+=P.charAt(M)}else if(o==H.commands.date)l=s.toLowerCase(),"y"==l||"yy"==l?$+=(g.year+"").substring(2):"yyyy"==l?$+=g.year+"":"d"==l?$+=g.day+"":"dd"==l?(i=1e3+g.day,$+=(i+"").substr(2)):"ddd"==l?(i=Math.floor(e+6)%7,$+=z.s_FormatNumber_daynames3[i]):"dddd"==l?(i=Math.floor(e+6)%7,$+=z.s_FormatNumber_daynames[i]):"m"==l?$+=g.month+"":"mm"==l?(i=1e3+g.month,$+=(i+"").substr(2)):"mmm"==l?$+=z.s_FormatNumber_monthnames3[g.month-1]:"mmmm"==l?$+=z.s_FormatNumber_monthnames[g.month-1]:"mmmmm"==l?$+=z.s_FormatNumber_monthnames[g.month-1].charAt(0):"h"==l?$+=d+"":"h]"==l?$+=f+"":"mmin"==l?(i=1e3+p+"",$+=i.substr(2)):"mm]"==l?100>m?(i=1e3+m+"",$+=i.substr(2)):$+=m+"":"min"==l?$+=p+"":"m]"==l?$+=m+"":"hh"==l?(i=1e3+d+"",$+=i.substr(2)):"s"==l?(i=Math.floor(h),$+=i+""):"ss"==l?(i=1e3+Math.floor(h)+"",$+=i.substr(2)):"am/pm"==l||"a/p"==l?$+=v:"ss]"==l&&(100>y?(i=1e3+Math.floor(y)+"",$+=i.substr(2)):(i=Math.floor(y),$+=i+""));else{if(o==H.commands.section)break;if(o==H.commands.comparison)continue;$+="!! Parse error !!"}return D&&($='<span style="color:'+D+';">'+$+"</span>"),U&&($='<span style="'+U+';">'+$+"</span>"),$},r.FormatNumber.formatTextWithFormat=function(e,t){var n,o,s,a,i=(r.Constants,r.FormatNumber),l=e+"",u="",c="",d="";if(i.parse_format_string(i.format_definitions,t),thisformat=i.format_definitions[t],!thisformat)throw"Format not parsed error!";if(n=thisformat.sectioninfo.length-1,0==n)n=0;else{if(3!=n)return l;n=3}for(o=thisformat.sectioninfo[n],s=o.sectionstart;op=thisformat.operators[s];)a=thisformat.operands[s++],op==i.commands.copy?u+="@"==a?l:a.replace(/ /g,"&nbsp;"):op==i.commands.color?c=a:op==i.commands.style&&(d=a);return c&&(u='<span style="color:'+c+';">'+u+"</span>"),d&&(u='<span style="'+d+';">'+u+"</span>"),u},r.FormatNumber.parse_format_string=function(e,t){var n,o,s,a,i,l,u,c,d,p,h,f,m,y,v,g,b,_=r.FormatNumber,C=1;if(!e[t]){for(n={operators:[],operands:[],sectioninfo:[{}]},e[t]=n,o=0,sectioninfo=n.sectioninfo[o],sectioninfo.sectionstart=0,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,g=0;g<t.length;g++)if(b=t.charAt(g),u){if('"'==b){u=0,n.operators.push(_.commands.copy),n.operands.push(c);continue}c+=b}else if(d){if("]"==b){if(d=0,h=r.FormatNumber.parse_format_bracket(p),h.operator==_.commands.separator){sectioninfo.thousandssep=1;continue}h.operator==_.commands.date&&(sectioninfo.hasdate=1),h.operator==_.commands.comparison&&(n.hascomparison=1),n.operators.push(h.operator),n.operands.push(h.operand);continue}p+=b}else if(a)n.operators.push(_.commands.copy),n.operands.push(b),a=!1;else if(i)n.operators.push(_.commands.copy),n.operands.push(b+b+b+b+b),i=!1;else if(l)n.operators.push(_.commands.copy),n.operands.push("&nbsp;"),l=!1;else{if(f){if("general".charAt(f)==b.toLowerCase()){f++,7==f&&(n.operators.push(_.commands.general),n.operands.push(b),f=0);continue}f=0}if(v){if(v.charAt(0)==b){v+=b;continue}n.operators.push(_.commands.date),n.operands.push(v),sectioninfo.hasdate=1,v=""}m?(m+=b,y=m.toLowerCase(),y!="am/pm".substring(0,y.length)&&y!="a/p".substring(0,y.length)?ampstr="":("am/pm"==y||"a/p"==y)&&(n.operators.push(_.commands.date),n.operands.push(m),m="")):"#"==b||"0"==b||"?"==b?C?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=0),s=1,n.operators.push(_.commands.integer_placeholder),n.operands.push(b)):(sectioninfo.fractiondigits++,s=1,n.operators.push(_.commands.fraction_placeholder),n.operands.push(b)):"."==b?(s=0,n.operators.push(_.commands.decimal),n.operands.push(b),C=0):"$"==b?(s=0,n.operators.push(_.commands.currency),n.operands.push(b)):","==b?s?sectioninfo.commas++:(n.operators.push(_.commands.copy),n.operands.push(b)):"%"==b?(s=0,sectioninfo.percent++,n.operators.push(_.commands.copy),n.operands.push(b)):'"'==b?(s=0,u=1,c=""):"["==b?(s=0,d=1,p=""):"\\"==b?(a=1,s=0):"*"==b?(i=1,s=0):"_"==b?(l=1,s=0):";"==b?(o++,n.sectioninfo[o]={},sectioninfo=n.sectioninfo[o],sectioninfo.sectionstart=1+n.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,C=1,s=0,n.operators.push(_.commands.section),n.operands.push(b)):"g"==b.toLowerCase()?(f=1,s=0):"a"==b.toLowerCase()?(m=b,s=0):"dmyhHs".indexOf(b)>=0?v=b:(s=0,n.operators.push(_.commands.copy),n.operands.push(b))}v&&(n.operators.push(_.commands.date),n.operands.push(v),sectioninfo.hasdate=1)}},r.FormatNumber.parse_format_bracket=function(e){var t,n=r.FormatNumber,o=r.Constants,s={};return"$"==e.charAt(0)?(s.operator=n.commands.currency,t=e.match(/^\$(.+?)(\-.+?){0,1}$/),t?s.operand=t[1]||o.FormatNumber_defaultCurrency||"$":s.operand=e.substring(1)||o.FormatNumber_defaultCurrency||"$"):"?$"==e?(s.operator=n.commands.currency,s.operand="[?$]"):n.allowedcolors[e.toUpperCase()]?(s.operator=n.commands.color,s.operand=n.allowedcolors[e.toUpperCase()]):(t=e.match(/^style=([^"]*)$/))?(s.operator=n.commands.style,s.operand=t[1]):","==e?(s.operator=n.commands.separator,s.operand=e):n.alloweddates[e.toUpperCase()]?(s.operator=n.commands.date,s.operand=n.alloweddates[e.toUpperCase()]):(t=e.match(/^[<>=]/))?(t=e.match(/^([<>=]+)(.+)$/),s.operator=n.commands.comparison,s.operand=t[1]+":"+t[2]):(s.operator=n.commands.copy,s.operand="["+e+"]"),s},r.FormatNumber.convert_date_gregorian_to_julian=function(e,t,n){var o;return o=n-32075+r.intFunc(1461*(e+4800+r.intFunc((t-14)/12))/4),o+=r.intFunc(367*(t-2-12*r.intFunc((t-14)/12))/12),o-=r.intFunc(3*r.intFunc((e+4900+r.intFunc((t-14)/12))/100)/4)},r.FormatNumber.convert_date_julian_to_gregorian=function(e){var t,r,n,o,s;return t=e+68569,r=Math.floor(4*t/146097),t-=Math.floor((146097*r+3)/4),n=Math.floor(4e3*(t+1)/1461001),t=t-Math.floor(1461*n/4)+31,o=Math.floor(80*t/2447),s=t-Math.floor(2447*o/80),t=Math.floor(o/11),o=o+2-12*t,n=100*(r-49)+n+t,{year:n,month:o,day:s}},r.intFunc=function(e){return 0>e?-Math.floor(-e):Math.floor(e)},"undefined"!=typeof e)var n=e;"undefined"!=typeof r&&"undefined"!=typeof t&&(t.exports=r)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(e,t,r){var n={EventEmitter:e("./lib/BaseEventEmitter")};t.exports=n},{"./lib/BaseEventEmitter":33}],33:[function(e,t,r){(function(r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=e("./EmitterSubscription"),s=e("./EventSubscriptionVendor"),a=e("fbjs/lib/emptyFunction"),i=e("fbjs/lib/invariant"),l=function(){function e(){n(this,e),this._subscriber=new s,this._currentSubscription=null}return e.prototype.addListener=function(e,t,r){return this._subscriber.addSubscription(e,new o(this._subscriber,t,r))},e.prototype.once=function(e,t,r){var n=this;return this.addListener(e,function(){n.removeCurrentListener(),t.apply(r,arguments)})},e.prototype.removeAllListeners=function(e){this._subscriber.removeAllSubscriptions(e)},e.prototype.removeCurrentListener=function(){this._currentSubscription?void 0:"production"!==r.env.NODE_ENV?i(!1,"Not in an emitting cycle; there is no current subscription"):i(!1),this._subscriber.removeSubscription(this._currentSubscription)},e.prototype.listeners=function(e){var t=this._subscriber.getSubscriptionsForType(e);return t?t.filter(a.thatReturnsTrue).map(function(e){return e.listener}):[]},e.prototype.emit=function(e){var t=this._subscriber.getSubscriptionsForType(e);if(t){for(var r=Object.keys(t),n=0;n<r.length;n++){var o=r[n],s=t[o];s&&(this._currentSubscription=s,this.__emitToSubscription.apply(this,[s].concat(Array.prototype.slice.call(arguments))))}this._currentSubscription=null}},e.prototype.__emitToSubscription=function(e,t){var r=Array.prototype.slice.call(arguments,2);e.listener.apply(e.context,r)},e}();t.exports=l}).call(this,e("_process"))},{"./EmitterSubscription":34,"./EventSubscriptionVendor":36,_process:30,"fbjs/lib/emptyFunction":37,"fbjs/lib/invariant":38}],34:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=e("./EventSubscription"),a=function(e){function t(r,o,s){n(this,t),e.call(this,r),this.listener=o,this.context=s}return o(t,e),t}(s);t.exports=a},{"./EventSubscription":35}],35:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(t){n(this,e),this.subscriber=t}return e.prototype.remove=function(){this.subscriber&&(this.subscriber.removeSubscription(this),this.subscriber=null)},e}();t.exports=o},{}],36:[function(e,t,r){(function(r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=e("fbjs/lib/invariant"),s=function(){function e(){n(this,e),this._subscriptionsForType={},this._currentSubscription=null}return e.prototype.addSubscription=function(e,t){t.subscriber!==this?"production"!==r.env.NODE_ENV?o(!1,"The subscriber of the subscription is incorrectly set."):o(!1):void 0,this._subscriptionsForType[e]||(this._subscriptionsForType[e]=[]);var n=this._subscriptionsForType[e].length;return this._subscriptionsForType[e].push(t),t.eventType=e,t.key=n,t},e.prototype.removeAllSubscriptions=function(e){void 0===e?this._subscriptionsForType={}:delete this._subscriptionsForType[e]},e.prototype.removeSubscription=function(e){var t=e.eventType,r=e.key,n=this._subscriptionsForType[t];n&&delete n[r]},e.prototype.getSubscriptionsForType=function(e){return this._subscriptionsForType[e]},e}();t.exports=s}).call(this,e("_process"))},{_process:30,"fbjs/lib/invariant":38}],37:[function(e,t,r){"use strict";function n(e){return function(){return e}}function o(){}o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},t.exports=o},{}],38:[function(e,t,r){"use strict";function n(e,t,r,n,o,s,a,i){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,o,s,a,i],c=0;l=new Error(t.replace(/%s/g,function(){return u[c++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}t.exports=n},{}],39:[function(e,t,r){function n(){function e(e,t){if(void 0===t&&(t=0),code=e.charCodeAt(t),55296<=code&&code<=56319&&t<e.length-1){var r=code,n=e.charCodeAt(t+1);return n>=56320&&57343>=n?1024*(r-55296)+(n-56320)+65536:r}if(56320<=code&&code<=57343&&t>=1){var r=e.charCodeAt(t-1),n=code;return r>=55296&&56319>=r?1024*(r-55296)+(n-56320)+65536:n}return code}function t(e,t){return e==n&&t==o?!1:e==s||e==n||e==o?!0:t==s||t==n||t==o?!0:(e!=u||t!=u&&t!=c&&t!=p&&t!=h)&&(e!=p&&e!=c||t!=c&&t!=d)&&(e!=h&&e!=d||t!=d)?e==i&&t==i?!1:t==a?!1:t==l?!1:!0:!1}function r(e){return 13==e?n:10==e?o:e>=0&&9>=e||e>=11&&12>=e||e>=14&&31>=e||e>=127&&159>=e||173==e||e>=1536&&1541>=e||1564==e||1757==e||1807==e||6158==e||8203==e||e>=8206&&8207>=e||8232==e||8233==e||e>=8234&&8238>=e||e>=8288&&8292>=e||8293==e||e>=8294&&8303>=e||e>=55296&&57343>=e||65279==e||e>=65520&&65528>=e||e>=65529&&65531>=e||69821==e||e>=113824&&113827>=e||e>=119155&&119162>=e||917504==e||917505==e||e>=917506&&917535>=e||e>=917536&&917631>=e||e>=917632&&917759>=e||e>=918e3&&921599>=e?s:e>=768&&879>=e||e>=1155&&1159>=e||e>=1160&&1161>=e||e>=1425&&1469>=e||1471==e||e>=1473&&1474>=e||e>=1476&&1477>=e||1479==e||e>=1552&&1562>=e||e>=1611&&1631>=e||1648==e||e>=1750&&1756>=e||e>=1759&&1764>=e||e>=1767&&1768>=e||e>=1770&&1773>=e||1809==e||e>=1840&&1866>=e||e>=1958&&1968>=e||e>=2027&&2035>=e||e>=2070&&2073>=e||e>=2075&&2083>=e||e>=2085&&2087>=e||e>=2089&&2093>=e||e>=2137&&2139>=e||e>=2275&&2306>=e||2362==e||2364==e||e>=2369&&2376>=e||2381==e||e>=2385&&2391>=e||e>=2402&&2403>=e||2433==e||2492==e||2494==e||e>=2497&&2500>=e||2509==e||2519==e||e>=2530&&2531>=e||e>=2561&&2562>=e||2620==e||e>=2625&&2626>=e||e>=2631&&2632>=e||e>=2635&&2637>=e||2641==e||e>=2672&&2673>=e||2677==e||e>=2689&&2690>=e||2748==e||e>=2753&&2757>=e||e>=2759&&2760>=e||2765==e||e>=2786&&2787>=e||2817==e||2876==e||2878==e||2879==e||e>=2881&&2884>=e||2893==e||2902==e||2903==e||e>=2914&&2915>=e||2946==e||3006==e||3008==e||3021==e||3031==e||3072==e||e>=3134&&3136>=e||e>=3142&&3144>=e||e>=3146&&3149>=e||e>=3157&&3158>=e||e>=3170&&3171>=e||3201==e||3260==e||3263==e||3266==e||3270==e||e>=3276&&3277>=e||e>=3285&&3286>=e||e>=3298&&3299>=e||3329==e||3390==e||e>=3393&&3396>=e||3405==e||3415==e||e>=3426&&3427>=e||3530==e||3535==e||e>=3538&&3540>=e||3542==e||3551==e||3633==e||e>=3636&&3642>=e||e>=3655&&3662>=e||3761==e||e>=3764&&3769>=e||e>=3771&&3772>=e||e>=3784&&3789>=e||e>=3864&&3865>=e||3893==e||3895==e||3897==e||e>=3953&&3966>=e||e>=3968&&3972>=e||e>=3974&&3975>=e||e>=3981&&3991>=e||e>=3993&&4028>=e||4038==e||e>=4141&&4144>=e||e>=4146&&4151>=e||e>=4153&&4154>=e||e>=4157&&4158>=e||e>=4184&&4185>=e||e>=4190&&4192>=e||e>=4209&&4212>=e||4226==e||e>=4229&&4230>=e||4237==e||4253==e||e>=4957&&4959>=e||e>=5906&&5908>=e||e>=5938&&5940>=e||e>=5970&&5971>=e||e>=6002&&6003>=e||e>=6068&&6069>=e||e>=6071&&6077>=e||6086==e||e>=6089&&6099>=e||6109==e||e>=6155&&6157>=e||6313==e||e>=6432&&6434>=e||e>=6439&&6440>=e||6450==e||e>=6457&&6459>=e||e>=6679&&6680>=e||6683==e||6742==e||e>=6744&&6750>=e||6752==e||6754==e||e>=6757&&6764>=e||e>=6771&&6780>=e||6783==e||e>=6832&&6845>=e||6846==e||e>=6912&&6915>=e||6964==e||e>=6966&&6970>=e||6972==e||6978==e||e>=7019&&7027>=e||e>=7040&&7041>=e||e>=7074&&7077>=e||e>=7080&&7081>=e||e>=7083&&7085>=e||7142==e||e>=7144&&7145>=e||7149==e||e>=7151&&7153>=e||e>=7212&&7219>=e||e>=7222&&7223>=e||e>=7376&&7378>=e||e>=7380&&7392>=e||e>=7394&&7400>=e||7405==e||7412==e||e>=7416&&7417>=e||e>=7616&&7669>=e||e>=7676&&7679>=e||e>=8204&&8205>=e||e>=8400&&8412>=e||e>=8413&&8416>=e||8417==e||e>=8418&&8420>=e||e>=8421&&8432>=e||e>=11503&&11505>=e||11647==e||e>=11744&&11775>=e||e>=12330&&12333>=e||e>=12334&&12335>=e||e>=12441&&12442>=e||42607==e||e>=42608&&42610>=e||e>=42612&&42621>=e||e>=42654&&42655>=e||e>=42736&&42737>=e||43010==e||43014==e||43019==e||e>=43045&&43046>=e||43204==e||e>=43232&&43249>=e||e>=43302&&43309>=e||e>=43335&&43345>=e||e>=43392&&43394>=e||43443==e||e>=43446&&43449>=e||43452==e||43493==e||e>=43561&&43566>=e||e>=43569&&43570>=e||e>=43573&&43574>=e||43587==e||43596==e||43644==e||43696==e||e>=43698&&43700>=e||e>=43703&&43704>=e||e>=43710&&43711>=e||43713==e||e>=43756&&43757>=e||43766==e||44005==e||44008==e||44013==e||64286==e||e>=65024&&65039>=e||e>=65056&&65071>=e||e>=65438&&65439>=e||66045==e||66272==e||e>=66422&&66426>=e||e>=68097&&68099>=e||e>=68101&&68102>=e||e>=68108&&68111>=e||e>=68152&&68154>=e||68159==e||e>=68325&&68326>=e||69633==e||e>=69688&&69702>=e||e>=69759&&69761>=e||e>=69811&&69814>=e||e>=69817&&69818>=e||e>=69888&&69890>=e||e>=69927&&69931>=e||e>=69933&&69940>=e||70003==e||e>=70016&&70017>=e||e>=70070&&70078>=e||e>=70090&&70092>=e||e>=70191&&70193>=e||70196==e||e>=70198&&70199>=e||70367==e||e>=70371&&70378>=e||e>=70400&&70401>=e||70460==e||70462==e||70464==e||70487==e||e>=70502&&70508>=e||e>=70512&&70516>=e||70832==e||e>=70835&&70840>=e||70842==e||70845==e||e>=70847&&70848>=e||e>=70850&&70851>=e||71087==e||e>=71090&&71093>=e||e>=71100&&71101>=e||e>=71103&&71104>=e||e>=71132&&71133>=e||e>=71219&&71226>=e||71229==e||e>=71231&&71232>=e||71339==e||71341==e||e>=71344&&71349>=e||71351==e||e>=71453&&71455>=e||e>=71458&&71461>=e||e>=71463&&71467>=e||e>=92912&&92916>=e||e>=92976&&92982>=e||e>=94095&&94098>=e||e>=113821&&113822>=e||119141==e||e>=119143&&119145>=e||e>=119150&&119154>=e||e>=119163&&119170>=e||e>=119173&&119179>=e||e>=119210&&119213>=e||e>=119362&&119364>=e||e>=121344&&121398>=e||e>=121403&&121452>=e||121461==e||121476==e||e>=121499&&121503>=e||e>=121505&&121519>=e||e>=125136&&125142>=e||e>=917760&&917999>=e?a:e>=127462&&127487>=e?i:2307==e||2363==e||e>=2366&&2368>=e||e>=2377&&2380>=e||e>=2382&&2383>=e||e>=2434&&2435>=e||e>=2495&&2496>=e||e>=2503&&2504>=e||e>=2507&&2508>=e||2563==e||e>=2622&&2624>=e||2691==e||e>=2750&&2752>=e||2761==e||e>=2763&&2764>=e||e>=2818&&2819>=e||2880==e||e>=2887&&2888>=e||e>=2891&&2892>=e||3007==e||e>=3009&&3010>=e||e>=3014&&3016>=e||e>=3018&&3020>=e||e>=3073&&3075>=e||e>=3137&&3140>=e||e>=3202&&3203>=e||3262==e||e>=3264&&3265>=e||e>=3267&&3268>=e||e>=3271&&3272>=e||e>=3274&&3275>=e||e>=3330&&3331>=e||e>=3391&&3392>=e||e>=3398&&3400>=e||e>=3402&&3404>=e||e>=3458&&3459>=e||e>=3536&&3537>=e||e>=3544&&3550>=e||e>=3570&&3571>=e||3635==e||3763==e||e>=3902&&3903>=e||3967==e||4145==e||e>=4155&&4156>=e||e>=4182&&4183>=e||4228==e||6070==e||e>=6078&&6085>=e||e>=6087&&6088>=e||e>=6435&&6438>=e||e>=6441&&6443>=e||e>=6448&&6449>=e||e>=6451&&6456>=e||e>=6681&&6682>=e||6741==e||6743==e||e>=6765&&6770>=e||6916==e||6965==e||6971==e||e>=6973&&6977>=e||e>=6979&&6980>=e||7042==e||7073==e||e>=7078&&7079>=e||7082==e||7143==e||e>=7146&&7148>=e||7150==e||e>=7154&&7155>=e||e>=7204&&7211>=e||e>=7220&&7221>=e||7393==e||e>=7410&&7411>=e||e>=43043&&43044>=e||43047==e||e>=43136&&43137>=e||e>=43188&&43203>=e||e>=43346&&43347>=e||43395==e||e>=43444&&43445>=e||e>=43450&&43451>=e||e>=43453&&43456>=e||e>=43567&&43568>=e||e>=43571&&43572>=e||43597==e||43755==e||e>=43758&&43759>=e||43765==e||e>=44003&&44004>=e||e>=44006&&44007>=e||e>=44009&&44010>=e||44012==e||69632==e||69634==e||69762==e||e>=69808&&69810>=e||e>=69815&&69816>=e||69932==e||70018==e||e>=70067&&70069>=e||e>=70079&&70080>=e||e>=70188&&70190>=e||e>=70194&&70195>=e||70197==e||e>=70368&&70370>=e||e>=70402&&70403>=e||70463==e||e>=70465&&70468>=e||e>=70471&&70472>=e||e>=70475&&70477>=e||e>=70498&&70499>=e||e>=70833&&70834>=e||70841==e||e>=70843&&70844>=e||70846==e||70849==e||e>=71088&&71089>=e||e>=71096&&71099>=e||71102==e||e>=71216&&71218>=e||e>=71227&&71228>=e||71230==e||71340==e||e>=71342&&71343>=e||71350==e||e>=71456&&71457>=e||71462==e||e>=94033&&94078>=e||119142==e||119149==e?l:e>=4352&&4447>=e||e>=43360&&43388>=e?u:e>=4448&&4519>=e||e>=55216&&55238>=e?c:e>=4520&&4607>=e||e>=55243&&55291>=e?d:44032==e||44060==e||44088==e||44116==e||44144==e||44172==e||44200==e||44228==e||44256==e||44284==e||44312==e||44340==e||44368==e||44396==e||44424==e||44452==e||44480==e||44508==e||44536==e||44564==e||44592==e||44620==e||44648==e||44676==e||44704==e||44732==e||44760==e||44788==e||44816==e||44844==e||44872==e||44900==e||44928==e||44956==e||44984==e||45012==e||45040==e||45068==e||45096==e||45124==e||45152==e||45180==e||45208==e||45236==e||45264==e||45292==e||45320==e||45348==e||45376==e||45404==e||45432==e||45460==e||45488==e||45516==e||45544==e||45572==e||45600==e||45628==e||45656==e||45684==e||45712==e||45740==e||45768==e||45796==e||45824==e||45852==e||45880==e||45908==e||45936==e||45964==e||45992==e||46020==e||46048==e||46076==e||46104==e||46132==e||46160==e||46188==e||46216==e||46244==e||46272==e||46300==e||46328==e||46356==e||46384==e||46412==e||46440==e||46468==e||46496==e||46524==e||46552==e||46580==e||46608==e||46636==e||46664==e||46692==e||46720==e||46748==e||46776==e||46804==e||46832==e||46860==e||46888==e||46916==e||46944==e||46972==e||47e3==e||47028==e||47056==e||47084==e||47112==e||47140==e||47168==e||47196==e||47224==e||47252==e||47280==e||47308==e||47336==e||47364==e||47392==e||47420==e||47448==e||47476==e||47504==e||47532==e||47560==e||47588==e||47616==e||47644==e||47672==e||47700==e||47728==e||47756==e||47784==e||47812==e||47840==e||47868==e||47896==e||47924==e||47952==e||47980==e||48008==e||48036==e||48064==e||48092==e||48120==e||48148==e||48176==e||48204==e||48232==e||48260==e||48288==e||48316==e||48344==e||48372==e||48400==e||48428==e||48456==e||48484==e||48512==e||48540==e||48568==e||48596==e||48624==e||48652==e||48680==e||48708==e||48736==e||48764==e||48792==e||48820==e||48848==e||48876==e||48904==e||48932==e||48960==e||48988==e||49016==e||49044==e||49072==e||49100==e||49128==e||49156==e||49184==e||49212==e||49240==e||49268==e||49296==e||49324==e||49352==e||49380==e||49408==e||49436==e||49464==e||49492==e||49520==e||49548==e||49576==e||49604==e||49632==e||49660==e||49688==e||49716==e||49744==e||49772==e||49800==e||49828==e||49856==e||49884==e||49912==e||49940==e||49968==e||49996==e||50024==e||50052==e||50080==e||50108==e||50136==e||50164==e||50192==e||50220==e||50248==e||50276==e||50304==e||50332==e||50360==e||50388==e||50416==e||50444==e||50472==e||50500==e||50528==e||50556==e||50584==e||50612==e||50640==e||50668==e||50696==e||50724==e||50752==e||50780==e||50808==e||50836==e||50864==e||50892==e||50920==e||50948==e||50976==e||51004==e||51032==e||51060==e||51088==e||51116==e||51144==e||51172==e||51200==e||51228==e||51256==e||51284==e||51312==e||51340==e||51368==e||51396==e||51424==e||51452==e||51480==e||51508==e||51536==e||51564==e||51592==e||51620==e||51648==e||51676==e||51704==e||51732==e||51760==e||51788==e||51816==e||51844==e||51872==e||51900==e||51928==e||51956==e||51984==e||52012==e||52040==e||52068==e||52096==e||52124==e||52152==e||52180==e||52208==e||52236==e||52264==e||52292==e||52320==e||52348==e||52376==e||52404==e||52432==e||52460==e||52488==e||52516==e||52544==e||52572==e||52600==e||52628==e||52656==e||52684==e||52712==e||52740==e||52768==e||52796==e||52824==e||52852==e||52880==e||52908==e||52936==e||52964==e||52992==e||53020==e||53048==e||53076==e||53104==e||53132==e||53160==e||53188==e||53216==e||53244==e||53272==e||53300==e||53328==e||53356==e||53384==e||53412==e||53440==e||53468==e||53496==e||53524==e||53552==e||53580==e||53608==e||53636==e||53664==e||53692==e||53720==e||53748==e||53776==e||53804==e||53832==e||53860==e||53888==e||53916==e||53944==e||53972==e||54e3==e||54028==e||54056==e||54084==e||54112==e||54140==e||54168==e||54196==e||54224==e||54252==e||54280==e||54308==e||54336==e||54364==e||54392==e||54420==e||54448==e||54476==e||54504==e||54532==e||54560==e||54588==e||54616==e||54644==e||54672==e||54700==e||54728==e||54756==e||54784==e||54812==e||54840==e||54868==e||54896==e||54924==e||54952==e||54980==e||55008==e||55036==e||55064==e||55092==e||55120==e||55148==e||55176==e?p:e>=44033&&44059>=e||e>=44061&&44087>=e||e>=44089&&44115>=e||e>=44117&&44143>=e||e>=44145&&44171>=e||e>=44173&&44199>=e||e>=44201&&44227>=e||e>=44229&&44255>=e||e>=44257&&44283>=e||e>=44285&&44311>=e||e>=44313&&44339>=e||e>=44341&&44367>=e||e>=44369&&44395>=e||e>=44397&&44423>=e||e>=44425&&44451>=e||e>=44453&&44479>=e||e>=44481&&44507>=e||e>=44509&&44535>=e||e>=44537&&44563>=e||e>=44565&&44591>=e||e>=44593&&44619>=e||e>=44621&&44647>=e||e>=44649&&44675>=e||e>=44677&&44703>=e||e>=44705&&44731>=e||e>=44733&&44759>=e||e>=44761&&44787>=e||e>=44789&&44815>=e||e>=44817&&44843>=e||e>=44845&&44871>=e||e>=44873&&44899>=e||e>=44901&&44927>=e||e>=44929&&44955>=e||e>=44957&&44983>=e||e>=44985&&45011>=e||e>=45013&&45039>=e||e>=45041&&45067>=e||e>=45069&&45095>=e||e>=45097&&45123>=e||e>=45125&&45151>=e||e>=45153&&45179>=e||e>=45181&&45207>=e||e>=45209&&45235>=e||e>=45237&&45263>=e||e>=45265&&45291>=e||e>=45293&&45319>=e||e>=45321&&45347>=e||e>=45349&&45375>=e||e>=45377&&45403>=e||e>=45405&&45431>=e||e>=45433&&45459>=e||e>=45461&&45487>=e||e>=45489&&45515>=e||e>=45517&&45543>=e||e>=45545&&45571>=e||e>=45573&&45599>=e||e>=45601&&45627>=e||e>=45629&&45655>=e||e>=45657&&45683>=e||e>=45685&&45711>=e||e>=45713&&45739>=e||e>=45741&&45767>=e||e>=45769&&45795>=e||e>=45797&&45823>=e||e>=45825&&45851>=e||e>=45853&&45879>=e||e>=45881&&45907>=e||e>=45909&&45935>=e||e>=45937&&45963>=e||e>=45965&&45991>=e||e>=45993&&46019>=e||e>=46021&&46047>=e||e>=46049&&46075>=e||e>=46077&&46103>=e||e>=46105&&46131>=e||e>=46133&&46159>=e||e>=46161&&46187>=e||e>=46189&&46215>=e||e>=46217&&46243>=e||e>=46245&&46271>=e||e>=46273&&46299>=e||e>=46301&&46327>=e||e>=46329&&46355>=e||e>=46357&&46383>=e||e>=46385&&46411>=e||e>=46413&&46439>=e||e>=46441&&46467>=e||e>=46469&&46495>=e||e>=46497&&46523>=e||e>=46525&&46551>=e||e>=46553&&46579>=e||e>=46581&&46607>=e||e>=46609&&46635>=e||e>=46637&&46663>=e||e>=46665&&46691>=e||e>=46693&&46719>=e||e>=46721&&46747>=e||e>=46749&&46775>=e||e>=46777&&46803>=e||e>=46805&&46831>=e||e>=46833&&46859>=e||e>=46861&&46887>=e||e>=46889&&46915>=e||e>=46917&&46943>=e||e>=46945&&46971>=e||e>=46973&&46999>=e||e>=47001&&47027>=e||e>=47029&&47055>=e||e>=47057&&47083>=e||e>=47085&&47111>=e||e>=47113&&47139>=e||e>=47141&&47167>=e||e>=47169&&47195>=e||e>=47197&&47223>=e||e>=47225&&47251>=e||e>=47253&&47279>=e||e>=47281&&47307>=e||e>=47309&&47335>=e||e>=47337&&47363>=e||e>=47365&&47391>=e||e>=47393&&47419>=e||e>=47421&&47447>=e||e>=47449&&47475>=e||e>=47477&&47503>=e||e>=47505&&47531>=e||e>=47533&&47559>=e||e>=47561&&47587>=e||e>=47589&&47615>=e||e>=47617&&47643>=e||e>=47645&&47671>=e||e>=47673&&47699>=e||e>=47701&&47727>=e||e>=47729&&47755>=e||e>=47757&&47783>=e||e>=47785&&47811>=e||e>=47813&&47839>=e||e>=47841&&47867>=e||e>=47869&&47895>=e||e>=47897&&47923>=e||e>=47925&&47951>=e||e>=47953&&47979>=e||e>=47981&&48007>=e||e>=48009&&48035>=e||e>=48037&&48063>=e||e>=48065&&48091>=e||e>=48093&&48119>=e||e>=48121&&48147>=e||e>=48149&&48175>=e||e>=48177&&48203>=e||e>=48205&&48231>=e||e>=48233&&48259>=e||e>=48261&&48287>=e||e>=48289&&48315>=e||e>=48317&&48343>=e||e>=48345&&48371>=e||e>=48373&&48399>=e||e>=48401&&48427>=e||e>=48429&&48455>=e||e>=48457&&48483>=e||e>=48485&&48511>=e||e>=48513&&48539>=e||e>=48541&&48567>=e||e>=48569&&48595>=e||e>=48597&&48623>=e||e>=48625&&48651>=e||e>=48653&&48679>=e||e>=48681&&48707>=e||e>=48709&&48735>=e||e>=48737&&48763>=e||e>=48765&&48791>=e||e>=48793&&48819>=e||e>=48821&&48847>=e||e>=48849&&48875>=e||e>=48877&&48903>=e||e>=48905&&48931>=e||e>=48933&&48959>=e||e>=48961&&48987>=e||e>=48989&&49015>=e||e>=49017&&49043>=e||e>=49045&&49071>=e||e>=49073&&49099>=e||e>=49101&&49127>=e||e>=49129&&49155>=e||e>=49157&&49183>=e||e>=49185&&49211>=e||e>=49213&&49239>=e||e>=49241&&49267>=e||e>=49269&&49295>=e||e>=49297&&49323>=e||e>=49325&&49351>=e||e>=49353&&49379>=e||e>=49381&&49407>=e||e>=49409&&49435>=e||e>=49437&&49463>=e||e>=49465&&49491>=e||e>=49493&&49519>=e||e>=49521&&49547>=e||e>=49549&&49575>=e||e>=49577&&49603>=e||e>=49605&&49631>=e||e>=49633&&49659>=e||e>=49661&&49687>=e||e>=49689&&49715>=e||e>=49717&&49743>=e||e>=49745&&49771>=e||e>=49773&&49799>=e||e>=49801&&49827>=e||e>=49829&&49855>=e||e>=49857&&49883>=e||e>=49885&&49911>=e||e>=49913&&49939>=e||e>=49941&&49967>=e||e>=49969&&49995>=e||e>=49997&&50023>=e||e>=50025&&50051>=e||e>=50053&&50079>=e||e>=50081&&50107>=e||e>=50109&&50135>=e||e>=50137&&50163>=e||e>=50165&&50191>=e||e>=50193&&50219>=e||e>=50221&&50247>=e||e>=50249&&50275>=e||e>=50277&&50303>=e||e>=50305&&50331>=e||e>=50333&&50359>=e||e>=50361&&50387>=e||e>=50389&&50415>=e||e>=50417&&50443>=e||e>=50445&&50471>=e||e>=50473&&50499>=e||e>=50501&&50527>=e||e>=50529&&50555>=e||e>=50557&&50583>=e||e>=50585&&50611>=e||e>=50613&&50639>=e||e>=50641&&50667>=e||e>=50669&&50695>=e||e>=50697&&50723>=e||e>=50725&&50751>=e||e>=50753&&50779>=e||e>=50781&&50807>=e||e>=50809&&50835>=e||e>=50837&&50863>=e||e>=50865&&50891>=e||e>=50893&&50919>=e||e>=50921&&50947>=e||e>=50949&&50975>=e||e>=50977&&51003>=e||e>=51005&&51031>=e||e>=51033&&51059>=e||e>=51061&&51087>=e||e>=51089&&51115>=e||e>=51117&&51143>=e||e>=51145&&51171>=e||e>=51173&&51199>=e||e>=51201&&51227>=e||e>=51229&&51255>=e||e>=51257&&51283>=e||e>=51285&&51311>=e||e>=51313&&51339>=e||e>=51341&&51367>=e||e>=51369&&51395>=e||e>=51397&&51423>=e||e>=51425&&51451>=e||e>=51453&&51479>=e||e>=51481&&51507>=e||e>=51509&&51535>=e||e>=51537&&51563>=e||e>=51565&&51591>=e||e>=51593&&51619>=e||e>=51621&&51647>=e||e>=51649&&51675>=e||e>=51677&&51703>=e||e>=51705&&51731>=e||e>=51733&&51759>=e||e>=51761&&51787>=e||e>=51789&&51815>=e||e>=51817&&51843>=e||e>=51845&&51871>=e||e>=51873&&51899>=e||e>=51901&&51927>=e||e>=51929&&51955>=e||e>=51957&&51983>=e||e>=51985&&52011>=e||e>=52013&&52039>=e||e>=52041&&52067>=e||e>=52069&&52095>=e||e>=52097&&52123>=e||e>=52125&&52151>=e||e>=52153&&52179>=e||e>=52181&&52207>=e||e>=52209&&52235>=e||e>=52237&&52263>=e||e>=52265&&52291>=e||e>=52293&&52319>=e||e>=52321&&52347>=e||e>=52349&&52375>=e||e>=52377&&52403>=e||e>=52405&&52431>=e||e>=52433&&52459>=e||e>=52461&&52487>=e||e>=52489&&52515>=e||e>=52517&&52543>=e||e>=52545&&52571>=e||e>=52573&&52599>=e||e>=52601&&52627>=e||e>=52629&&52655>=e||e>=52657&&52683>=e||e>=52685&&52711>=e||e>=52713&&52739>=e||e>=52741&&52767>=e||e>=52769&&52795>=e||e>=52797&&52823>=e||e>=52825&&52851>=e||e>=52853&&52879>=e||e>=52881&&52907>=e||e>=52909&&52935>=e||e>=52937&&52963>=e||e>=52965&&52991>=e||e>=52993&&53019>=e||e>=53021&&53047>=e||e>=53049&&53075>=e||e>=53077&&53103>=e||e>=53105&&53131>=e||e>=53133&&53159>=e||e>=53161&&53187>=e||e>=53189&&53215>=e||e>=53217&&53243>=e||e>=53245&&53271>=e||e>=53273&&53299>=e||e>=53301&&53327>=e||e>=53329&&53355>=e||e>=53357&&53383>=e||e>=53385&&53411>=e||e>=53413&&53439>=e||e>=53441&&53467>=e||e>=53469&&53495>=e||e>=53497&&53523>=e||e>=53525&&53551>=e||e>=53553&&53579>=e||e>=53581&&53607>=e||e>=53609&&53635>=e||e>=53637&&53663>=e||e>=53665&&53691>=e||e>=53693&&53719>=e||e>=53721&&53747>=e||e>=53749&&53775>=e||e>=53777&&53803>=e||e>=53805&&53831>=e||e>=53833&&53859>=e||e>=53861&&53887>=e||e>=53889&&53915>=e||e>=53917&&53943>=e||e>=53945&&53971>=e||e>=53973&&53999>=e||e>=54001&&54027>=e||e>=54029&&54055>=e||e>=54057&&54083>=e||e>=54085&&54111>=e||e>=54113&&54139>=e||e>=54141&&54167>=e||e>=54169&&54195>=e||e>=54197&&54223>=e||e>=54225&&54251>=e||e>=54253&&54279>=e||e>=54281&&54307>=e||e>=54309&&54335>=e||e>=54337&&54363>=e||e>=54365&&54391>=e||e>=54393&&54419>=e||e>=54421&&54447>=e||e>=54449&&54475>=e||e>=54477&&54503>=e||e>=54505&&54531>=e||e>=54533&&54559>=e||e>=54561&&54587>=e||e>=54589&&54615>=e||e>=54617&&54643>=e||e>=54645&&54671>=e||e>=54673&&54699>=e||e>=54701&&54727>=e||e>=54729&&54755>=e||e>=54757&&54783>=e||e>=54785&&54811>=e||e>=54813&&54839>=e||e>=54841&&54867>=e||e>=54869&&54895>=e||e>=54897&&54923>=e||e>=54925&&54951>=e||e>=54953&&54979>=e||e>=54981&&55007>=e||e>=55009&&55035>=e||e>=55037&&55063>=e||e>=55065&&55091>=e||e>=55093&&55119>=e||e>=55121&&55147>=e||e>=55149&&55175>=e||e>=55177&&55203>=e?h:f;
}var n=0,o=1,s=2,a=3,i=4,l=5,u=6,c=7,d=8,p=9,h=10,f=11;return this.nextBreak=function(n,o){if(void 0===o&&(o=0),0>o)return 0;if(o>=n.length-1)return n.length;for(var s=r(e(n,o)),a=o+1;a<n.length;a++)if(!(55296<=n.charCodeAt(a-1)&&n.charCodeAt(a-1)<=56319&&56320<=n.charCodeAt(a)&&n.charCodeAt(a)<=57343)){var i=r(e(n,a));if(t(s,i))return a;s=i}return n.length},this.splitGraphemes=function(e){for(var t,r=[],n=0;(t=this.nextBreak(e,n))<e.length;)r.push(e.slice(n,t)),n=t;return n<e.length&&r.push(e.slice(n)),r},this.countGraphemes=function(e){for(var t,r=0,n=0;(t=this.nextBreak(e,n))<e.length;)n=t,r++;return n<e.length&&r++,r},this}t.exports=new n},{}],40:[function(e,t,r){"use strict";var n=function(e){var t,r={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(r[t]=t);return r};t.exports=n},{}],41:[function(e,t,r){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e,t){for(var r,a,i=n(e),l=1;l<arguments.length;l++){r=Object(arguments[l]);for(var u in r)o.call(r,u)&&(i[u]=r[u]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(r);for(var c=0;c<a.length;c++)s.call(r,a[c])&&(i[a[c]]=r[a[c]])}}return i}},{}],42:[function(e,t,r){var n={currVal:0,next:function(){return this.currVal=this.currVal+1,this.currVal},startAt:function(e){this.currVal=e}};t.exports=n},{}],43:[function(e,t,r){"use strict";var n={Container:{ContainerNode:e("./wordprocessor/node/container/ContainerNode.js"),DocumentNode:e("./wordprocessor/node/container/DocumentNode.js"),PageNode:e("./wordprocessor/node/container/PageNode.js"),LineNode:e("./wordprocessor/node/container/LineNode.js"),HBoxNode:e("./wordprocessor/node/container/HBoxNode.js"),ListNode:e("./wordprocessor/node/container/ListNode.js"),ListItemNode:e("./wordprocessor/node/container/ListItemNode.js")},Content:{ContentNode:e("./wordprocessor/node/content/ContentNode.js"),TextNode:e("./wordprocessor/node/content/TextNode.js"),TableNode:e("./wordprocessor/node/content/TableNode.js"),PictureNode:e("./wordprocessor/node/content/PictureNode.js"),ChartNode:e("./wordprocessor/node/content/ChartNode.js")},Node:e("./wordprocessor/node/Node.js")},o=e("./wordprocessor/node/Style.js"),s={VisitRange:e("./wordprocessor/visitor/VisitRange.js"),ContentVisitor:e("./wordprocessor/visitor/ContentVisitor.js"),TextStyleVisitor:e("./wordprocessor/visitor/TextStyleVisitor.js"),ListStyleVisitor:e("./wordprocessor/visitor/ListStyleVisitor.js"),CutCopyVisitor:e("./wordprocessor/visitor/CutCopyVisitor.js"),DeleteVisitor:e("./wordprocessor/visitor/DeleteVisitor.js"),PasteVisitor:e("./wordprocessor/visitor/PasteVisitor.js")},a=e("./wordprocessor/Clipboard.js"),i=e("./wordprocessor/Markup.js"),l=e("./wordprocessor/UndoManager.js"),u=e("./computebook/ComputeBookNativeUtil.js");t.exports={Node:n,Style:o,Visitor:s,Clipboard:a,Markup:i,UndoManager:l,ComputeBookNativeUtil:u}},{"./computebook/ComputeBookNativeUtil.js":1,"./wordprocessor/Clipboard.js":2,"./wordprocessor/Markup.js":3,"./wordprocessor/UndoManager.js":4,"./wordprocessor/node/Node.js":5,"./wordprocessor/node/Style.js":6,"./wordprocessor/node/container/ContainerNode.js":7,"./wordprocessor/node/container/DocumentNode.js":8,"./wordprocessor/node/container/HBoxNode.js":9,"./wordprocessor/node/container/LineNode.js":10,"./wordprocessor/node/container/ListItemNode.js":11,"./wordprocessor/node/container/ListNode.js":12,"./wordprocessor/node/container/PageNode.js":13,"./wordprocessor/node/content/ChartNode.js":14,"./wordprocessor/node/content/ContentNode.js":15,"./wordprocessor/node/content/PictureNode.js":16,"./wordprocessor/node/content/TableNode.js":17,"./wordprocessor/node/content/TextNode.js":18,"./wordprocessor/visitor/ContentVisitor.js":19,"./wordprocessor/visitor/CutCopyVisitor.js":20,"./wordprocessor/visitor/DeleteVisitor.js":21,"./wordprocessor/visitor/ListStyleVisitor.js":22,"./wordprocessor/visitor/PasteVisitor.js":23,"./wordprocessor/visitor/TextStyleVisitor.js":24,"./wordprocessor/visitor/VisitRange.js":25}]},{},[43]);
